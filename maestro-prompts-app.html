<!DOCTYPE html>
<html lang="es">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <meta http-equiv="Cache-Control" content="no-cache, no-store, must-revalidate">
    <meta http-equiv="Pragma" content="no-cache">
    <meta http-equiv="Expires" content="0">
    <title>Maestro Prompts - Aula GenIA (v3.4 - Parser Fixed)</title>
    <link href="css/styles.css" rel="stylesheet">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/crypto-js/4.1.1/crypto-js.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/canvas-confetti@1.6.0/dist/confetti.browser.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <link rel="stylesheet"
        href="https://fonts.googleapis.com/css2?family=Material+Symbols+Rounded:opsz,wght,FILL,GRAD@24,400,1,0">
    <link
        href="https://fonts.googleapis.com/css2?family=Plus+Jakarta+Sans:wght@400;500;600;700;800&family=JetBrains+Mono:wght@400;500&display=swap"
        rel="stylesheet">
    <style>
        :root {
            --brand-teal: #14b8a6;
            --brand-blue: #3b82f6;
            --brand-yellow: #f59e0b;
            --brand-gradient: linear-gradient(90deg, #2DD4BF 0%, #FBBF24 100%);
            --text-primary: #1e293b;
            --text-secondary: #64748b;
            --primary: #4f46e5;
            --bg-canvas: #f8fafc
        }

        .gradient-btn {
            background: linear-gradient(90deg, #2dd4bf 0, #fbbf24 100%);
            transition: all .3s cubic-bezier(.4, 0, .2, 1);
            position: relative;
            overflow: hidden
        }

        .gradient-btn::before {
            content: '';
            position: absolute;
            inset: 0;
            background: linear-gradient(90deg, #0e9488 0, #d97706 100%);
            opacity: 0;
            transition: opacity .3s ease
        }

        .gradient-btn:hover::before {
            opacity: 1
        }

        .gradient-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 20px 40px rgba(20, 184, 166, .25), 0 0 20px rgba(251, 191, 36, .3)
        }

        .gradient-btn>* {
            position: relative;
            z-index: 1
        }

        .glassmorphism {
            background: rgba(255, 255, 255, .7);
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, .3)
        }

        .card-hover-brand:hover {
            transform: translateY(-4px);
            box-shadow: 0 20px 40px rgba(20, 184, 166, .15)
        }

        .gradient-text-brand {
            background: linear-gradient(90deg, var(--brand-teal), var(--brand-blue), var(--brand-yellow));
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text
        }

        body {
            font-family: 'Plus Jakarta Sans', sans-serif;
            background-color: var(--bg-canvas);
            color: #1e293b;
            -webkit-font-smoothing: antialiased
        }

        .font-mono {
            font-family: 'JetBrains Mono', monospace
        }

        .no-scrollbar {
            -ms-overflow-style: none;
            scrollbar-width: none
        }

        .no-scrollbar::-webkit-scrollbar {
            display: none
        }

        .custom-scroll::-webkit-scrollbar {
            width: 5px;
            height: 5px
        }

        .custom-scroll::-webkit-scrollbar-track {
            background: 0 0
        }

        .custom-scroll::-webkit-scrollbar-thumb {
            background: #cbd5e1;
            border-radius: 10px
        }

        .custom-scroll::-webkit-scrollbar-thumb:hover {
            background: #94a3b8
        }

        @keyframes fadeIn {
            from {
                opacity: 0;
                transform: translateY(10px) scale(.99)
            }

            to {
                opacity: 1;
                transform: translateY(0) scale(1)
            }
        }

        .fade-in {
            animation: fadeIn .3s cubic-bezier(.16, 1, .3, 1) forwards
        }

        .hl-tag {
            display: inline-flex;
            align-items: center;
            padding: 2px 8px;
            border-radius: 6px;
            margin: 0 3px;
            font-weight: 600;
            font-size: .9em;
            cursor: default;
            border: 1px solid transparent;
            transition: all .2s ease;
            line-height: 1.8
        }

        .hl-rol {
            color: #1e3a8a;
            background: #f0f9ff;
            border-color: #e0f2fe
        }

        .hl-contexto {
            color: #047857;
            background: #f0fdfa;
            border-color: #ccfbf1
        }

        .hl-meta {
            color: #92400e;
            background: #fffbeb;
            border-color: #fef3c7
        }

        .hl-restricciones {
            color: #991b1b;
            background: #fef2f2;
            border-color: #fecaca
        }

        .hl-formato {
            color: #6b21a8;
            background: #faf5ff;
            border-color: #e9d5ff
        }

        .dimmed {
            opacity: .3;
            filter: grayscale(.5)
        }

        .highlighted {
            transform: scale(1.05);
            box-shadow: 0 2px 4px rgba(0, 0, 0, .1);
            z-index: 10;
            position: relative
        }

        .var-highlight {
            background-color: #e0f2fe;
            border-bottom: 2px solid #0284c7;
            color: #0c4a6e;
            font-weight: 700;
            padding: 0 4px;
            border-radius: 4px
        }

        .var-highlight-bad {
            background-color: #f1f5f9;
            border-bottom: 2px dotted #94a3b8;
            color: #64748b;
            font-weight: 600;
            padding: 0 2px
        }

        .no-scrollbar::-webkit-scrollbar {
            display: none
        }

        .blur-prompt {
            filter: blur(8px);
            user-select: none;
            pointer-events: none;
            opacity: .5;
            transition: all .5s ease
        }

        .switch-toggle {
            transition: transform .3s cubic-bezier(.34, 1.56, .64, 1)
        }

        @keyframes subtle-bounce {

            0%,
            100% {
                transform: translateY(0)
            }

            50% {
                transform: translateY(3px)
            }
        }

        .motivate-click {
            animation: subtle-bounce 2s infinite
        }

        @keyframes pulse-ring {
            0% {
                box-shadow: 0 0 0 0 rgba(79, 70, 229, .4)
            }

            70% {
                box-shadow: 0 0 0 6px rgba(79, 70, 229, 0)
            }

            100% {
                box-shadow: 0 0 0 0 rgba(79, 70, 229, 0)
            }
        }

        .pulse-attention {
            animation: pulse-ring 2s infinite
        }

        .search-container:focus-within {
            box-shadow: 0 0 0 4px rgba(79, 70, 229, .1);
            border-color: #818cf8
        }

        @keyframes slide-in-right {
            from {
                transform: translateX(400px);
                opacity: 0
            }

            to {
                transform: translateX(0);
                opacity: 1
            }
        }

        @keyframes slide-out-right {
            from {
                transform: translateX(0);
                opacity: 1
            }

            to {
                transform: translateX(400px);
                opacity: 0
            }
        }

        .animate-slide-in-right {
            animation: slide-in-right .4s cubic-bezier(.68, -.55, .265, 1.55)
        }

        [title]:hover::after,
        [title]:hover::before {
            transition-delay: 0s !important
        }

        @keyframes smoke-rise {
            0% {
                opacity: 0;
                transform: translateY(20px) scale(.8);
                filter: blur(4px)
            }

            50% {
                opacity: 1;
                filter: blur(0px)
            }

            100% {
                opacity: 1;
                transform: translateY(0) scale(1);
                filter: blur(0px)
            }
        }

        .smoke-effect {
            animation: smoke-rise .8s cubic-bezier(.34, 1.56, .64, 1) forwards
        }

        #category-nav>* {
            position: relative;
            padding-right: 8px !important
        }

        #category-nav>*>span:last-child {
            position: absolute;
            top: -6px;
            right: -6px;
            background: #f0fdfa;
            color: #0d9488;
            font-size: 9px;
            font-weight: 800;
            min-width: 18px;
            height: 18px;
            border-radius: 9px;
            display: flex;
            align-items: center;
            justify-content: center;
            padding: 0 5px;
            box-shadow: 0 1px 2px rgba(13, 148, 136, .1);
            border: 1px solid #ccfbf1
        }

        .category-item.active {
            background: #f0fdfa !important;
            color: #0f766e !important;
            border-color: #14b8a6 !important;
            box-shadow: 0 2px 4px rgba(20, 184, 166, .1) !important
        }

        .category-item.active .badge {
            background: #14b8a6 !important;
            color: #fff !important
        }

        .markdown-content {
            line-height: 1.7;
            color: #334155
        }

        .markdown-content strong {
            font-weight: 700;
            color: #1e293b
        }

        .markdown-content em {
            font-style: italic;
            color: #475569
        }

        .markdown-content code {
            font-family: 'JetBrains Mono', 'Courier New', monospace;
            background: #f1f5f9;
            border: 1px solid #e2e8f0;
            border-radius: 4px;
            padding: 2px 6px;
            font-size: .9em;
            color: #be123c
        }

        .markdown-content pre {
            background: #0f172a;
            color: #e2e8f0;
            border-radius: 8px;
            padding: 16px;
            overflow-x: auto;
            margin: 12px 0;
            border: 1px solid #334155
        }

        .markdown-content pre code {
            background: 0 0;
            border: none;
            padding: 0;
            color: #e2e8f0;
            font-size: .875rem
        }

        .markdown-content table {
            width: 100%;
            border-collapse: collapse;
            margin: 16px 0;
            font-size: .9em;
            box-shadow: 0 1px 3px rgba(0, 0, 0, .1);
            border-radius: 8px;
            overflow: hidden
        }

        .markdown-content table thead {
            background: linear-gradient(135deg, #667eea 0, #764ba2 100%);
            color: #fff
        }

        .markdown-content table th {
            padding: 12px 16px;
            text-align: left;
            font-weight: 700;
            text-transform: uppercase;
            font-size: .75em;
            letter-spacing: .05em;
            border-bottom: 2px solid #5a67d8
        }

        .markdown-content table td {
            padding: 12px 16px;
            border-bottom: 1px solid #e2e8f0;
            background: #fff
        }

        .markdown-content table tbody tr:hover {
            background: #f8fafc
        }

        .markdown-content table tbody tr:last-child td {
            border-bottom: none
        }

        .markdown-content ol,
        .markdown-content ul {
            margin: 12px 0;
            padding-left: 24px
        }

        .markdown-content ul {
            list-style-type: disc
        }

        .markdown-content ol {
            list-style-type: decimal
        }

        .markdown-content li {
            margin: 6px 0;
            line-height: 1.6
        }

        .markdown-content p {
            margin: 12px 0
        }

        .markdown-content blockquote {
            border-left: 4px solid #14b8a6;
            padding-left: 16px;
            margin: 16px 0;
            color: #64748b;
            font-style: italic
        }
    </style>
</head>

<body class="h-screen flex flex-col overflow-hidden text-slate-800 bg-slate-50">
    <div id="system-status-overlay"
        class="fixed inset-0 z-[100] bg-white/90 backdrop-blur-xl flex flex-col items-center justify-center p-6 text-center transition-opacity duration-500">
        <div
            class="bg-white p-8 rounded-[2rem] shadow-2xl shadow-slate-200 border border-slate-100 max-w-md w-full animate-in zoom-in duration-300">
            <div id="status-icon"
                class="w-12 h-12 bg-white border border-slate-100 text-indigo-600 rounded-xl flex items-center justify-center mx-auto mb-4 shadow-sm">
                <span class="material-symbols-rounded text-2xl animate-spin">sync</span>
            </div>
            <h2 id="status-title" class="text-lg font-extrabold text-slate-900 mb-1">Conectando B√≥veda...</h2>
            <p id="status-desc" class="text-xs text-slate-500 mb-6">Sincronizando recursos de inteligencia.</p>
            <div
                class="bg-slate-50 p-3 rounded-lg text-left text-[10px] font-mono text-slate-500 overflow-hidden border border-slate-100">
                <p>> System: <span class="text-indigo-600 font-semibold">Secure Vault Connected</span></p>
                <p>> Status: <span id="status-code" class="text-slate-600 font-bold">FETCHING...</span></p>
            </div><button id="retry-btn" onclick="window.location.reload()"
                class="hidden w-full mt-4 py-2 bg-slate-900 text-white rounded-lg font-bold text-xs">Reintentar</button>
        </div>
    </div>
    <header
        class="bg-white/80 backdrop-blur-md border-b border-gray-100 z-30 flex-none h-12 md:h-14 shadow-sm relative z-[60]">
        <div class="h-full pl-2 pr-2 md:pl-4 md:pr-4 flex items-center gap-1 md:gap-4"><button id="mobile-menu-toggle"
                class="lg:hidden p-2 ml-2 text-slate-500 hover:bg-slate-100 rounded-lg transition-colors"><span
                    class="material-symbols-rounded text-xl">menu</span></button>
            <div class="min-w-max flex items-center gap-2"><img src="https://aulagenia.cl/Logo_AGIA_big.webp"
                    alt="AulaGenIA" class="h-7 md:h-10 w-auto">
                <div class="hidden xs:block">
                    <h1 class="text-xs md:text-sm font-bold text-slate-900 leading-none tracking-tight">AGIA Generator
                        <span class="text-indigo-600">3.0</span>
                    </h1>
                    <p class="text-[10px] text-slate-500 font-medium tracking-wider uppercase mt-0.5">Powered by
                        AulaGenIA</p>
                </div>
            </div>
            <div
                class="hidden lg:flex flex-1 mx-4 min-w-0 items-center gap-3 bg-gradient-to-r from-indigo-50 via-blue-50 to-teal-50 rounded-lg px-4 py-2 border border-indigo-100 shadow-sm relative overflow-hidden">
                <div
                    class="absolute inset-0 bg-[url('https://www.transparenttextures.com/patterns/cubes.png')] opacity-5">
                </div>
                <div class="flex items-center gap-2 shrink-0 relative z-10"><span
                        class="bg-yellow-400 text-yellow-900 text-[9px] font-black px-1.5 py-0.5 rounded uppercase tracking-wider shadow-sm animate-pulse">Pro</span>
                    <h4 class="text-slate-900 font-bold text-xs truncate">Pide lo que necesitas</h4>
                </div>
                <p class="text-[10px] text-slate-600 font-medium truncate flex-1 relative z-10">¬øQuieres dominar la
                    ingenier√≠a de prompts y crear herramientas a medida?</p><a href="landing-nuevo.html"
                    class="gradient-btn shrink-0 text-white text-[10px] uppercase font-bold px-3 py-1.5 rounded-lg whitespace-nowrap flex items-center gap-1 relative z-10"><span>Ver
                        M√©todo</span> <span class="material-symbols-rounded text-sm">arrow_forward</span></a>
            </div>
            <div class="flex gap-1 md:gap-2 items-center ml-auto"><button onclick="generateFullPDF()"
                    class="group flex items-center gap-2 bg-gradient-to-r from-indigo-600 to-indigo-500 hover:from-indigo-700 hover:to-indigo-600 text-white px-4 py-2 rounded-xl shadow-lg shadow-indigo-200 hover:shadow-indigo-300 transition-all hover:-translate-y-0.5"
                    title="Descargar 100 Prompts Maestros (PDF)"><span
                        class="material-symbols-rounded text-lg group-hover:scale-110 transition-transform">download</span>
                    <span class="hidden sm:inline font-bold text-xs tracking-wide">Descargar PDF</span></button> <button
                    id="unlock-btn" onclick="showCouponModal()"
                    class="bg-slate-900 hover:bg-slate-800 text-white px-2 py-1.5 md:px-3 rounded-lg text-xs font-bold shadow-md flex items-center gap-1.5 transition-transform hover:-translate-y-0.5"><span
                        class="material-symbols-rounded text-sm text-emerald-400">rocket_launch</span> <span
                        class="hidden sm:inline">Acceso Premium</span></button>
                <div id="user-profile" class="hidden items-center gap-3 ml-2"><span id="user-display-name"
                        class="hidden md:block text-sm font-semibold text-slate-700 truncate max-w-[12ch]"></span>
                    <button id="user-avatar-btn" class="relative"><img id="user-avatar"
                            class="w-8 h-8 md:w-9 md:h-9 rounded-full border-2 border-indigo-500 cursor-pointer hover:opacity-90 transition-opacity"
                            alt="Avatar"></button> <button id="logout-btn"
                        class="hidden md:block text-xs text-slate-500 hover:text-red-600 transition-colors font-medium">Cerrar
                        sesi√≥n</button>
                </div>
            </div>
        </div>
    </header>
    <div class="bg-white border-b border-slate-200 shadow-sm flex-none z-40 relative group">
        <div class="w-full h-12 flex items-center relative"><button id="btn-scroll-left"
                onclick="window.scrollCategories(-200)" onmouseenter="window.startAutoScroll(-15)"
                onmouseleave="window.stopAutoScroll()"
                class="hidden lg:hidden absolute left-2 top-1/2 -translate-y-1/2 z-50 w-8 h-8 flex items-center justify-center bg-white/90 backdrop-blur-sm border border-slate-200 text-indigo-600 hover:text-indigo-800 hover:scale-110 rounded-full shadow-md transition-all"><span
                    class="material-symbols-rounded text-xl font-bold">chevron_left</span></button>
            <div class="overflow-x-auto no-scrollbar flex items-center space-x-2 scroll-smooth w-full px-4 h-full"
                id="category-nav"></div><button id="btn-scroll-right" onclick="window.scrollCategories(200)"
                onmouseenter="window.startAutoScroll(15)" onmouseleave="window.stopAutoScroll()"
                style="display:flex!important"
                class="hidden lg:flex absolute right-2 top-1/2 -translate-y-1/2 z-50 flex-none w-8 h-8 items-center justify-center bg-white/90 backdrop-blur-sm border border-slate-200 text-indigo-600 hover:text-indigo-800 hover:scale-110 rounded-full shadow-md transition-all"><span
                    class="material-symbols-rounded text-xl font-bold">chevron_right</span></button>
        </div>
    </div>
    <div class="flex flex-1 overflow-hidden w-full relative bg-slate-50">
        <aside
            class="fixed inset-0 z-50 flex flex-col bg-white md:relative md:inset-auto md:w-72 lg:w-80 border-r border-slate-200 transform -translate-x-full md:translate-x-0 transition-transform duration-300 shadow-2xl md:shadow-none"
            id="sidebar">
            <div class="md:hidden flex items-center justify-between p-4 border-b border-slate-100 bg-white"><span
                    class="font-bold text-slate-800">Men√∫ de Casos</span> <button id="close-sidebar-btn"
                    class="p-2 text-slate-500 hover:text-slate-700 bg-slate-50 rounded-lg"><span
                        class="material-symbols-rounded">close</span></button></div>
            <div class="px-5 pt-5 pb-3 border-b border-slate-100">
                <div class="relative group">
                    <div class="absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none"><span
                            class="material-symbols-rounded text-indigo-500 text-xl">search</span></div><input
                        type="text" id="searchInput"
                        class="w-full pl-10 pr-4 py-3 bg-white border-2 border-slate-100 rounded-xl text-sm font-medium focus:border-indigo-500 focus:ring-4 focus:ring-indigo-500/10 outline-none transition-all placeholder:text-slate-400 text-slate-700 shadow-sm search-container"
                        placeholder="¬øQu√© desaf√≠o tienes hoy?" onkeyup="filterCases()">
                </div>
                <div id="search-stats" class="hidden mt-2 px-1 flex justify-between items-center animate-pulse"><span
                        class="text-[10px] uppercase font-bold text-indigo-500 tracking-wider">Buscando...</span> <span
                        class="text-[10px] font-bold text-slate-400" id="results-count"></span></div>
            </div>
            <div class="flex-1 overflow-y-auto custom-scroll p-3 space-y-1" id="case-list"></div>
            <div
                class="p-3 border-t border-slate-100 bg-slate-50/50 text-[10px] text-slate-400 flex justify-between px-4 font-medium">
                <span>Estado: Online</span> <span>Casos: <span id="total-display"
                        class="text-slate-700 font-bold">0</span></span>
            </div>
        </aside>
        <main class="flex-1 flex flex-col overflow-hidden relative w-full h-full bg-slate-100/50">
            <div id="workspace-empty" class="hidden flex-col items-center justify-center h-full text-center p-4 md:p-8">
                <div
                    class="w-24 h-24 bg-white rounded-full flex items-center justify-center mb-4 shadow-xl text-indigo-200">
                    <span class="material-symbols-rounded text-5xl">compare_arrows</span>
                </div>
                <h3 class="text-base md:text-lg font-bold text-slate-800">Selecciona un caso</h3>
                <p class="text-xs text-slate-500 text-center px-4">Comienza tu comparativa en el men√∫ lateral.</p>
            </div>
            <div id="case-detail"
                class="flex flex-col h-full w-full p-2 md:p-3 gap-2 overflow-hidden max-w-5xl mx-auto">
                <div
                    class="flex-none flex flex-col md:flex-row md:items-center justify-between gap-2 md:gap-3 bg-white rounded-lg md:rounded-xl px-3 py-2 md:px-4 md:py-2 border border-slate-200 shadow-sm">
                    <div class="flex items-center gap-3 min-w-0 flex-1"><span id="detail-category-badge"
                            class="flex-none text-[9px] font-bold uppercase tracking-wider px-2 py-0.5 rounded border bg-indigo-50 text-indigo-600 border-indigo-100">CAT</span>
                        <div class="min-w-0">
                            <h2 id="detail-title"
                                class="text-sm md:text-base lg:text-lg font-bold text-slate-900 truncate">T√≠tulo del
                                Caso</h2>
                            <p id="detail-problem" class="text-[11px] text-slate-500 hidden md:block leading-snug"></p>
                        </div>
                    </div>
                    <div
                        class="flex items-center justify-between md:justify-end gap-2 flex-none w-full md:w-auto border-t md:border-t-0 border-slate-100 pt-2 md:pt-0 mt-1 md:mt-0">
                        <div class="relative bg-slate-100 rounded-lg p-0.5 flex items-center"><button
                                onclick='setMode("basic")'
                                class="relative z-10 px-2 md:px-3 py-1.5 text-[10px] font-bold transition-colors duration-200 rounded-md text-slate-600"
                                id="btn-basic">B√°sico</button>
                            <div class="relative group"><button onclick='setMode("agia")'
                                    class="relative z-10 px-2 md:px-3 py-1.5 text-[10px] font-bold transition-all duration-300 rounded-md flex items-center gap-1 bg-indigo-600 text-white"
                                    id="btn-agia"><span class="material-symbols-rounded text-xs">verified</span>
                                    <span>Maestro</span> <span id="maestro-cta-badge"
                                        class="hidden absolute -top-2 -right-2 bg-emerald-500 text-white text-[8px] font-black px-1.5 py-0.5 rounded-full shadow-lg animate-bounce">!</span></button>
                            </div>
                        </div>
                        <div class="flex items-center gap-2"><span id="benefit-badge"
                                class="hidden xs:flex text-[9px] font-bold px-2 py-1 rounded-md border items-center gap-1 bg-emerald-50 text-emerald-600 border-emerald-100"><span
                                    class="material-symbols-rounded text-xs">bolt</span> ~15m</span>
                            <div class="relative hidden" id="copy-btn-container"><button
                                    onclick="copyPromptWithFeedback(this)" id="copy-btn"
                                    class="text-[10px] font-bold px-3 py-1.5 rounded-lg bg-slate-300 text-slate-500 flex items-center gap-1.5 transition-all cursor-not-allowed opacity-60"
                                    disabled="disabled"><span
                                        class="material-symbols-rounded text-sm copy-icon">content_copy</span> <span
                                        class="copy-text hidden sm:inline">Copiar</span></button></div>
                        </div>
                    </div>
                </div>
                <div class="flex-1 bg-white rounded-xl border border-slate-200 shadow-lg flex flex-col overflow-hidden"
                    id="main-card-container">
                    <div id="detail-scroll-container" class="flex-1 overflow-y-auto custom-scroll relative bg-white">
                        <div id="content-basic" class="p-3 md:p-6 lg:p-8 space-y-4 md:space-y-6 fade-in">
                            <div
                                class="bg-slate-50 border border-slate-200 rounded-lg md:rounded-xl p-4 md:p-6 relative overflow-hidden">
                                <div id="bad-prompt-rendered"
                                    class="font-mono text-sm text-slate-600 italic leading-relaxed"></div>
                            </div>
                            <div class="border-l-4 border-amber-300 bg-amber-50/50 p-3 md:p-4 rounded-r-lg relative">
                                <div class="absolute top-2 right-2 text-[9px] text-amber-400 font-mono">v3.0 (Updated)
                                </div><label
                                    class="text-[10px] font-bold text-amber-600 uppercase mb-2 block tracking-wider flex items-center gap-1"><span
                                        class="material-symbols-rounded text-sm">chat</span> Muestra de respuesta
                                    T√≠pica</label>
                                <div id="bad-result-preview" class="text-sm text-slate-600 leading-relaxed italic">
                                </div>
                            </div>
                            <div class="border-l-4 border-red-300 bg-red-50/50 p-3 md:p-4 rounded-r-lg"><label
                                    class="text-[10px] font-bold text-red-500 uppercase mb-2 block tracking-wider flex items-center gap-1"><span
                                        class="material-symbols-rounded text-sm">bug_report</span> ¬øPor qu√© falla este
                                    prompt?</label>
                                <div id="bad-response-analysis" class="text-sm text-slate-600 leading-relaxed"></div>
                            </div>
                        </div>
                        <div id="content-agia" class="hidden p-0 fade-in flex flex-col h-full">
                            <div
                                class="relative bg-white rounded-lg md:rounded-xl p-3 md:p-4 lg:p-5 border border-slate-100 flex-none w-full shadow-[0_4px_20px_-4px_rgba(0,0,0,0.06)] ring-1 ring-slate-400/5">
                                <div
                                    class="absolute top-0 right-0 bg-red-100 text-red-700 text-[10px] font-bold px-3 py-1 rounded-bl-xl uppercase tracking-wider border-l border-b border-red-200 z-10">
                                    ‚ùå Prompt Deficiente</div>
                                <div id="prompt-blur-wrapper" class="transition-all duration-500 relative">
                                    <div class="flex items-center gap-4 mb-4 border-b border-slate-50 pb-3"><label
                                            class="text-[10px] font-bold text-slate-400 uppercase tracking-widest flex items-center gap-2 flex-none translate-y-[1px]"><span
                                                class="material-symbols-rounded text-sm text-indigo-500">auto_awesome</span>
                                            Prompt Maestro</label>
                                        <div id="maestro-social-proof"
                                            class="hidden items-center gap-1.5 bg-gradient-to-r from-orange-50 to-red-50 border border-orange-200 rounded-full px-3 py-1 smoke-effect">
                                            <span
                                                class="material-symbols-rounded text-xs text-orange-600 animate-pulse">local_fire_department</span>
                                            <span class="text-[9px] font-bold text-orange-600"><span
                                                    id="maestro-counter">0</span> usando este</span>
                                        </div>
                                        <div id="agia-legend-inline"
                                            class="flex items-center gap-1.5 overflow-x-auto no-scrollbar mask-gradient-r flex-1">
                                        </div>
                                    </div>
                                    <div id="agia-sections-container" class="text-[14px] text-slate-800"></div>
                                    <div id="detail-prompt-rendered" class="hidden"></div>
                                </div>
                                <div id="locked-teaser"
                                    class="hidden fixed inset-0 z-50 flex items-center justify-center p-3 md:p-4 backdrop-blur-sm bg-black/30 transition-all duration-500">
                                    <div
                                        class="bg-gradient-to-br from-white via-white to-gray-50 backdrop-blur-xl px-5 py-6 md:px-8 md:py-10 rounded-2xl md:rounded-3xl border-2 border-gray-200 shadow-2xl max-w-md w-full text-center transform transition-all hover:scale-[1.01] animate-in fade-in zoom-in duration-300">
                                        <div
                                            class="relative w-16 h-16 md:w-20 md:h-20 bg-gradient-to-br from-teal-400 via-cyan-500 to-blue-500 rounded-2xl flex items-center justify-center mx-auto mb-4 md:mb-5 shadow-lg shadow-cyan-500/30 rotate-3 hover:rotate-6 transition-transform">
                                            <span
                                                class="material-symbols-rounded text-3xl md:text-4xl text-white">workspace_premium</span>
                                        </div>
                                        <h3 class="text-xl md:text-2xl font-black text-gray-900 mb-2">Contenido
                                            Protegido</h3>
                                        <p
                                            class="text-cyan-600 font-bold text-xs md:text-sm uppercase tracking-wider mb-3 md:mb-4">
                                            üéÅ Acceso Premium</p>
                                        <p id="teaser-message"
                                            class="text-gray-600 text-xs md:text-sm mb-4 md:mb-6 leading-relaxed px-2">
                                            Aprende a usar IA sin saber programar. Accede al Curso + B√≥veda de Prompts
                                            con descuento especial.</p><button onclick="showCouponModal()"
                                            id="teaser-action-btn"
                                            class="w-full gradient-btn flex items-center justify-center gap-2 px-6 py-3 md:px-8 md:py-4 text-white text-sm md:text-base font-black rounded-xl transition-all shadow-xl hover:shadow-2xl hover:-translate-y-1 mb-3 md:mb-4"><span
                                                class="material-symbols-rounded text-lg md:text-xl">rocket_launch</span>
                                            <span id="teaser-action-text">Aprovechar Oferta</span> <span
                                                class="material-symbols-rounded text-base md:text-lg">arrow_forward</span></button>
                                        <p class="text-[10px] md:text-xs text-gray-500">¬øYa tienes cuenta? Tu sesi√≥n se
                                            detectar√° autom√°ticamente.</p>
                                    </div>
                                </div>
                            </div>
                            <div class="mt-4 relative bg-slate-50 rounded-xl p-5 border border-slate-200">
                                <div
                                    class="absolute -top-3 left-4 bg-white text-indigo-600 text-[10px] font-black uppercase tracking-widest px-3 py-1 rounded-full border border-indigo-100 shadow-sm flex items-center gap-1 z-10">
                                    <span class="material-symbols-rounded text-sm">auto_awesome</span> Muestra de
                                    respuesta Optimizada
                                </div>
                                <div id="good-result-preview"
                                    class="text-sm text-slate-700 leading-relaxed font-medium mt-2"></div>
                                <div id="result-teaser-label"
                                    class="hidden absolute top-3 right-3 bg-indigo-50 text-indigo-700 text-[9px] font-bold px-2 py-0.5 rounded border border-indigo-100 flex items-center gap-1">
                                    <span class="material-symbols-rounded text-[10px] filled">visibility</span> PREVIEW
                                </div>
                            </div>
                            <div class="mt-4 bg-white border-t-2 border-slate-50 pt-4 pb-2">
                                <div class="grid grid-cols-1 md:grid-cols-3 gap-6">
                                    <div id="ai-suggestion-badge" class="flex items-start gap-3 group">
                                        <div
                                            class="flex-none w-8 h-8 rounded-lg bg-blue-50 text-blue-600 flex items-center justify-center group-hover:bg-blue-600 group-hover:text-white transition-colors border border-blue-100">
                                            <span class="material-symbols-rounded text-lg">psychology</span>
                                        </div>
                                        <div>
                                            <h5
                                                class="text-[10px] font-bold text-blue-800 uppercase tracking-wider mb-0.5">
                                                Modelo Ideal</h5>
                                            <div id="ai-name" class="text-xs font-bold text-slate-700">GPT-4 / Claude 3
                                            </div>
                                        </div>
                                    </div>
                                    <div id="tip-container" class="flex items-start gap-3 group">
                                        <div
                                            class="flex-none w-8 h-8 rounded-lg bg-amber-50 text-amber-600 flex items-center justify-center group-hover:bg-amber-500 group-hover:text-white transition-colors border border-amber-100">
                                            <span class="material-symbols-rounded text-lg">lightbulb</span>
                                        </div>
                                        <div>
                                            <h5
                                                class="text-[10px] font-bold text-amber-700 uppercase tracking-wider mb-0.5">
                                                Estrategia</h5>
                                            <p id="detail-example-tip" class="text-xs text-slate-600 leading-snug"></p>
                                        </div>
                                    </div>
                                    <div id="validation-container" class="flex items-start gap-3 group">
                                        <div
                                            class="flex-none w-8 h-8 rounded-lg bg-teal-50 text-teal-600 flex items-center justify-center group-hover:bg-teal-600 group-hover:text-white transition-colors border border-teal-100">
                                            <span class="material-symbols-rounded text-lg">fact_check</span>
                                        </div>
                                        <div>
                                            <h5
                                                class="text-[10px] font-bold text-teal-700 uppercase tracking-wider mb-0.5">
                                                Validaci√≥n</h5>
                                            <p id="detail-validation-tip" class="text-xs text-slate-600 leading-snug">
                                            </p>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="h-12"></div>
                    </div>
                </div>
            </div>
        </main>
    </div>
    <div id="toast" class="fixed bottom-10 right-10 z-[70] transform translate-x-full transition-all duration-500">
    </div>
    <div id="sales-toast"
        class="fixed bottom-24 right-6 z-[50] pointer-events-none md:pointer-events-auto transition-all duration-500 translate-y-24 opacity-0">
    </div>
    <div id="tutorial-modal" class="hidden fixed inset-0 z-[90] flex items-center justify-center p-4">
        <div class="absolute inset-0 bg-slate-900/80 backdrop-blur-sm transition-opacity" onclick="closeTutorial()">
        </div>
        <div
            class="relative bg-white rounded-2xl shadow-2xl max-w-4xl w-full overflow-hidden animate-in zoom-in duration-200">
            <div class="p-6 border-b border-slate-100 flex justify-between items-center">
                <h3 class="font-bold text-lg text-indigo-900">Protocolo de Aprendizaje: Las 3 C</h3><button
                    onclick="closeTutorial()" class="text-slate-400 hover:text-slate-600"><span
                        class="material-symbols-rounded">close</span></button>
            </div>
            <div class="p-6 overflow-y-auto max-h-[75vh]">
                <div
                    class="w-full max-w-[320px] mx-auto aspect-video bg-slate-100 rounded-xl mb-8 flex items-center justify-center text-slate-300 relative group cursor-pointer overflow-hidden shadow-inner border border-slate-200">
                    <div
                        class="absolute inset-0 bg-[url('https://images.unsplash.com/photo-1611162617474-5b21e879e113?q=80&w=1000&auto=format&fit=crop')] bg-cover bg-center opacity-50">
                    </div><span
                        class="material-symbols-rounded text-5xl relative z-10 bg-white/20 p-4 rounded-full backdrop-blur text-white shadow-xl group-hover:scale-110 transition-transform">play_arrow</span>
                </div>
                <div class="grid grid-cols-1 sm:grid-cols-3 gap-6 text-center">
                    <div
                        class="group p-6 bg-white border border-slate-100 rounded-2xl shadow-sm hover:shadow-xl hover:border-indigo-200 hover:-translate-y-2 transition-all duration-300 cursor-default relative overflow-hidden">
                        <div
                            class="absolute inset-0 bg-gradient-to-br from-indigo-50/50 to-transparent opacity-0 group-hover:opacity-100 transition-opacity duration-300">
                        </div>
                        <div class="relative z-10">
                            <div
                                class="w-14 h-14 bg-indigo-50 text-indigo-600 rounded-2xl flex items-center justify-center mx-auto mb-4 shadow-sm group-hover:scale-110 group-hover:rotate-3 transition-transform duration-300 group-hover:bg-white group-hover:text-indigo-700">
                                <span class="material-symbols-rounded text-2xl">psychology</span>
                            </div>
                            <div class="font-black text-indigo-800 text-lg mb-2">1. Confrontar</div>
                            <p class="text-xs text-slate-500 leading-relaxed group-hover:text-slate-700">Antes de ver la
                                soluci√≥n, preg√∫ntate: <strong>"¬øQu√© le pedir√≠a yo a la IA?"</strong>. Intenta resolverlo
                                mentalmente.</p>
                        </div>
                    </div>
                    <div
                        class="group p-6 bg-white border border-slate-100 rounded-2xl shadow-sm hover:shadow-xl hover:border-emerald-200 hover:-translate-y-2 transition-all duration-300 cursor-default relative overflow-hidden">
                        <div
                            class="absolute inset-0 bg-gradient-to-br from-emerald-50/50 to-transparent opacity-0 group-hover:opacity-100 transition-opacity duration-300">
                        </div>
                        <div class="relative z-10">
                            <div
                                class="w-14 h-14 bg-emerald-50 text-emerald-600 rounded-2xl flex items-center justify-center mx-auto mb-4 shadow-sm group-hover:scale-110 group-hover:-rotate-3 transition-transform duration-300 group-hover:bg-white group-hover:text-emerald-700">
                                <span class="material-symbols-rounded text-2xl">manage_search</span>
                            </div>
                            <div class="font-black text-emerald-800 text-lg mb-2">2. Comprender</div>
                            <p class="text-xs text-slate-500 leading-relaxed group-hover:text-slate-700">Analiza el
                                Prompt Maestro. Identifica los <strong>5 ingredientes clave</strong>: Rol, Contexto,
                                Meta, Restricciones y Formato.</p>
                        </div>
                    </div>
                    <div
                        class="group p-6 bg-white border border-slate-100 rounded-2xl shadow-sm hover:shadow-xl hover:border-amber-200 hover:-translate-y-2 transition-all duration-300 cursor-default relative overflow-hidden">
                        <div
                            class="absolute inset-0 bg-gradient-to-br from-amber-50/50 to-transparent opacity-0 group-hover:opacity-100 transition-opacity duration-300">
                        </div>
                        <div class="relative z-10">
                            <div
                                class="w-14 h-14 bg-amber-50 text-amber-600 rounded-2xl flex items-center justify-center mx-auto mb-4 shadow-sm group-hover:scale-110 group-hover:rotate-3 transition-transform duration-300 group-hover:bg-white group-hover:text-amber-700">
                                <span class="material-symbols-rounded text-2xl">handshake</span>
                            </div>
                            <div class="font-black text-amber-800 text-lg mb-2">3. Colaborar</div>
                            <p class="text-xs text-slate-500 leading-relaxed group-hover:text-slate-700">¬°Acci√≥n! Copia
                                la estructura maestra y <strong>sustituye los datos</strong> por tu problema real del
                                d√≠a a d√≠a.</p>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <div id="paywall-modal" class="hidden fixed inset-0 z-[90] flex items-center justify-center p-4">
        <div class="absolute inset-0 bg-slate-900/90 backdrop-blur-sm transition-opacity" onclick="closePaywall()">
        </div>
        <div
            class="relative bg-white rounded-2xl shadow-2xl max-w-sm w-full p-8 text-center animate-in zoom-in duration-200">
            <div
                class="w-12 h-12 bg-yellow-400 rounded-full flex items-center justify-center mx-auto mb-4 font-black text-xl shadow-lg">
                %</div>
            <h3 class="text-xl font-black text-slate-900 mb-2">¬°Oportunidad √önica!</h3>
            <p class="text-xs text-slate-500 mb-6 leading-relaxed">Obt√©n acceso inmediato a la <strong
                    class="text-slate-800">B√≥veda de Prompts</strong> + <strong class="text-slate-800">Curso IA
                    Aplicada</strong>.<br><span
                    class="text-emerald-600 font-bold bg-emerald-50 px-2 py-0.5 rounded mt-2 inline-block">üî• Desde $5
                    USD -
                    Cupos Limitados</span></p><button id="unlock-btn-modal"
                onclick="window.location.href='landing-nuevo2.html'"
                class="w-full bg-slate-900 hover:bg-slate-800 text-white py-3 rounded-xl font-bold text-sm shadow-xl hover:scale-105 transition-transform flex items-center justify-center gap-2"><span>Ver
                    Planes y Precios</span> <span
                    class="bg-yellow-400 text-slate-900 text-[10px] px-1.5 py-0.5 rounded font-black">OFERTA</span></button>
            <button onclick="closePaywall()" class="mt-3 text-xs text-slate-400 hover:text-slate-600">No
                gracias</button>
        </div>
    </div>
    <script src="https://www.gstatic.com/firebasejs/9.6.1/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.6.1/firebase-auth-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.6.1/firebase-firestore-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.6.1/firebase-functions-compat.js"></script>
    <script>const firebaseConfig = { apiKey: "AIzaSyC9sVJwEfFdIN4VmSMooAoQLXYl5Mcu1yM", authDomain: "aulagenia.firebaseapp.com", projectId: "aulagenia", storageBucket: "aulagenia.appspot.com", messagingSenderId: "173328075630", appId: "1:173328075630:web:825606db4271ea1e66cf7f" }; firebase.apps.length || firebase.initializeApp(firebaseConfig); const auth = firebase.auth(), db = firebase.firestore(), functions = firebase.functions(); let appliedCoupon = null; window.showCouponModal = async function () { if (!auth.currentUser) { sessionStorage.setItem("pendingAction", "showCouponModal"); const e = encodeURIComponent(window.location.href); return void (window.location.href = `acceso.html?redirect=${e}`) } const e = document.getElementById("coupon-modal"); e && (e.classList.remove("hidden"), e.classList.add("flex")) }, window.closeCouponModal = function () { const e = document.getElementById("coupon-modal"); if (e) { e.classList.add("hidden"), e.classList.remove("flex"); const o = document.getElementById("modal-coupon-input"); o && (o.value = ""); const t = document.getElementById("modal-coupon-message"); t && t.classList.add("hidden"); const n = document.getElementById("modal-discount-summary"); n && n.classList.add("hidden"); const a = document.getElementById("modal-apply-btn"); a && (a.textContent = "Aplicar y continuar", a.onclick = window.applyModalCoupon, a.disabled = !1) } appliedCoupon = null }, window.applyModalCoupon = async function () { const e = document.getElementById("modal-coupon-input").value.trim().toUpperCase(); if (!e) return void window.proceedWithoutCoupon(); const o = document.getElementById("modal-apply-btn"), t = o.textContent; o.disabled = !0, o.textContent = "Validando..."; try { const n = functions.httpsCallable("validateCoupon"), a = await n({ couponCode: e, courseId: "ia-aplicada-esencial" }); if (a.data.valid) { appliedCoupon = a.data, document.getElementById("modal-original-price").textContent = `$${a.data.originalPrice} USD`; const e = "percentage" === a.data.discountType ? `${a.data.discountValue}%` : `$${a.data.discountValue} USD`; document.getElementById("modal-discount-label").textContent = e, document.getElementById("modal-discount-amount").textContent = `-$${a.data.discountAmount.toFixed(2)} USD`, document.getElementById("modal-final-price").textContent = `$${a.data.finalPrice.toFixed(2)} USD`, document.getElementById("modal-discount-summary").classList.remove("hidden"), window.showModalMessage(`‚úÖ Cup√≥n aplicado: ${e} de descuento`, "success"), o.textContent = "Confirmar y Pagar", o.onclick = window.proceedWithCoupon, o.disabled = !1 } else window.showModalMessage("Cup√≥n no v√°lido", "error"), o.textContent = t, o.disabled = !1 } catch (e) { console.error("Error validating coupon:", e), window.showModalMessage("Error al validar cup√≥n", "error"), o.textContent = t, o.disabled = !1 } }, window.showModalMessage = function (e, o) { const t = document.getElementById("modal-coupon-message"); t && (t.textContent = e, t.className = "mt-2 text-sm font-medium " + ("error" === o ? "text-red-600" : "text-green-600"), t.classList.remove("hidden")) }, window.proceedWithoutCoupon = async function () { appliedCoupon = null, document.getElementById("coupon-modal").classList.add("hidden"), await window.triggerUnlockPayment() }, window.proceedWithCoupon = async function () { document.getElementById("coupon-modal").classList.add("hidden"), await window.triggerUnlockPayment() }, window.triggerUnlockPayment = async function () { if (!auth.currentUser) { const e = encodeURIComponent("maestro-prompts-app.html?action=buy"); return void (window.location.href = `acceso.html?redirect=${e}`) } try { const e = functions.httpsCallable("createMercadoPagoPreference"), o = await e({ courseId: "ia-aplicada-esencial", couponId: appliedCoupon ? appliedCoupon.couponId : null }); if (!o.data || !o.data.init_point) throw new Error("No payment link returned"); window.location.href = o.data.init_point } catch (e) { console.error("Payment Error:", e), alert("Error al generar pago. Intenta m√°s tarde.") } }</script>
    <script
        type="module">let casesData = []; const externalDBUrl = "./prompts_db.js", statusOverlay = document.getElementById("system-status-overlay"), statusIcon = document.getElementById("status-icon"), statusTitle = document.getElementById("status-title"), statusDesc = document.getElementById("status-desc"), statusCode = document.getElementById("status-code"), retryBtn = document.getElementById("retry-btn"); function showSystemError(e) { statusOverlay.classList.remove("hidden"), statusOverlay.classList.add("flex"), statusIcon.innerHTML = '<span class="material-symbols-rounded text-3xl text-red-500">error</span>', statusIcon.className = "w-16 h-16 bg-white border border-red-100 text-red-600 rounded-2xl flex items-center justify-center mx-auto mb-6 shadow-sm", statusTitle.innerText = "Error de Conexi√≥n", e.message.includes("Failed to fetch") || e.message.includes("NetworkError") ? (statusDesc.innerText = "No pudimos conectar con el servidor de AulaGenia. Verifica tu conexi√≥n o que prompts_db.js exista.", statusCode.innerText = "NETWORK_ERROR") : (statusDesc.innerText = "Error al procesar la base de datos de prompts.", statusCode.innerText = "DATA_ERROR: " + e.message), statusCode.className = "text-red-500 font-bold", retryBtn.classList.remove("hidden") } async function loadDatabase() { try { const e = new URLSearchParams(window.location.search); if ("true" === e.get("dev")) { console.warn("üöß DEV MODE: Intentando cargar prompts_db.js localmente..."); const e = document.createElement("script"); return e.src = "prompts_db.js", e.onload = () => { void 0 !== window.casesData && Array.isArray(window.casesData) && (casesData = window.casesData, console.log("‚úÖ Local Load Success"), setTimeout(() => { statusOverlay.classList.add("hidden"), initApp() }, 100)) }, e.onerror = () => { console.error("‚ùå Fall√≥ carga local. Aseg√∫rate de tener prompts_db.js"), showSystemError(new Error("Fall√≥ carga local en modo dev")) }, void document.head.appendChild(e) } console.log("‚è≥ Esperando autenticaci√≥n de Firebase..."), await new Promise(e => { const t = auth.onAuthStateChanged(o => { t(), e(o) }) }); const t = auth.currentUser; if (!t) { console.log("‚ùå Usuario no autenticado, redirigiendo a login..."); const e = encodeURIComponent(window.location.href); return void (window.location.href = `acceso.html?redirect=${e}`) } console.log("‚úÖ Usuario autenticado:", t.email), console.log("üîí Secure Load: Solicitando prompts a Cloud Function..."); const o = firebase.functions().httpsCallable("getPromptsData"), a = await o(); if (!a.data.success) throw new Error("Respuesta inv√°lida del servidor seguro."); casesData = a.data.data, console.log(`‚úÖ Secure Load Success: ${casesData.length} prompts loaded.`), setTimeout(() => { statusOverlay.classList.add("hidden"), initApp() }, 100) } catch (e) { if (console.error("Secure Load Error:", e), "functions/unauthenticated" === e.code) { console.log("Usuario no autenticado, redirigiendo a login..."); const e = encodeURIComponent(window.location.href); return void (window.location.href = `acceso.html?redirect=${e}`) } "functions/permission-denied" === e.code ? showSystemError(new Error("Acceso denegado: Necesitas inscripci√≥n activa.")) : showSystemError(e) } } loadDatabase(); const config = { categories: { "Productividad Ninja": { label: "Productividad", color: "emerald", icon: "rocket_launch" }, "Ventas & Persuasi√≥n": { label: "Ventas", color: "rose", icon: "campaign" }, "Contenido & Redes": { label: "Marketing", color: "fuchsia", icon: "share" }, "Finanzas Inteligentes": { label: "Finanzas", color: "amber", icon: "payments" }, "Legal & Formalizaci√≥n": { label: "Legal", color: "slate", icon: "gavel" }, "Estrategia & Lanzamiento": { label: "Estrategia", color: "violet", icon: "flag" }, "Dise√±o & Arte Digital": { label: "Dise√±o", color: "pink", icon: "palette" }, "Operaciones & Procesos": { label: "Operaciones", color: "cyan", icon: "settings_suggest" }, "Liderazgo & Equipos": { label: "Liderazgo", color: "blue", icon: "groups" }, "Tecnolog√≠a & Herramientas": { label: "Tecnolog√≠a", color: "indigo", icon: "terminal" }, "Otros / An√°lisis": { label: "An√°lisis", color: "gray", icon: "analytics" } } }; let autoScrollFrame, currentPromptTemplate = "", currentBadPromptTemplate = "", currentVariables = {}, currentDifficulty = "beginner", currentViewMode = "basic", autoScrollSpeed = 0; window.startAutoScroll = function (e) { console.log("AutoScroll started:", e); const t = document.getElementById("category-nav"); if (!t) return void console.error("Nav element not found!"); console.log("Nav scrollWidth:", t.scrollWidth), console.log("Nav clientWidth:", t.clientWidth), console.log("Can scroll:", t.scrollWidth > t.clientWidth), console.log("Current scrollLeft:", t.scrollLeft), autoScrollSpeed = e, autoScrollFrame && cancelAnimationFrame(autoScrollFrame), t.style.scrollBehavior = "auto"; let o = 0; const a = () => { const e = t.scrollLeft; t.scrollLeft += autoScrollSpeed; const n = t.scrollLeft; o < 5 && console.log(`Scroll attempt ${o}: ${e} -> ${n}`), o++, autoScrollFrame = requestAnimationFrame(a) }; a() }, window.stopAutoScroll = function () { autoScrollFrame && cancelAnimationFrame(autoScrollFrame); const e = document.getElementById("category-nav"); e && (e.style.scrollBehavior = "smooth") }; let currentCaseId = null, isVaultUnlocked = !1; function getEncryptionKey() { return [65, 71, 73, 65, 50, 48, 50, 53].map(e => String.fromCharCode(e)).join("") } async function sha256(e) { const t = (new TextEncoder).encode(e), o = await crypto.subtle.digest("SHA-256", t); return Array.from(new Uint8Array(o)).map(e => e.toString(16).padStart(2, "0")).join("") } function generateFullPDF() { window.location.href = "campus.html?download=pdf" } function initApp() {
                if (window.loadCase = n, window.filterCases = function () { const e = document.getElementById("searchInput").value.toLowerCase().trim(); if (!e) return void c(casesData); const t = e.split(/\s+/), o = new Set(t); t.forEach(e => { Object.keys(l).forEach(t => { (t.includes(e) || e.includes(t)) && l[t].forEach(e => o.add(e)) }) }); const a = Array.from(o), n = casesData.filter(e => { const t = `${e.title} ${e.problem} ${e.category} ${e.badPrompt}`.toLowerCase(); return a.some(e => t.includes(e)) }); c(n, a); const r = document.getElementById("search-stats"), s = document.getElementById("results-count"); e.length > 0 ? (r.classList.remove("hidden"), r.classList.add("flex"), 0 === n.length ? (s.innerText = "0 resultados", s.className = "text-[10px] font-bold text-red-400") : (s.innerText = `${n.length} encontrados`, s.className = "text-[10px] font-bold text-emerald-500")) : (r.classList.add("hidden"), r.classList.remove("flex")) }, window.filterByCategory = function (e) { window.currentCategory = e, document.getElementById("searchInput").value = ""; const t = casesData.filter(t => t.category === e); c(t), t.length > 0 && n(t[0].id); document.querySelectorAll(".category-item").forEach(e => e.classList.remove("active")); const o = document.querySelector(`.category-item[data-category="${e}"]`); o && o.classList.add("active") }, window.copyPrompt = function (btn) { if (!isVaultUnlocked && ![1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15].includes(currentCaseId)) { return window.showCouponModal(); } s(btn) }, window.openPaywall = function () { confetti({ particleCount: 150, spread: 100, origin: { y: .6 }, colors: ["#FFE400", "#FFBD00", "#E89400", "#FFCA6C", "#FDFFB8"] }), document.getElementById("paywall-modal").classList.remove("hidden") }, window.closePaywall = function () { document.getElementById("paywall-modal").classList.add("hidden") }, window.showTutorial = function () { document.getElementById("tutorial-modal").classList.remove("hidden") }, window.closeTutorial = function () { document.getElementById("tutorial-modal").classList.add("hidden") }, window.downloadPDF = function () { const e = [1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15], t = casesData.length, a = casesData.filter(t => isVaultUnlocked || e.includes(t.id)).length, n = `\n                <html>\n                <head>\n                    <title>B√≥veda de Prompts AGIA</title>\n                    <style>\n                        body { font-family: sans-serif; padding: 40px; color: #333; line-height: 1.6; }\n                        h1 { text-align: center; color: #4f46e5; margin-bottom: 5px; }\n                        .subtitle { text-align: center; font-size: 0.9em; color: #666; margin-bottom: 40px; }\n                        .case { border: 1px solid #e2e8f0; padding: 20px; margin-bottom: 20px; page-break-inside: avoid; border-radius: 8px; }\n                        .title { font-weight: 800; font-size: 1.2em; color: #1e293b; }\n                        .meta { font-size: 0.75em; color: #64748b; margin-bottom: 10px; text-transform: uppercase; letter-spacing: 0.05em; font-weight: 700; }\n                        .problem { font-style: italic; color: #475569; margin-bottom: 15px; font-size: 0.9em; }\n                        .label { font-weight: bold; font-size: 0.8em; text-transform: uppercase; color: #4f46e5; margin-bottom: 5px; }\n                        .prompt-box { background: #f8fafc; border: 1px solid #cbd5e1; padding: 15px; border-radius: 6px; font-family: 'Courier New', monospace; white-space: pre-wrap; font-size: 0.85em; color: #334155; }\n                        .locked-box { background: #fef2f2; border: 1px dashed #fca5a5; color: #991b1b; text-align: center; font-style: italic; padding: 20px; display: flex; align-items: center; justify-content: center; gap: 10px; }\n                        .watermark { text-align: center; margin-top: 50px; font-size: 0.8em; color: #cbd5e1; }\n                    </style>\n                </head>\n                <body>\n                    <h1>B√≥veda Maestra AGIA</h1>\n                    <p class="subtitle">Reporte Generado el ${(new Date).toLocaleDateString()} | ${a}/${t} Desbloqueados</p>\n                    \n                    ${casesData.map(t => { const a = e.includes(t.id), n = !(isVaultUnlocked || a); let r = ""; n || (r = t.agiaPromptTagged && t.agiaPromptTagged.startsWith("U2F") ? o(t.agiaPromptTagged) : t.agiaPromptTagged || ""); const s = n ? '<div class="locked-box">üîí CONTENIDO EXCLUSIVO - Inicia sesi√≥n en AulaGenia para ver este contenido.</div>' : `<div class="prompt-box">${r.replace(/{[a-z]+\}|{\/[a-z]+\}/g, "")}</div>`; return `\n                            <div class="case">\n                                <div class="title">${t.title}</div>\n                                <div class="meta">${t.category} ‚Ä¢ ${t.difficulty}</div>\n                                <p class="problem">"${t.problem}"</p>\n                                <div class="label">Prompt Optimizado:</div>\n                                ${s}\n                            </div>\n                        ` }).join("")}\n                    \n                    <div class="watermark">Generado por AGIA Generator 3.0</div>\n                    <script>window.onload = function() { window.print(); }<\/script>\n                </body>\n                </html>\n            `, r = window.open("", "_blank"); r.document.write(n), r.document.close() }, window.setMode = a, window.generateFullPDF = generateFullPDF, function () { const e = document.getElementById("category-nav"); if (!e) return; const t = [...new Set(casesData.map(e => e.category))]; e.innerHTML = t.map(e => { const t = config.categories[e] || { label: e, color: "slate", icon: "category" }, o = casesData.filter(t => t.category === e).length, a = e === window.currentCategory; return `<button data-category="${e}" onclick="filterByCategory('${e}')" class="category-item shrink-0 whitespace-nowrap px-3 py-1 rounded-lg text-[10px] font-bold bg-white border border-slate-100 text-slate-500 hover:border-teal-300 hover:bg-teal-50 hover:text-teal-700 transition-all flex items-center gap-1.5 group ${a ? "active" : ""}">\n                    <span class="material-symbols-rounded text-sm text-slate-300 group-hover:text-teal-600">${t.icon}</span> \n                    ${e}\n                    <span class="badge bg-white border border-slate-100 text-slate-400 text-[9px] px-1.5 py-0.5 rounded-full ml-1 group-hover:bg-teal-100 group-hover:text-teal-700 transition-colors">${o}</span>\n                </button>` }).join("") }(), c(casesData), casesData.length > 0 && n(casesData[0].id), function () { let e = 14, t = 59; const o = document.getElementById("countdown"); if (!o) return; setInterval(() => { if (0 === t) { if (0 === e) return; e--, t = 59 } else t--; o.innerText = `${e}:${t < 10 ? "0" + t : t}` }, 1e3) }(), function () { const e = ["Carlos R.", "Maria Jose L.", "StartUp Vision", "David Gonzalez", "Sofia P.", "Agencia Nova", "Mario B.", "Fernanda S.", "Juan Pablo M.", "TechSolution Ltda", "Laura D.", "Pedro A.", "Consuelo V.", "Ignacio R.", "Camila T.", "Estudio Creativo", "Rodrigo F.", "Andrea M.", "Felipe S.", "Gabriela O.", "Nicolas C.", "Valentina H.", "Javier E.", "Digital Growth", "Carolina U.", "Ricardo P.", "Daniela B.", "Sebastian V.", "Francisca A.", "Matias L.", "Jorge M.", "Beatriz S.", "Luis G.", "Global Trends", "Elena K.", "Pablo R.", "Teresa V.", "Hugo C.", "Ver√≥nica N.", "Innova Corp", "Diego A.", "Natalia F.", "Roberto S.", "Clara D.", "Smart Biz", "Manuel J.", "Patricia L.", "Gabriel M.", "Isabel T.", "Fusion Media", "Alejandro V.", "Luc√≠a B.", "Fernando R.", "Marta P.", "NextGen Agency", "Alberto D.", "Carmen S.", "Ra√∫l G.", "Silvia M.", "Eco Systems", "Adri√°n L.", "Lorena C.", "Oscar P.", "Rosa T.", "Data Mind", "Sergio H.", "Paula R.", "Iv√°n F.", "M√≥nica G.", "Web Solutions", "Antonio M.", "Eva S.", "Francisco J.", "Alicia V.", "Market Pro", "Juli√°n R.", "Cristina B.", "Rub√©n D.", "Nuria L.", "Cloud Nine", "H√©ctor S.", "Marina P.", "Emilio C.", "Diana M.", "Alpha Group", "Gonzalo V.", "Pilar R.", "Esteban G.", "Julia T.", "Net Connect", "√Ålvaro F.", "Raquel S.", "Vicente M.", "Celia D.", "Future Tech", "Santiago L.", "In√©s P.", "Tom√°s R.", "Gloria V.", "Prime Corp", "Rafael G.", "Angela M.", "Joaqu√≠n S.", "Olga B.", "Elite Services", "Mariano D.", "Irene C.", "Salvador P.", "Adela R.", "Visionary Labs", "Samuel V.", "Lidia M.", "Isaac G.", "Esther T.", "Quantum Leap", "F√©lix R.", "Aurora S.", "Gustavo P.", "Blanca D.", "Apex Solutions", "C√©sar M.", "Elisa V.", "Arturo L.", "Sara G.", "Nexus Point", "Ram√≥n B.", "Vanesa C.", "Domingo R.", "F√°tima P.", "Synergy Hub", "Gregorio S.", "Amalia M.", "Lorenzo D.", "Sonia V.", "Bright Ideas", "Marcos P.", "Noelia R.", "Eugenio G.", "Miriam T.", "Zenith Corp", "Benjam√≠n L.", "Roc√≠o S.", "Alfonso M.", "Virginia D.", "Core Systems", "Crist√≥bal V.", "Bego√±a P.", "Leandro R.", "Matilde G.", "Flux Media", "Sim√≥n D.", "Ariadna M.", "Dami√°n S.", "Erika V.", "Spark Labs", "Teodoro P.", "Carlota R.", "Fabi√°n G.", "Lara D.", "Velocity Inc", "Mauricio M.", "Daniela S.", "Ren√© V.", "Paulina C.", "Titan Group", "Bruno L.", "Valeria P.", "Axel R.", "Camila G.", "Nova Tech", "Ezequiel M.", "Ximena D.", "Dante S.", "Zoe V.", "Omega Corp", "Lucas P.", "Abril R.", "Mateo G.", "Luna D.", "Starlight Co", "Thiago M.", "Mia S.", "Ian V.", "Emma P.", "Blue Sky", "Oliver R.", "Olivia G.", "Noah D.", "Ava M.", "Green Leaf", "Liam S.", "Sophia V.", "Ethan P.", "Isabella R.", "Red Rock", "Mason G.", "Charlotte D.", "Logan M.", "Amelia S.", "Silver Lining", "Jacob P.", "Harper V.", "William R.", "Evelyn G.", "Golden Gate", "Michael D.", "Abigail M.", "Alexander S.", "Emily P.", "Diamond Edge", "James R.", "Elizabeth V.", "Benjamin G.", "Mila D.", "Iron Clad", "Daniel M.", "Ella S.", "Henry P.", "Avery R.", "Steel Works", "Jackson V.", "Sofia G.", "Sebastian D.", "Camila M.", "Bronze Age"], t = ["Santiago", "Vi√±a del Mar", "Concepci√≥n", "Valpara√≠so", "Antofagasta", "La Serena", "Temuco", "Rancagua", "CDMX", "Monterrey", "Guadalajara", "Puebla", "Canc√∫n", "Tijuana", "M√©rida", "Quer√©taro", "Le√≥n", "Veracruz", "Bogot√°", "Medell√≠n", "Cali", "Barranquilla", "Cartagena", "Bucaramanga", "Pereira", "Buenos Aires", "Rosario", "C√≥rdoba", "Mendoza", "Tucum√°n", "Mar del Plata", "Salta", "Lima", "Arequipa", "Trujillo", "Cusco", "Chiclayo", "Madrid", "Barcelona", "Valencia", "Bilbao", "Sevilla", "Zaragoza", "M√°laga", "Alicante", "Miami", "Quito", "Guayaquil", "Montevideo", "San Jos√©", "Panam√°", "Asunci√≥n", "La Paz", "Santo Domingo", "San Juan", "Guatemala City", "San Salvador", "Tegucigalpa"], o = ["se inscribi√≥ en el Programa", "comenz√≥ el Curso de IA", "accedi√≥ a la B√≥veda", "desbloque√≥ su primer caso", "est√° optimizando sus procesos", "mejor√≥ su prompt en 90%", "ahorr√≥ 4 horas esta semana", "descarg√≥ la gu√≠a maestra"]; let a = new Set; try { const e = sessionStorage.getItem("agia_used_names"); e && (a = new Set(JSON.parse(e))) } catch (e) { console.warn("Session storage inaccessible") } const n = document.getElementById("sales-toast"); setTimeout(function r() { if (!n || document.hidden) return; const { buyer: s, location: l, action: i, time: c } = function () { let n = e.filter(e => !a.has(e)); 0 === n.length && (a.clear(), n = e); const r = n[Math.floor(Math.random() * n.length)]; a.add(r); try { sessionStorage.setItem("agia_used_names", JSON.stringify([...a])) } catch (e) { } return { buyer: r, location: t[Math.floor(Math.random() * t.length)], action: o[Math.floor(Math.random() * o.length)], time: Math.random() > .7 ? "Hace instantes" : `Hace ${Math.floor(59 * Math.random()) + 1} min` } }(), d = s.charAt(0), m = ["bg-indigo-500", "bg-blue-500", "bg-emerald-500", "bg-violet-500", "bg-rose-500", "bg-amber-500"], u = m[Math.floor(Math.random() * m.length)]; n.innerHTML = `\n                <div class="bg-white rounded-lg shadow-xl border border-slate-100 p-3 flex items-center gap-3 w-80 relative overflow-hidden group hover:scale-[1.02] transition-transform cursor-pointer" onclick="openPaywall()">\n                     <div class="absolute left-0 top-0 bottom-0 w-1 ${u}"></div>\n                     <div class="flex-none w-10 h-10 rounded-full ${u} text-white flex items-center justify-center font-bold text-lg shadow-md relative">\n                        ${d}\n                        <div class="absolute bottom-0 right-0 w-2.5 h-2.5 bg-green-400 border-2 border-white rounded-full"></div>\n                     </div>\n                     <div class="flex-1 min-w-0">\n                        <div class="flex justify-between items-start">\n                             <p class="text-sm font-bold text-slate-800 truncate pr-1">${s} <span class="font-normal text-slate-500 text-xs">adquiri√≥ la Licencia Pro</span></p>\n                        </div>\n                        <div class="flex items-center gap-1.5 mt-0.5">\n                             <span class="material-symbols-rounded text-slate-300 text-[10px]">public</span>\n                             <p class="text-[10px] text-slate-400 font-medium truncate">${c} ‚Ä¢ ${l}</p>\n                        </div>\n                     </div>\n                </div>`, n.classList.remove("translate-y-24", "opacity-0"), setTimeout(() => { n.classList.add("translate-y-24", "opacity-0") }, 1e4); const p = Math.floor(3e4 * Math.random()) + 15e3; setTimeout(r, p) }, 5e3) }(), "undefined" != typeof auth) {
                    auth.onAuthStateChanged(async e => {
                        const t = document.getElementById("unlock-btn"); if (e) {
                            const o = document.getElementById("user-profile"), a = document.getElementById("user-display-name"), r = document.getElementById("user-avatar"); if (o && a && r) { const t = (e.displayName || e.email.split("@")[0] || "Usuario").split(" ")[0]; if (a.textContent = t, e.photoURL) r.src = e.photoURL; else { t.charAt(0).toUpperCase(); r.src = `https://ui-avatars.com/api/?name=${encodeURIComponent(t)}&background=6366f1&color=fff&bold=true` } o.classList.remove("hidden"), o.classList.add("flex") } const s = db.collection("users").doc(e.uid); let l = !1; try {
                                const t = await s.get(); if (console.log("üîç Verificando enrollment para:", e.email), t.exists) {
                                    const e = t.data();
                                    console.log("üì¶ User Data:", e), console.log("üìã Enrollments:", e.enrollments);
                                    const o = "ia-aplicada-esencial",
                                        a = "inteligencia-aplicada",
                                        start = "ia-aplicada-starter"; // ADDED STARTER ID
                                    e.enrollments && (console.log(`‚úÖ Checking ${o}:`, e.enrollments[o]), console.log(`‚úÖ Checking ${start}:`, e.enrollments[start])),
                                        !e.enrollments || (!0 !== e.enrollments[o] && !0 !== e.enrollments[a] && !0 !== e.enrollments[start]) // CHECK ALL
                                            ?
                                            console.log("‚ùå NO HAY ENROLLMENT - Manteniendo bloqueado") : (l = !0, console.log("‚úÖ ENROLLMENT DETECTADO - Desbloqueando contenido"))
                                } else console.log("‚ùå Usuario no existe en Firestore")
                            } catch (e) {
                                console.error("‚ùå Error verificando enrollment:", e)
                            }
                            isVaultUnlocked = l, isVaultUnlocked ? console.log("üîì Desbloqueando vault (Usuario Premium)...") : console.log("üîí Vault bloqueado (Usuario Freemium)..."), t && t.classList.add("hidden");
                            const i = document.getElementById("locked-teaser");
                            i && (i.classList.add("hidden"), i.classList.remove("flex")), currentCaseId && n(currentCaseId);
                            const c = document.getElementById("unlock-btn");
                            c && (l ? c.classList.add("hidden") : (c.innerHTML = '<span class="material-symbols-rounded text-sm text-emerald-400">rocket_launch</span><span class="hidden sm:inline">Acceso Premium</span>', c.onclick = e => {
                                e.preventDefault(), window.location.href = "landing-nuevo.html" // REDIRECT TO LANDING
                            }));
                            if ("buy" === new URLSearchParams(window.location.search).get("action"))
                                if (isVaultUnlocked) {
                                    console.log("User already enrolled. Creating smooth clean URL.");
                                    const e = window.location.pathname;
                                    window.history.replaceState({}, document.title, e);
                                    const t = document.getElementById("toast");
                                    t && (t.innerHTML = '<div class="bg-emerald-500 text-white px-4 py-3 rounded-xl shadow-xl flex items-center gap-3"><span class="material-symbols-rounded">check_circle</span><div><p class="font-bold text-sm">¬°Ya tienes acceso!</p></div></div>', t.classList.remove("translate-x-full"), setTimeout(() => t.classList.add("translate-x-full"), 3e3))
                                } else console.log("User NOT enrolled. Redirecting to landing..."), window.location.href = "landing-nuevo.html"; // REDIRECT
                            const d = document.getElementById("teaser-message"),
                                m = document.getElementById("teaser-action-text"),
                                u = document.getElementById("teaser-action-btn");
                            d && (d.innerHTML = "Aprende a <strong>usar IA sin saber programar</strong>. Accede al Curso + B√≥veda de Prompts con descuento especial."), m && (m.textContent = "Ver Ofertas"), u && (u.href = "landing-nuevo.html", u.onclick = e => { e.preventDefault(); window.location.href = "landing-nuevo.html"; }), currentCaseId && n(currentCaseId) // UPDATE TEASER
                        } else {
                            const e = document.getElementById("user-profile");
                            e && (e.classList.add("hidden"), e.classList.remove("flex"));
                            const t = document.getElementById("teaser-message"),
                                o = document.getElementById("teaser-action-text"),
                                a = document.getElementById("teaser-action-btn");
                            t && (t.innerHTML = "Aprende a <strong>usar IA sin saber programar</strong>. Accede al Curso + B√≥veda de Prompts con descuento especial."), o && (o.textContent = "Ver Ofertas"), a && (a.href = "landing-nuevo.html", a.onclick = e => { e.preventDefault(); window.location.href = "landing-nuevo.html"; }); // REDIRECT
                            const r = document.getElementById("unlock-btn");
                            if (r) {
                                const e = r.querySelector("span:last-child");
                                e && (e.textContent = "Acceso Premium")
                            }
                            isVaultUnlocked = !1, r && r.classList.remove("hidden"), currentCaseId && n(currentCaseId)
                        }
                    });
                    const e = document.getElementById("logout-btn");
                    e && e.addEventListener("click", async () => {
                        try {
                            await auth.signOut(), window.location.reload()
                        } catch (e) {
                            console.error("Error al cerrar sesi√≥n:", e), alert("Error al cerrar sesi√≥n. Intenta nuevamente.")
                        }
                    })
                } function e(e) {
                    return e ? String(e).replace(/&/g, "&amp;").replace(/</g, "&lt;").replace(/>/g, "&gt;").replace(/"/g, "&quot;").replace(/'/g, "&#039;") : ""
                } function t(t) { if (!t) return ""; let o = String(t).trim(); console.log("üì• INPUT:", o.substring(0, 200)), o = o.replace(/<\/?[^>]+(>|$)/g, ""), o = o.replace(/^["']|["']$/g, "").trim(), o = o.replace(/[ \t]+/g, " ").trim(), o = o.replace(/\\n/g, "\n"), o = function (e) { const t = /(\|[^\n]+\|\n(?:\|[\s:-]+\|[\s\S]*?\n)?(?:\|[^\n]+\|\n?)*)/g; return e.replace(t, e => { const t = e.trim().split("\n").filter(e => e.trim()); if (t.length < 2) return e; const o = t[0].split("|").filter(e => e.trim()).map(e => e.trim()); let a = 1; (t[1] && t[1].includes("---") || t[1].includes(":--")) && (a = 2); const n = t.slice(a).map(e => e.split("|").filter(e => e.trim()).map(e => e.trim())); let r = "<table><thead><tr>"; return o.forEach(e => { r += `<th>${e}</th>` }), r += "</tr></thead><tbody>", n.forEach(e => { r += "<tr>", e.forEach(e => { r += `<td>${e}</td>` }), r += "</tr>" }), r += "</tbody></table>", r }) }(o), o = o.replace(/```([a-z]*)\n([\s\S]*?)```/gi, (e, t, o) => `¬ß¬ß¬ßPRE¬ß¬ß¬ß${o.trim()}¬ß¬ß¬ß/PRE¬ß¬ß¬ß`), o = o.replace(/`([^`]+)`/g, "¬ß¬ß¬ßCODE¬ß¬ß¬ß$1¬ß¬ß¬ß/CODE¬ß¬ß¬ß"), o = o.replace(/\*\*([^\*]+)\*\*/g, "¬ß¬ß¬ßSTRONG¬ß¬ß¬ß$1¬ß¬ß¬ß/STRONG¬ß¬ß¬ß"), o = o.replace(/\*([^\*\n]+)\*/g, "¬ß¬ß¬ßEM¬ß¬ß¬ß$1¬ß¬ß¬ß/EM¬ß¬ß¬ß"), o = o.replace(/((?:^|\n)- .+(?:\n|$))+/g, e => `¬ß¬ß¬ßUL¬ß¬ß¬ß${e.trim().split("\n").map(e => `¬ß¬ß¬ßLI¬ß¬ß¬ß${e.replace(/^- /, "").trim()}¬ß¬ß¬ß/LI¬ß¬ß¬ß`).join("")}¬ß¬ß¬ß/UL¬ß¬ß¬ß`), o = o.replace(/((?:^|\n)\d+\. .+(?:\n|$))+/g, e => `¬ß¬ß¬ßOL¬ß¬ß¬ß${e.trim().split("\n").map(e => `¬ß¬ß¬ßLI¬ß¬ß¬ß${e.replace(/^\d+\. /, "").trim()}¬ß¬ß¬ß/LI¬ß¬ß¬ß`).join("")}¬ß¬ß¬ß/OL¬ß¬ß¬ß`), o = o.replace(/^---$/gm, "¬ß¬ß¬ßHR¬ß¬ß¬ß"); const a = [], n = /(¬ß¬ß¬ß[^¬ß]+¬ß¬ß¬ß|<table>[\s\S]*?<\/table>)/g; let r, s = 0; for (; null !== (r = n.exec(o));)r.index > s && a.push(e(o.substring(s, r.index))), a.push(r[0]), s = r.index + r[0].length; s < o.length && a.push(e(o.substring(s))), o = a.join(""), o = o.replace(/¬ß¬ß¬ßHR¬ß¬ß¬ß/g, '<hr class="my-6 border-t-2 border-dashed border-slate-200 w-full">'), o = o.replace(/¬ß¬ß¬ßPRE¬ß¬ß¬ß/g, "<pre><code>"), o = o.replace(/¬ß¬ß¬ß\/PRE¬ß¬ß¬ß/g, "</code></pre>"), o = o.replace(/¬ß¬ß¬ßCODE¬ß¬ß¬ß/g, "<code>"), o = o.replace(/¬ß¬ß¬ß\/CODE¬ß¬ß¬ß/g, "</code>"), o = o.replace(/¬ß¬ß¬ßSTRONG¬ß¬ß¬ß/g, "<strong>"), o = o.replace(/¬ß¬ß¬ß\/STRONG¬ß¬ß¬ß/g, "</strong>"), o = o.replace(/¬ß¬ß¬ßEM¬ß¬ß¬ß/g, "<em>"), o = o.replace(/¬ß¬ß¬ß\/EM¬ß¬ß¬ß/g, "</em>"), o = o.replace(/¬ß¬ß¬ßUL¬ß¬ß¬ß/g, "<ul>"), o = o.replace(/¬ß¬ß¬ß\/UL¬ß¬ß¬ß/g, "</ul>"), o = o.replace(/¬ß¬ß¬ßOL¬ß¬ß¬ß/g, "<ol>"), o = o.replace(/¬ß¬ß¬ß\/OL¬ß¬ß¬ß/g, "</ol>"), o = o.replace(/¬ß¬ß¬ßLI¬ß¬ß¬ß/g, "<li>"), o = o.replace(/¬ß¬ß¬ß\/LI¬ß¬ß¬ß/g, "</li>"), o = o.split("\n\n").map(e => { if (!(e = e.trim())) return ""; if (e.startsWith("<table") || e.startsWith("<pre") || e.startsWith("<ul") || e.startsWith("<ol") || e.startsWith("<hr")) return e; const t = e.split("\n"), o = t.some(e => e.trim().match(/^- /)), a = t.some(e => e.trim().match(/^\d+\.\s/)); if (o || a) { let e = "", o = !1, a = !1; const n = "list-disc ml-5 space-y-1 text-slate-600 my-2", r = "list-decimal ml-5 space-y-1 text-slate-600 my-2", s = "mb-1 leading-snug text-slate-600"; return t.forEach(t => { let l = t.trim(); if (l.match(/^-{3,}$/)) return o && (e += "</ul>", o = !1), a && (e += "</ol>", a = !1), void (e += '<hr class="my-6 border-t-2 border-dashed border-slate-200 w-full">'); if (!l.includes("|") || !l.includes("-") || 0 !== l.replace(/[\s\:\-\|]/g, "").length) if (l.match(/^- /)) { a && (e += "</ol>", a = !1), o || (e += `<ul class="${n}">`, o = !0); const t = l.substring(2).trim(); e += `<li>${t}</li>` } else if (l.match(/^\d+\.\s/)) { o && (e += "</ul>", o = !1), a || (e += `<ol class="${r}">`, a = !0); const t = l.replace(/^\d+\.\s+/, "").trim(); e += `<li>${t}</li>` } else o && (e += "</ul>", o = !1), a && (e += "</ol>", a = !1), l && (e += `<div class="${s}">${l}</div>`) }), o && (e += "</ul>"), a && (e += "</ol>"), e } return `<div class="mb-2 leading-snug text-slate-600">${e.replace(/\n/g, "<br>")}</div>` }).join(""); const l = `<div class="markdown-content">${o}</div>`; return console.log("üì§ OUTPUT:", l.substring(0, 300)), l } function o(e) { try { if (!e) return ""; if (!e.startsWith("U2F")) return e; const t = CryptoJS.AES.decrypt(e, getEncryptionKey()); return t.toString(CryptoJS.enc.Utf8) || "Error: Corrupted Data" } catch (e) { return console.error("Decryption failed", e), "Error: Decryption Failed" } } function a(e) { currentViewMode = e; const t = document.getElementById("btn-basic"), o = document.getElementById("btn-agia"), a = document.getElementById("maestro-cta-badge"), n = document.getElementById("content-basic"), r = document.getElementById("content-agia"), s = document.getElementById("copy-btn"), l = document.getElementById("copy-btn-container"); if ("basic" === e) { n.classList.remove("hidden"), r.classList.add("hidden"), t.classList.add("bg-slate-600", "text-white"), t.classList.remove("text-slate-600"), o.classList.remove("bg-indigo-600", "text-white"), o.classList.add("text-slate-600", "animate-pulse", "ring-2", "ring-emerald-400", "ring-offset-2"), a && a.classList.remove("hidden"), l && l.classList.add("hidden"), s.disabled = !0, s.classList.remove("bg-indigo-600", "hover:bg-indigo-700", "text-white", "shadow-sm"), s.classList.add("bg-slate-300", "text-slate-500", "cursor-not-allowed", "opacity-60"); const e = document.getElementById("maestro-social-proof"); e && (e.classList.add("hidden"), e.classList.remove("flex")) } else { n.classList.add("hidden"), r.classList.remove("hidden"), t.classList.remove("bg-slate-600", "text-white"), t.classList.add("text-slate-600"), o.classList.add("bg-indigo-600", "text-white"), o.classList.remove("text-slate-600", "animate-pulse", "ring-2", "ring-emerald-400", "ring-offset-2"), a && a.classList.add("hidden"), l && l.classList.remove("hidden"), s.disabled = !1, s.classList.add("bg-indigo-600", "hover:bg-indigo-700", "text-white", "shadow-sm"), s.classList.remove("bg-slate-300", "text-slate-500", "cursor-not-allowed", "opacity-60"); const e = document.getElementById("maestro-social-proof"), i = document.getElementById("maestro-counter"), c = document.querySelector("#maestro-social-proof .text-\\[9px\\]"); if (e && i && c && currentCaseId) { const t = `social-proof-${currentCaseId}`; let o = localStorage.getItem(t); o || (o = Math.floor(251 * Math.random()) + 150, localStorage.setItem(t, o)), i.textContent = o; const a = ["copiaron", "usando", "aplicaron", "compartieron"], n = currentCaseId % a.length; c.innerHTML = `<span id="maestro-counter">${o}</span> ${a[n]}`, e.classList.remove("smoke-effect"), e.classList.remove("hidden"), e.classList.add("flex"), e.offsetWidth, e.classList.add("smoke-effect") } } } function n(n) { currentCaseId = n; const r = casesData.find(e => e.id === n); if (!r) return; const s = document.getElementById("detail-scroll-container"); s && (s.scrollTop = 0); const l = !0 === r.locked, i = isVaultUnlocked || !l, c = !i; console.log(`üîí Prompt #${n} "${r.title}": locked=${r.locked}, enrollment=${isVaultUnlocked} => effectivelyLocked=${c}`), currentDifficulty = r.difficulty || "beginner", document.querySelectorAll(".case-item").forEach(e => { e.classList.remove("bg-indigo-50", "border-indigo-100", "text-indigo-700"), e.classList.add("border-transparent", "text-slate-600") }); const d = document.getElementById(`case-item-${n}`); d && (d.classList.remove("border-transparent", "text-slate-600"), d.classList.add("bg-indigo-50", "border-indigo-100", "text-indigo-700")), document.getElementById("workspace-empty").classList.add("hidden"), document.getElementById("case-detail").classList.remove("hidden"), document.getElementById("detail-title").innerText = r.title, document.getElementById("detail-problem").innerText = r.description || r.problem, document.getElementById("bad-result-preview").innerHTML = t(r.badResponsePreview || ""), document.getElementById("bad-response-analysis").innerHTML = r.badResponseAnalysis || "", document.getElementById("good-result-preview").innerHTML = t(r.previewResponse); const m = config.categories[r.category] || { label: "General", color: "slate" }, u = document.getElementById("detail-category-badge"); u.innerText = r.category, u.className = `text-[9px] font-bold uppercase tracking-wider px-2 py-0.5 rounded border shadow-sm bg-white text-${m.color}-600 border-${m.color}-100`; const p = document.getElementById("ai-suggestion-badge"), g = document.getElementById("ai-name"); if (r.suggestedAI) { let e = r.suggestedAI.toUpperCase(); g.innerText = e, p.classList.remove("hidden"), p.classList.add("flex") } else p.classList.add("hidden"), p.classList.remove("flex"); const b = document.getElementById("benefit-badge"); b && ("beginner" === currentDifficulty ? (b.innerHTML = '<span class="material-symbols-rounded text-sm">bolt</span> Ahorro: ~15 min', b.className = "text-[10px] font-bold text-emerald-600 bg-emerald-50 px-2.5 py-1 rounded-md border border-emerald-100 flex items-center gap-1.5 shadow-sm") : "intermediate" === currentDifficulty ? (b.innerHTML = '<span class="material-symbols-rounded text-sm">rocket_launch</span> Ahorro: ~45 min', b.className = "text-[10px] font-bold text-amber-600 bg-amber-50 px-2.5 py-1 rounded-md border border-amber-100 flex items-center gap-1.5 shadow-sm") : (b.innerHTML = '<span class="material-symbols-rounded text-sm">diamond</span> Ahorro: +2 Horas', b.className = "text-[10px] font-bold text-rose-600 bg-rose-50 px-2.5 py-1 rounded-md border border-rose-100 flex items-center gap-1.5 shadow-sm")); const f = document.getElementById("tip-container"), h = document.getElementById("validation-container"), y = document.getElementById("detail-example-tip"), x = document.getElementById("detail-validation-tip"); if (r.exampleTip ? (y.innerHTML = r.exampleTip, f.classList.remove("hidden"), f.classList.add("flex")) : (f.classList.add("hidden"), f.classList.remove("flex")), r.validationTip ? (x.innerHTML = r.validationTip, h.classList.remove("hidden"), h.classList.add("flex")) : (h.classList.add("hidden"), h.classList.remove("flex")), currentPromptTemplate = r.agiaPromptTagged, currentPromptTemplate.startsWith("U2F") && i && (currentPromptTemplate = o(currentPromptTemplate)), currentBadPromptTemplate = r.badPromptDynamic || r.badPrompt, currentVariables = {}, !currentPromptTemplate.startsWith("U2F")) { const e = /{([a-z0-9_]+)\|([^}]+)}/g; let t; for (; null !== (t = e.exec(currentPromptTemplate));)currentVariables[t[1]] = t[2] } !function () { let t = e(currentPromptTemplate); Object.keys(currentVariables).forEach(o => { const a = currentVariables[o] || "___", n = e(a), r = new RegExp(`{${o}\\|[^}]+}`, "g"); t = t.replace(r, `<span class="var-highlight">${n}</span>`) }); const o = { r: "rol", c: "contexto", m: "meta", l: "restricciones", f: "formato" }; Object.keys(o).forEach(e => { const a = `hl-${o[e]}`, n = new RegExp(`{${e}}(.*?){/${e}}`, "gs"); t = t.replace(n, `<span class="hl-tag ${a}" data-tag-type="${e}">$1</span>`) }), t = t.replace(/\n/g, "<br>"), document.getElementById("detail-prompt-rendered").innerHTML = t, function (t) { const o = document.getElementById("agia-sections-container"); if (!o) return; o.innerHTML = ""; const a = { ROL: { bg: "bg-blue-50", text: "text-blue-800", label: "Rol", border: "border-blue-200" }, CONTEXTO: { bg: "bg-emerald-50", text: "text-emerald-800", label: "Contexto", border: "border-emerald-200" }, META: { bg: "bg-amber-50", text: "text-amber-800", label: "Meta", border: "border-amber-200" }, RESTRICCIONES: { bg: "bg-rose-50", text: "text-rose-800", label: "Restricciones", border: "border-rose-200" }, FORMATO: { bg: "bg-violet-50", text: "text-violet-800", label: "Formato", border: "border-violet-200" } }; let n = {}; if (/\d+\.\s*(ROL|CONTEXTO|META|RESTRICCIONES|FORMATO):/i.test(t)) { const e = /(\d+)\.\s*(ROL|CONTEXTO|META|RESTRICCIONES|FORMATO):\s*([^]*?)(?=\d+\.\s*(?:ROL|CONTEXTO|META|RESTRICCIONES|FORMATO):|$)/gi; let o; for (; null !== (o = e.exec(t));) { const e = o[2].toUpperCase(), t = o[3].trim(); n[e] = t } } else { const e = { ROL: /{r}|(?:^|\n)(?:Eres un|Act√∫a como)/i, CONTEXTO: /{c}|\nCONTEXTO:/i, META: /{m}|\nMETA:/i, RESTRICCIONES: /{l}|\nRESTRICCIONES:/i, FORMATO: /{f}|\nFORMATO:/i }; let o = []; if (Object.entries(e).forEach(([e, a]) => { let n; const r = new RegExp(a.source, "gi"); for (; null !== (n = r.exec(t));)o.push({ index: n.index, length: n[0].length, section: e }) }), o.sort((e, t) => e.index - t.index), 0 === o.length) n.ROL = t; else for (let e = 0; e < o.length; e++) { const a = o[e], r = e + 1 < o.length ? o[e + 1].index : t.length, s = a.index + a.length; let l = t.substring(s, r).trim(); l = l.replace(/^(ROL:|CONTEXTO:|META:|RESTRICCIONES:|FORMATO:)\s*/i, "").trim(), l && (n[a.section] || (n[a.section] = ""), n[a.section] += (n[a.section] ? " " : "") + l) } } ["ROL", "CONTEXTO", "META", "FORMATO", "RESTRICCIONES"].forEach(t => { const r = n[t]; if (!r) return; const s = a[t] || { bg: "bg-slate-50", text: "text-slate-800", label: t, border: "border-slate-200" }, l = document.createElement("div"); l.className = `my-2 rounded-lg border ${s.border} hover:border-indigo-300 transition-all ${s.bg} px-4 py-3 shadow-sm`; let i = e(r).replace(/^-{3,}\s*$/gm, "").replace(/{\/?[rcmlf]}/gi, "").replace(/\[([^\]\n]+)\](?!\()/g, '<span class="var-highlight">$1</span>').replace(/\n/g, "<br>"); l.innerHTML = `\n                        <div class="flex items-start gap-2">\n                            <span class="text-[10px] font-extrabold uppercase tracking-wider ${s.text} bg-white/60 px-2 py-1 rounded border ${s.border} flex-shrink-0 shadow-sm">\n                                ${s.label}\n                            </span>\n                            <span class="${s.text} text-sm leading-relaxed flex-1" style="word-wrap: break-word; overflow-wrap: break-word;">\n                                ${i}\n                            </span>\n                        </div>\n                    `, o.appendChild(l) }) }(currentPromptTemplate); let a = e(currentBadPromptTemplate); Object.keys(currentVariables).forEach(t => { const o = currentVariables[t] || "...", n = e(o), r = new RegExp(`{${t}}`, "g"); a = a.replace(r, `<span class="var-highlight-bad">${n}</span>`) }), document.getElementById("bad-prompt-rendered").innerHTML = `"${a}"` }(); const w = document.getElementById("detail-tier-badge"); if (w) { [1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15].includes(r.id) ? (w.innerHTML = '<span class="material-symbols-rounded text-[10px]">campaign</span> GRATUITO', w.className = "text-[9px] font-black uppercase tracking-wider px-2 py-0.5 rounded border shadow-sm bg-emerald-100 text-emerald-700 border-emerald-200") : c ? (w.innerHTML = '<span class="material-symbols-rounded text-[10px] filled">lock</span> MAESTRO', w.className = "text-[9px] font-black uppercase tracking-wider px-2 py-0.5 rounded border shadow-sm bg-indigo-600 text-white border-indigo-700") : (w.innerHTML = '<span class="material-symbols-rounded text-[10px] filled">lock_open</span> MAESTRO', w.className = "text-[9px] font-black uppercase tracking-wider px-2 py-0.5 rounded border shadow-sm bg-indigo-100 text-indigo-700 border-indigo-200") } const v = document.getElementById("locked-teaser"), E = document.getElementById("prompt-blur-wrapper"), L = document.getElementById("copy-btn"), T = document.getElementById("result-teaser-label"), I = document.getElementById("teaser-action-btn"); I && (I.onclick = e => { e.preventDefault(), window.showCouponModal() }); const S = document.getElementById("vault-password"); S && (S.value = ""), c ? (v.classList.remove("hidden"), E.classList.add("blur-prompt"), L.disabled = !0, L.classList.add("opacity-50", "cursor-not-allowed"), L.classList.remove("bg-indigo-600", "hover:bg-indigo-700", "text-white", "cursor-pointer"), L.innerHTML = '<span class="material-symbols-rounded text-sm copy-icon">lock</span><span class="copy-text">Bloqueado</span>', T.classList.remove("hidden"), T.classList.add("flex")) : (v.classList.add("hidden"), E.classList.remove("blur-prompt"), L.disabled = !1, L.classList.remove("opacity-50", "cursor-not-allowed"), L.classList.add("bg-indigo-600", "hover:bg-indigo-700", "text-white", "cursor-pointer"), L.innerHTML = '<span class="material-symbols-rounded text-sm copy-icon">content_copy</span><span class="copy-text">Copiar</span>', T.classList.add("hidden"), T.classList.remove("flex")), a(currentViewMode); const C = document.getElementById("social-proof-text"); if (C) { const e = Math.floor(.8 * r.id) + 7 * r.id % 30 * 5 + 45, t = [`Usado <span class="text-orange-600 text-xs">${e}</span> veces en la √∫ltima hora`, `<span class="text-orange-600 text-xs">${e}</span> personas lo est√°n usando ahora`, `Tendencia: <span class="text-orange-600 text-xs">${e}</span> usos recientes`], o = r.id % t.length; C.innerHTML = t[o] } const M = document.getElementById("social-counter-header"); if (M) { const e = Math.floor(.8 * r.id) + 7 * r.id % 30 * 5 + 45, t = [`${e} copiaron`, `${e} usando`, `${e} aplicaron`, `${e} compartieron`], o = r.id % t.length; M.innerText = t[o] } } function e(e) { return e ? String(e).replace(/&/g, "&amp;").replace(/</g, "&lt;").replace(/>/g, "&gt;").replace(/"/g, "&quot;").replace(/'/g, "&#039;") : e } function r() { const e = document.getElementById("detail-prompt-rendered"); if (!e) return ""; let t = e.innerText; return document.querySelectorAll(".var-input").forEach(e => { const o = e.dataset.original, a = e.value.trim() || e.placeholder; o && a && (t = t.replace(o, a)) }), t } function s() { confetti({ particleCount: 100, spread: 70, origin: { y: .6 } }); const e = document.getElementById("social-counter"); if (e) { let t = parseInt(e.innerText.replace(/,/g, "")); e.innerText = (t + 1).toLocaleString() } const t = r(), o = document.createElement("textarea"); o.value = t, document.body.appendChild(o), o.select(); try { document.execCommand("copy") } catch (e) { console.error("Error al copiar:", e) } document.body.removeChild(o) } window.scrollCategories = function (e) { const t = document.getElementById("category-nav"); t && (t.scrollBy({ left: e, behavior: "smooth" }), setTimeout(window.updateScrollArrows, 350)) }, window.updateScrollArrows = function () { const e = document.getElementById("category-nav"), t = document.getElementById("btn-scroll-left"), o = document.getElementById("btn-scroll-right"), a = document.getElementById("gradient-left"), n = document.getElementById("gradient-right"); if (!e || !t || !o) return; const r = e.scrollLeft > 10; t.style.display = r ? "flex" : "none", a && a.classList.toggle("hidden", !r), o && (o.style.setProperty("display", "flex", "important"), o.classList.remove("hidden")); const s = e.scrollWidth > e.scrollLeft + e.clientWidth + 5; n && n.classList.toggle("hidden", !s) }, document.addEventListener("DOMContentLoaded", () => { const e = document.getElementById("category-nav"); e && (e.addEventListener("scroll", window.updateScrollArrows), window.addEventListener("resize", window.updateScrollArrows), e.addEventListener("wheel", t => { e.scrollWidth > e.clientWidth && (t.preventDefault(), e.scrollBy({ left: t.deltaY < 0 ? -100 : 100, behavior: "smooth" })) }, { passive: !1 }), setTimeout(window.updateScrollArrows, 100), setTimeout(window.updateScrollArrows, 500), setTimeout(window.updateScrollArrows, 1e3), setTimeout(window.updateScrollArrows, 100), setTimeout(window.updateScrollArrows, 500), setTimeout(window.updateScrollArrows, 1e3)) }), window.highlightSection = function (e) { if (!e) return; const t = e.toUpperCase(), o = document.getElementById("agia-sections-container"); o && (o.style.transition = "all 0.3s ease", o.style.color = "#64748b"), document.querySelectorAll(".legend-item").forEach(e => { e.id.replace("legend-", "").toUpperCase() === t ? (e.style.opacity = "1", e.style.filter = "none", e.style.transform = "scale(1.08)", e.style.boxShadow = "0 8px 15px -3px rgba(79, 70, 229, 0.2)", e.style.zIndex = "20") : (e.style.opacity = "0.4", e.style.filter = "grayscale(1)", e.style.transform = "scale(0.96)", e.style.boxShadow = "none") }), document.querySelectorAll(".prompt-section").forEach(e => { (e.dataset.section || "").toUpperCase() === t ? (e.style.opacity = "1", e.style.filter = "none", e.style.transform = "scale(1.02)", e.style.zIndex = "10", e.style.position = "relative", e.style.color = "rgb(30, 41, 59)", e.style.boxShadow = "0 4px 6px -1px rgba(0, 0, 0, 0.1)", e.style.backgroundColor = "") : (e.style.backgroundColor = "transparent", e.style.opacity = "0.8", e.style.filter = "grayscale(1)", e.style.color = "#475569", e.style.transform = "scale(1)", e.style.boxShadow = "none") }) }, window.resetLegend = function () { const e = document.getElementById("agia-sections-container"); e && (e.style.color = ""), document.querySelectorAll(".legend-item").forEach(e => { e.style.opacity = "1", e.style.filter = "none", e.style.transform = "scale(1)", e.style.boxShadow = "none", e.style.zIndex = "" }), document.querySelectorAll(".prompt-section").forEach(e => { e.style.opacity = "1", e.style.filter = "none", e.style.transform = "scale(1)", e.style.zIndex = "", e.style.position = "", e.style.boxShadow = "none", e.style.color = "", e.style.backgroundColor = "" }) }, window.copyPromptWithFeedback = function (e) { if (!e || e.disabled) return; const t = r(), o = document.createElement("textarea"); o.value = t, o.style.position = "fixed", o.style.left = "-9999px", document.body.appendChild(o), o.select(); try { if (document.execCommand("copy")) { const t = e.querySelector(".copy-icon"), o = e.querySelector(".copy-text"); if (!t || !o) return void console.warn("Copy button structure missing expected elements"); const a = e.className, n = t.innerHTML, r = o.textContent; e.className = "text-[10px] font-bold px-3 py-1.5 rounded-lg bg-emerald-500 text-white flex items-center gap-1.5 transition-all", t.innerHTML = "check_circle", o.textContent = "¬°Prompt Copiado!", "undefined" != typeof confetti && confetti({ particleCount: 100, spread: 70, origin: { y: .6 } }), setTimeout(() => { e.className = "text-[10px] font-bold px-3 py-1.5 rounded-lg bg-blue-500 text-white flex items-center gap-1.5 transition-all", t.innerHTML = "arrow_forward", o.textContent = "P√©galo en ChatGPT, Gemini o Claude", setTimeout(() => { e.className = a, t.innerHTML = n, o.textContent = r }, 3500) }, 1500) } } catch (e) { console.error("Error al copiar:", e) } finally { o && o.parentNode && o.parentNode.removeChild(o) } }; const l = { venta: ["vender", "marketing", "comercial", "lead", "cliente", "negocio", "ingreso", "dinero"], marketing: ["publicidad", "anuncio", "redes", "social", "campa√±a", "promoci√≥n", "difusi√≥n"], texto: ["redacci√≥n", "copy", "escribir", "blog", "art√≠culo", "guion", "email", "correo"], imagen: ["foto", "dise√±o", "logo", "visual", "arte", "midjourney", "dall-e", "creativo"], empresa: ["pyme", "emprendimiento", "negocio", "startup", "compa√±√≠a", "marca"], legal: ["contrato", "abogado", "ley", "norma", "sii", "impuesto", "tributario"], curso: ["educaci√≥n", "aprender", "taller", "clase", "ense√±ar", "formaci√≥n"], ia: ["inteligencia", "gpt", "chatgpt", "midjourney", "claude", "bot", "automatizaci√≥n"], idea: ["creatividad", "brainstorming", "invenci√≥n", "innovaci√≥n", "concepto"], plan: ["estrategia", "calendario", "cronograma", "organizaci√≥n", "paso a paso"] }; function i(t, o) { if (!o || 0 === o.length) return e(t); let a = e(t); const n = [...o].sort((e, t) => t.length - e.length), r = new RegExp(`(${n.join("|")})`, "gi"); return a.replace(r, e => `<span class="bg-yellow-200 text-yellow-900 font-bold px-0.5 rounded">${e}</span>`) } function c(e, t = []) { const o = document.getElementById("case-list"); document.getElementById("total-display").innerText = casesData.length, 0 !== e.length ? o.innerHTML = e.map(e => { let o = "bg-slate-300", a = "Desconocido"; "beginner" === e.difficulty ? (o = "bg-emerald-400", a = "B√°sico: 15 min") : "intermediate" === e.difficulty ? (o = "bg-amber-400", a = "Intermedio: 45 min") : "advanced" === e.difficulty && (o = "bg-rose-400", a = "Avanzado: 90-120 min"); const n = i(e.title, t), r = i(e.category, t); let s = ""; if (t.length > 0) { const o = t.some(t => e.title.toLowerCase().includes(t)), a = t.some(t => e.category.toLowerCase().includes(t)); if (!o && !a) { const o = function (e, t) { const o = [e.problem, e.badPrompt]; for (let e of o) { if (!e) continue; const o = e.toLowerCase(), a = t.find(e => o.includes(e)); if (a) { const n = o.indexOf(a), r = Math.max(0, n - 15), s = Math.min(e.length, n + a.length + 25); let l = e.substring(r, s); return r > 0 && (l = "..." + l), s < e.length && (l += "..."), i(l, t) } } return null }(e, t); o && (s = `<div class="mt-1.5 text-[10px] text-slate-500 bg-slate-50 p-1.5 rounded border border-slate-100 flex items-start gap-1">\n                                <span class="material-symbols-rounded text-[10px] text-indigo-400 mt-0.5">manage_search</span>\n                                <span class="leading-tight break-words has-highlights">${o}</span>\n                             </div>`) } } return `\n                <div id="case-item-${e.id}" onclick="loadCase(${e.id})" class="case-item group p-3 rounded-lg cursor-pointer hover:bg-slate-50 hover:shadow-sm transition-all border border-transparent hover:border-indigo-100 relative mb-1">\n                    <div class="flex items-center gap-3">\n                        <div class="w-8 h-8 rounded-lg bg-white border border-slate-100 flex items-center justify-center text-slate-400 group-hover:text-indigo-600 group-hover:bg-indigo-50 transition-colors shadow-sm shrink-0">\n                            <span class="material-symbols-rounded text-[16px]">${e.locked ? "lock" : e.icon}</span>\n                        </div>\n                        <div class="flex-1 min-w-0">\n                            <h4 class="text-xs font-bold truncate transition-colors text-slate-700 group-hover:text-indigo-900">${n}</h4>\n                            <div class="flex items-center gap-1.5 mt-0.5">\n                                <span class="w-1.5 h-1.5 rounded-full ${o}" title="${a}"></span>\n                                <span class="text-[10px] text-slate-400 truncate font-medium">${e.description || r}</span>\n                            </div>\n                            ${s}\n                        </div>\n                    </div>\n                </div>\n            ` }).join("") : o.innerHTML = '<div class="p-8 text-center text-xs text-slate-400 flex flex-col items-center"><span class="material-symbols-rounded text-2xl mb-2 opacity-50">search_off</span>Sin resultados.</div>' }
            } document.addEventListener("DOMContentLoaded", () => { initApp(); const e = document.getElementById("sidebar"), t = document.getElementById("mobile-menu-toggle"), o = document.getElementById("close-sidebar-btn"); function a() { e && e.classList.add("-translate-x-full") } t && t.addEventListener("click", function () { e && e.classList.remove("-translate-x-full") }), o && o.addEventListener("click", a); const n = document.getElementById("case-list"); n && n.addEventListener("click", e => { window.innerWidth < 768 && e.target.closest("button") && a() }) })</script>
    <div id="coupon-modal"
        class="fixed inset-0 bg-black/50 backdrop-blur-sm z-[100] hidden items-center justify-center p-4">
        <div class="bg-white rounded-2xl max-w-md w-full p-8 shadow-2xl transform transition-all">
            <div class="flex justify-between items-center mb-6">
                <h3 class="text-2xl font-black text-gray-900">¬øTienes un cup√≥n?</h3><button onclick="closeCouponModal()"
                    class="text-gray-400 hover:text-gray-600"><svg class="w-6 h-6" fill="none" stroke="currentColor"
                        viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                            d="M6 18L18 6M6 6l12 12" />
                    </svg></button>
            </div>
            <div class="mb-6"><label class="block text-sm font-bold text-gray-700 mb-2">C√≥digo de descuento
                    (opcional)</label> <input type="text" id="modal-coupon-input" placeholder="Ingresa tu c√≥digo"
                    class="w-full px-4 py-3 border-2 border-gray-300 rounded-lg focus:ring-2 focus:ring-teal-500 focus:border-teal-500 uppercase font-mono text-lg"
                    maxlength="20">
                <div id="modal-coupon-message" class="mt-2 text-sm font-medium hidden"></div>
            </div>
            <div id="modal-discount-summary" class="mb-6 p-4 bg-green-50 border-2 border-green-200 rounded-lg hidden">
                <div class="flex justify-between items-center mb-2"><span class="text-gray-600">Precio original:</span>
                    <span class="text-gray-900 font-bold" id="modal-original-price"></span>
                </div>
                <div class="flex justify-between items-center mb-2"><span class="text-green-600 font-bold">Descuento
                        (<span id="modal-discount-label"></span>):</span> <span class="text-green-600 font-bold text-xl"
                        id="modal-discount-amount"></span></div>
                <div class="flex justify-between items-center pt-2 border-t-2 border-green-300"><span
                        class="text-gray-900 font-black text-lg">Total a pagar:</span> <span
                        class="text-3xl font-black text-green-600" id="modal-final-price"></span></div>
                <p class="mt-3 text-xs text-gray-500 italic">* El descuento se aplicar√° autom√°ticamente en Mercado Pago.
                    Si el cup√≥n no se aplica correctamente, cont√°ctanos antes de completar el pago.</p>
            </div>
            <div class="flex gap-3"><button onclick="proceedWithoutCoupon()"
                    class="flex-1 px-6 py-3 border-2 border-gray-300 text-gray-700 rounded-lg hover:bg-gray-50 transition-colors font-bold">Sin
                    cup√≥n</button> <button id="modal-apply-btn" onclick="applyModalCoupon()"
                    class="flex-1 px-6 py-3 bg-teal-600 text-white rounded-lg hover:bg-teal-700 transition-colors font-bold">Aplicar
                    y continuar</button></div>
        </div>
        <!-- Duplicate coupon modal functions removed - defined in main script block -->
</body>

</html>
