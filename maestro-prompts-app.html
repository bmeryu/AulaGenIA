<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>B√≥veda de Prompts AGIA | Oferta Black Friday</title>
    
    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    
    <!-- Google Fonts & Icons -->
    <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined:opsz,wght,FILL,GRAD@24,400,1,0">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800&display=swap" rel="stylesheet">

    <style>
        body { font-family: 'Inter', sans-serif; background-color: #f8fafc; color: #1e293b; }
        
        /* Custom Scrollbar */
        .custom-scroll::-webkit-scrollbar { width: 6px; }
        .custom-scroll::-webkit-scrollbar-track { background: transparent; }
        .custom-scroll::-webkit-scrollbar-thumb { background: #cbd5e1; border-radius: 10px; }
        .custom-scroll::-webkit-scrollbar-thumb:hover { background: #94a3b8; }

        /* Animations */
        @keyframes fadeIn { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }
        .fade-in { animation: fadeIn 0.4s ease-out forwards; }
        
        /* Highlight Classes for Prompts */
        .hl-rol { background-color: #dbeafe; color: #1e40af; border-bottom: 2px solid #60a5fa; padding: 0 4px; border-radius: 4px; cursor: help; font-weight: 600; }
        .hl-contexto { background-color: #d1fae5; color: #065f46; border-bottom: 2px solid #34d399; padding: 0 4px; border-radius: 4px; cursor: help; font-weight: 600; }
        .hl-meta { background-color: #fef3c7; color: #92400e; border-bottom: 2px solid #fbbf24; padding: 0 4px; border-radius: 4px; cursor: help; font-weight: 600; }
        .hl-limites { background-color: #fee2e2; color: #b91c1c; border-bottom: 2px solid #f87171; padding: 0 4px; border-radius: 4px; cursor: help; font-weight: 600; }
        .hl-formato { background-color: #f3e8ff; color: #6b21a8; border-bottom: 2px solid #a855f7; padding: 0 4px; border-radius: 4px; cursor: help; font-weight: 600; }

        .prose-sm p { margin-bottom: 0.5em; }
        .prose-sm ul, .prose-sm ol { margin-left: 1.2em; margin-bottom: 0.5em; }
        .prose-sm li { margin-bottom: 0.2em; }
    </style>
</head>
<body class="h-screen flex flex-col overflow-hidden text-slate-800">

    <!-- BLACK FRIDAY BANNER -->
    <div class="bg-black text-white text-center py-2 px-4 text-xs md:text-sm font-bold tracking-wide z-50 flex justify-center items-center gap-2">
        <span class="material-symbols-outlined text-sm text-yellow-400">local_fire_department</span>
        <span>BLACK FRIDAY: Desbloquea la B√≥veda Completa por solo $9.990</span>
        <a href="#" onclick="openPaywall()" class="underline text-yellow-400 hover:text-yellow-300 ml-2">Ver Oferta</a>
    </div>

    <!-- Header -->
    <header class="bg-white border-b border-slate-200 shadow-sm z-20 flex-none relative">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-4">
            <div class="flex items-center justify-between mb-4">
                <div class="flex items-center gap-4">
                    <div class="h-10 w-10 bg-indigo-600 rounded-lg flex items-center justify-center text-white font-black text-xl shadow-indigo-200 shadow-lg">AG</div>
                    <div class="border-l border-slate-200 pl-4">
                        <h1 class="text-lg font-extrabold text-slate-900 tracking-tight">B√≥veda de Prompts <span class="text-indigo-600">AGIA</span></h1>
                        <p class="text-xs text-slate-500 font-medium">Librer√≠a de Copiar & Pegar</p>
                    </div>
                </div>
                <button onclick="openPaywall()" class="hidden md:flex bg-slate-900 text-white px-4 py-2 rounded-lg text-xs font-bold hover:bg-slate-800 transition-all items-center gap-2">
                    <span class="material-symbols-outlined text-sm text-yellow-400">lock_open</span>
                    DESBLOQUEAR TODO
                </button>
            </div>

            <!-- Category Navigation -->
            <div class="overflow-x-auto custom-scroll pb-2">
                <div class="flex space-x-2 min-w-max" id="category-nav"></div>
            </div>
        </div>
    </header>

    <!-- Main Layout -->
    <div class="flex flex-1 overflow-hidden max-w-7xl mx-auto w-full relative">
        
        <!-- Sidebar -->
        <aside class="w-full md:w-80 flex flex-col bg-white border-r border-slate-200 flex-none z-10 transition-all duration-300 absolute md:relative h-full transform -translate-x-full md:translate-x-0 shadow-xl md:shadow-none" id="sidebar">
            <div class="p-3 border-b border-slate-100">
                <div class="relative">
                    <span class="material-symbols-outlined absolute left-3 top-2.5 text-slate-400 text-lg">search</span>
                    <input type="text" id="searchInput" placeholder="Buscar prompt..." 
                        class="w-full pl-10 pr-4 py-2 bg-slate-50 border border-slate-200 rounded-lg text-sm focus:ring-2 focus:ring-indigo-500 transition-all"
                        onkeyup="filterCases()">
                </div>
            </div>
            <div class="flex-1 overflow-y-auto custom-scroll p-2 space-y-1" id="case-list"></div>
            <div class="p-3 border-t border-slate-100 text-xs text-center text-slate-400 bg-slate-50">
                B√≥veda cargada con <span id="count-display" class="font-bold">0</span> prompts
            </div>
        </aside>

        <!-- Mobile Toggle -->
        <button onclick="toggleSidebar()" class="md:hidden absolute bottom-6 left-6 z-40 bg-indigo-600 text-white p-4 rounded-full shadow-lg hover:bg-indigo-700 transition-colors">
            <span class="material-symbols-outlined">menu_open</span>
        </button>

        <!-- Main Content -->
        <main class="flex-1 flex flex-col bg-slate-50/50 overflow-hidden relative w-full">
            <div id="case-detail" class="flex-1 overflow-y-auto custom-scroll p-4 md:p-8 pb-24">
                <div class="max-w-5xl mx-auto fade-in">
                    
                    <!-- Title Header -->
                    <div class="flex items-center gap-4 mb-6 border-b border-slate-200 pb-6">
                        <div id="detail-icon-bg" class="w-16 h-16 rounded-2xl flex items-center justify-center shadow-md border border-white bg-white">
                            <span id="detail-icon" class="material-symbols-outlined text-3xl"></span>
                        </div>
                        <div class="flex-1">
                            <div class="flex items-center gap-2 mb-1">
                                <span id="detail-category-badge" class="text-[10px] font-bold uppercase tracking-wider px-2 py-0.5 rounded-full bg-slate-200 text-slate-600">Categor√≠a</span>
                                <span class="text-[10px] font-medium text-slate-400 flex items-center gap-1 bg-white px-2 py-0.5 rounded border border-slate-100">
                                    <span class="material-symbols-outlined text-[10px] text-green-500">verified</span> Validado
                                </span>
                            </div>
                            <h2 id="detail-title" class="text-2xl md:text-3xl font-bold text-slate-800 leading-tight">T√≠tulo del Caso</h2>
                            <p id="detail-problem" class="text-sm text-slate-500 mt-1 font-medium"></p>
                        </div>
                    </div>

                    <!-- AGIA LEGEND -->
                    <div class="mb-6 bg-white rounded-xl border border-slate-200 p-4 shadow-sm">
                        <h3 class="text-xs font-bold text-slate-400 uppercase mb-3">La F√≥rmula Secreta (AGIA)</h3>
                        <div class="flex flex-wrap gap-3 text-xs">
                            <div class="flex items-center gap-1.5 px-2 py-1 bg-blue-50 rounded border border-blue-100"><div class="w-3 h-3 rounded-full bg-blue-500"></div><span class="font-medium text-blue-700">Rol</span></div>
                            <div class="flex items-center gap-1.5 px-2 py-1 bg-emerald-50 rounded border border-emerald-100"><div class="w-3 h-3 rounded-full bg-emerald-500"></div><span class="font-medium text-emerald-700">Contexto</span></div>
                            <div class="flex items-center gap-1.5 px-2 py-1 bg-amber-50 rounded border border-amber-100"><div class="w-3 h-3 rounded-full bg-amber-500"></div><span class="font-medium text-amber-700">Meta</span></div>
                            <div class="flex items-center gap-1.5 px-2 py-1 bg-red-50 rounded border border-red-100"><div class="w-3 h-3 rounded-full bg-red-500"></div><span class="font-medium text-red-700">L√≠mites</span></div>
                            <div class="flex items-center gap-1.5 px-2 py-1 bg-purple-50 rounded border border-purple-100"><div class="w-3 h-3 rounded-full bg-purple-500"></div><span class="font-medium text-purple-700">Formato</span></div>
                        </div>
                    </div>

                    <!-- PROMPT MAESTRO (HERO) -->
                    <div class="bg-slate-900 rounded-2xl p-1 shadow-2xl mb-10 border border-slate-700 relative group overflow-hidden">
                        <!-- Top Bar -->
                        <div class="bg-slate-800/80 backdrop-blur rounded-t-xl px-4 py-3 flex justify-between items-center border-b border-slate-700">
                            <div class="flex items-center gap-2">
                                <span class="material-symbols-outlined text-yellow-400 text-sm animate-pulse">auto_awesome</span>
                                <span class="text-xs font-bold text-slate-200 tracking-wider">PROMPT MAESTRO (COPIAR Y PEGAR)</span>
                            </div>
                            <button onclick="copyPrompt()" class="flex items-center gap-2 text-xs bg-indigo-600 text-white hover:bg-indigo-500 px-4 py-1.5 rounded-lg font-bold transition-all shadow-lg ring-1 ring-white/10">
                                <span class="material-symbols-outlined text-sm">content_copy</span> COPIAR
                            </button>
                        </div>
                        <!-- Content -->
                        <div class="p-6 md:p-8 relative">
                            <p id="detail-prompt-rendered" class="font-mono text-sm md:text-base text-slate-200 leading-relaxed whitespace-pre-wrap">...</p>
                        </div>
                    </div>

                    <!-- COMPARISON GRID (BEFORE & AFTER) -->
                    <div class="grid md:grid-cols-2 gap-8">
                        
                        <!-- COLUMN 1: THE MISTAKE -->
                        <div class="flex flex-col gap-4">
                            <div class="flex items-center gap-2 pb-2 border-b border-slate-200">
                                <div class="w-6 h-6 rounded-full bg-slate-100 flex items-center justify-center text-slate-500 font-bold text-xs">A</div>
                                <h3 class="text-sm font-bold text-slate-500 uppercase">Modo Novato</h3>
                            </div>
                            
                            <!-- Bad Prompt -->
                            <div class="bg-slate-50 p-4 rounded-xl border border-slate-200 relative">
                                <div class="absolute -top-2.5 left-4 bg-slate-200 text-slate-600 text-[10px] font-bold px-2 py-0.5 rounded">INPUT (PROMPT)</div>
                                <p id="detail-bad-prompt" class="text-sm text-slate-500 italic font-mono">"..."</p>
                                <div class="mt-3 flex flex-wrap gap-2" id="deficiency-badges"></div>
                            </div>

                            <!-- Bad Result -->
                            <div class="bg-red-50 p-4 rounded-xl border border-red-100 relative opacity-80">
                                <div class="absolute -top-2.5 left-4 bg-red-100 text-red-600 text-[10px] font-bold px-2 py-0.5 rounded">OUTPUT (RESULTADO)</div>
                                <div class="text-xs text-slate-600 prose-sm font-medium">
                                    <div class="flex items-start gap-2">
                                        <span class="material-symbols-outlined text-red-400 text-lg flex-none">cancel</span>
                                        <div id="detail-bad-result">Respuesta gen√©rica...</div>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- COLUMN 2: THE SOLUTION -->
                        <div class="flex flex-col gap-4">
                            <div class="flex items-center gap-2 pb-2 border-b border-indigo-200">
                                <div class="w-6 h-6 rounded-full bg-indigo-100 flex items-center justify-center text-indigo-600 font-bold text-xs">B</div>
                                <h3 class="text-sm font-bold text-indigo-700 uppercase">Modo Experto AGIA</h3>
                            </div>

                            <!-- Pointer to Hero -->
                            <div class="hidden md:flex items-center gap-2 text-xs text-indigo-400 italic px-4">
                                <span class="material-symbols-outlined text-lg">arrow_upward</span>
                                El prompt maestro de arriba genera esto üëá
                            </div>

                            <!-- Good Result -->
                            <div class="bg-indigo-50 p-5 rounded-xl border border-indigo-100 relative shadow-sm h-full">
                                <div class="absolute -top-2.5 left-4 bg-indigo-600 text-white text-[10px] font-bold px-2 py-0.5 rounded shadow-sm">OUTPUT (RESULTADO)</div>
                                <div id="preview-response" class="text-xs text-slate-800 prose-sm mt-2">
                                    <!-- JS injects preview here -->
                                </div>
                            </div>
                        </div>

                    </div>

                    <!-- Footer Image -->
                    <div class="mt-12 pt-8 border-t border-slate-200 opacity-60 hover:opacity-100 transition-opacity">
                        <p class="text-[10px] text-center text-slate-400 uppercase tracking-widest mb-4">Referencia: Estructura AGIA</p>
                        <img src="https://aulagenia.cl/maestro-prompts.png" alt="Estructura AGIA" class="w-full max-w-2xl mx-auto rounded-lg grayscale hover:grayscale-0 transition-all">
                    </div>

                </div>
            </div>
        </main>
    </div>

    <!-- PAYWALL MODAL -->
    <div id="paywall-modal" class="fixed inset-0 z-[60] hidden">
        <div class="absolute inset-0 bg-slate-900/80 backdrop-blur-sm" onclick="closePaywall()"></div>
        <div class="absolute top-1/2 left-1/2 transform -translate-x-1/2 -translate-y-1/2 w-full max-w-md p-4">
            <div class="bg-white rounded-2xl shadow-2xl overflow-hidden animate-in fade-in zoom-in duration-300">
                <button onclick="closePaywall()" class="absolute top-3 right-3 text-white/50 hover:text-white bg-black/20 rounded-full p-1 z-10"><span class="material-symbols-outlined">close</span></button>
                <div class="bg-slate-900 p-8 text-center relative overflow-hidden">
                    <div class="absolute top-0 right-0 w-40 h-40 bg-indigo-600 rounded-full blur-3xl opacity-30 -mr-10 -mt-10"></div>
                    <span class="material-symbols-outlined text-5xl text-yellow-400 mb-2 relative z-10">lock</span>
                    <h3 class="text-white font-bold text-xl relative z-10">Contenido Premium</h3>
                </div>
                <div class="p-6 text-center">
                    <p class="text-slate-600 text-sm mb-6">Accede a los <span class="font-bold text-slate-900">100+ casos avanzados</span>.</p>
                    <div class="bg-yellow-50 border border-yellow-200 rounded-lg p-3 mb-6">
                        <p class="text-xs font-bold text-yellow-800 uppercase">üî• Oferta Black Friday</p>
                        <p class="text-2xl font-black text-slate-900">$9.990 <span class="text-sm font-normal text-slate-500 line-through">$19.990</span></p>
                    </div>
                    <a id="payment-btn" href="#" target="_blank" class="block w-full bg-indigo-600 text-white py-3 rounded-xl font-bold hover:bg-indigo-700 transition-all shadow-lg flex items-center justify-center gap-2">
                        <span>DESBLOQUEAR AHORA</span> <span class="material-symbols-outlined text-sm">arrow_forward</span>
                    </a>
                </div>
            </div>
        </div>
    </div>

    <script>
        // ==========================================
        // CONFIGURACI√ìN DE VENTA
        // ==========================================
        const LINK_MERCADO_PAGO = "#"; // <--- PEGA TU LINK AQU√ç
        document.getElementById('payment-btn').href = LINK_MERCADO_PAGO;

        // --- AGIA RENDERER ---
        function renderAGIA(text) {
            return text
                .replace(/{r}(.*?){\/r}/g, '<span class="hl-rol">$1</span>')
                .replace(/{c}(.*?){\/c}/g, '<span class="hl-contexto">$1</span>')
                .replace(/{m}(.*?){\/m}/g, '<span class="hl-meta">$1</span>')
                .replace(/{l}(.*?){\/l}/g, '<span class="hl-limites">$1</span>')
                .replace(/{f}(.*?){\/f}/g, '<span class="hl-formato">$1</span>')
                .replace(/\n/g, '<br>');
        }
        function cleanAGIA(text) { return text.replace(/{[rcmlf]}/g, '').replace(/{\/[rcmlf]}/g, ''); }

        // --- DATA ---
        const categoryConfig = {
            office: { label: "Oficina & Excel", color: "emerald", icon: "business_center" },
            finance: { label: "Finanzas", color: "cyan", icon: "attach_money" }, // FIX: SIN (Nuevo)
            marketing: { label: "Marketing", color: "pink", icon: "campaign" },
            personal: { label: "Vida Personal", color: "blue", icon: "home" },
            tech: { label: "Tecnolog√≠a", color: "violet", icon: "code" },
            education: { label: "Educaci√≥n", color: "amber", icon: "school" }
        };

        // ADDED badResPreview param
        const createCase = (id, cat, title, icon, problem, badPrompt, badResPreview, goodPromptTagged, goodResPreview, locked = false, deficiencies = []) => ({
            id, category: cat, title, icon, problem, 
            badPrompt, 
            badResPreview, // New field for Bad Result
            agiaPromptTagged: goodPromptTagged, 
            previewResponse: goodResPreview,
            locked: locked,
            deficiencies: deficiencies.length ? deficiencies : ["Sin Rol", "Contexto Vago"]
        });

        const allCases = [
            createCase(22, 'office', 'El Mago de Excel', 'table_view', 'F√≥rmulas desconocidas.', 
                'Ayuda con excel para sumar si cumple condici√≥n.', 
                'Prueba usando la funci√≥n SUMAR.SI. Selecciona el rango y pon el criterio. Es f√°cil.', // Bad Result
                '{r}Act√∫a como un instructor experto de Excel MVP.{/r} {c}Tengo una tabla de Ventas [Col A: Vendedores, B: Mes, C: Monto].{/c} {m}Necesito una f√≥rmula para sumar el total de "Juan" en "Enero".{/m} {f}F√≥rmula SUMAR.SI.CONJUNTO + explicaci√≥n.{/f}',
                '<div class="font-mono text-xs bg-slate-800 text-green-400 p-3 rounded mb-2 select-all">=SUMAR.SI.CONJUNTO(C:C; A:A; "Juan"; B:B; "Enero")</div><ul class="list-disc ml-4 space-y-1 text-slate-600"><li><strong>C:C</strong>: Rango Suma (Montos)</li><li><strong>A:A</strong>: Criterio 1 (Vendedores)</li></ul>',
                false, ["Sin Contexto", "Petici√≥n Gen√©rica"]),

            createCase(21, 'office', 'Traductor Corporativo', 'translate', 'Email dif√≠cil.', 
                'Redacta un correo para decir que no alcanzo a entregar.', 
                'Hola jefe, no alcanzo a terminar el informe hoy. Lo mando ma√±ana. Saludos.', // Bad Result
                '{r}Experto en comunicaci√≥n asertiva.{/r} {c}Retraso en informe por falta de datos.{/c} {m}Informar al jefe sin sonar irresponsable.{/m} {l}Prop√≥n nueva fecha.{/l}',
                '<div class="bg-white p-3 rounded border border-slate-200 italic text-slate-600">"Hola [Nombre], te actualizo sobre el informe. Debido a una demora en la data de Finanzas, no podr√© cerrarlo hoy. Ya gestion√© los datos y lo enviar√© el <strong>viernes AM</strong> sin falta."</div>',
                false, ["Excusa Vaga", "Tono Informal"]),

            createCase(90, 'finance', 'Negociador de Sueldo', 'payments', 'Pedir aumento.', 
                'C√≥mo pido un aumento.', 
                'Dile a tu jefe que trabajas mucho y necesitas m√°s dinero porque todo est√° caro.', // Bad Result
                '{r}Coach de negociaci√≥n.{/r} {c}2 a√±os en empresa, super√© KPIs 20%.{/c} {m}Guion para pedir ajuste salarial.{/m} {l}Enfocado en valor, no en necesidad.{/l}',
                '<p class="font-bold mb-1">Guion Estrat√©gico:</p><ul class="list-disc ml-4 space-y-2"><li><strong>Apertura:</strong> "Quer√≠a revisar mi impacto de estos 2 a√±os..."</li><li><strong>Evidencia:</strong> "Super√© la meta un 20%, generando X retorno."</li><li><strong>Cierre:</strong> "Solicito un ajuste del 15% para alinear mi compensaci√≥n al mercado."</li></ul>',
                false, ["Enfoque en Queja", "Sin Datos"]),

            createCase(41, 'marketing', 'Calendario RRSS', 'calendar_month', 'Bloqueo creativo.', 
                'Ideas para Instagram de caf√©.', 
                'Sube una foto de una taza de caf√© y pon "Buenos d√≠as". A la gente le gusta el caf√©.', // Bad Result
                '{r}Social Media Manager.{/r} {c}Marca de caf√© de grano.{/c} {m}3 ideas Edutainment.{/m} {f}Tabla con Ganchos Visuales.{/f}',
                '<table class="w-full text-xs border-collapse"><thead><tr class="bg-pink-100"><th class="p-1">T√≠tulo</th><th class="p-1">Gancho (3 seg)</th></tr></thead><tbody><tr><td>Tu caf√© sabe amargo</td><td>Tirar caf√© al lavaplatos ü§¢</td></tr><tr><td>Ahorra $50k/mes</td><td>Ticket Starbucks vs Bolsa Grano üìâ</td></tr></tbody></table>',
                false, ["Aburrido", "Sin Estrategia"]),
            
            // Fillers...
            createCase(1, 'personal', 'Men√∫ Supervivencia', 'restaurant', 'Sobras.', 'Qu√© cocino.', 'Haz arroz con huevo.', '{r}Chef.{/r} {m}Receta gourmet.{/m}', 'Tortilla Souffl√©...', false, ["Vago"]),
            createCase(81, 'education', 'Tutor Socr√°tico', 'psychology', 'Estudiar.', 'Explica inflaci√≥n.', 'Los precios suben.', '{r}Profe Econom√≠a.{/r} {m}Analog√≠a simple.{/m}', 'Imagina un √°lbum de l√°minas...', false, ["Simple"]),
        ];

        // Fillers generation
        const fillers = [
            {t: 'Debug Python', c: 'tech'}, {t: 'Resumen PDF', c: 'education'}, 
            {t: 'Logo AI', c: 'marketing'}, {t: 'Contratos', c: 'office'}
        ];
        let idCounter = 100;
        for(let i=0; i<4; i++) {
            fillers.forEach(f => allCases.push(createCase(idCounter++, f.c, f.t, 'lock', 'Premium', '...', '...', '...', '...', false))); // ALL UNLOCKED FOR REVIEW
        }

        // --- UI LOGIC ---
        let currentCategory = 'office';
        let searchQuery = '';

        function init() {
            renderCategories();
            renderCaseList();
            selectCase(22); // Default
        }

        function renderCategories() {
            const nav = document.getElementById('category-nav');
            nav.innerHTML = Object.keys(categoryConfig).map(key => {
                const conf = categoryConfig[key];
                const isActive = currentCategory === key;
                const activeClass = isActive 
                    ? `bg-${conf.color}-100 text-${conf.color}-700 border-${conf.color}-200 shadow-sm` 
                    : `bg-white text-slate-500 border-slate-100 hover:bg-slate-50`;
                return `<button onclick="setCategory('${key}')" class="flex items-center gap-2 px-4 py-2 rounded-full border text-xs font-bold transition-all whitespace-nowrap ${activeClass}"><span class="material-symbols-outlined text-lg">${conf.icon}</span>${conf.label}</button>`;
            }).join('');
        }

        function renderCaseList() {
            const listEl = document.getElementById('case-list');
            const filtered = allCases.filter(c => (c.category === currentCategory || searchQuery !== '') && (c.title.toLowerCase().includes(searchQuery.toLowerCase()) || c.problem.toLowerCase().includes(searchQuery.toLowerCase())));
            document.getElementById('count-display').innerText = allCases.length;
            
            if (filtered.length === 0) { listEl.innerHTML = `<div class="p-8 text-center text-slate-400 text-xs">No hay resultados</div>`; return; }

            listEl.innerHTML = filtered.map(c => {
                const config = categoryConfig[c.category];
                const iconDisplay = c.locked ? 'lock' : c.icon;
                const iconColorClass = c.locked ? 'text-slate-300 bg-slate-50' : `text-${config.color}-500 bg-white`;
                const lockOpacity = c.locked ? 'opacity-70' : '';
                return `<button onclick="selectCase(${c.id})" class="w-full text-left p-3 rounded-lg group transition-all mb-2 hover:bg-slate-50 border border-transparent relative overflow-hidden ${lockOpacity}">
                    <div class="flex items-center gap-3 pl-2">
                        <div class="w-8 h-8 rounded-lg border border-slate-100 flex items-center justify-center flex-none shadow-sm ${iconColorClass}">
                            <span class="material-symbols-outlined text-lg">${iconDisplay}</span>
                        </div>
                        <div class="overflow-hidden">
                            <h4 class="text-sm font-semibold text-slate-700 truncate group-hover:text-indigo-700 transition-colors flex items-center gap-2">
                                ${c.title} 
                                ${!c.locked ? '<span class="text-[9px] bg-green-100 text-green-700 px-1.5 rounded-full">GRATIS</span>' : ''}
                            </h4>
                            <p class="text-[10px] text-slate-400 truncate">${c.locked ? 'Premium' : c.problem}</p>
                        </div>
                    </div>
                </button>`;
            }).join('');
        }

        function selectCase(id) {
            const c = allCases.find(x => x.id === id);
            if(!c) return;
            if (c.locked) { openPaywall(); return; }

            const conf = categoryConfig[c.category];
            document.getElementById('detail-title').innerText = c.title;
            document.getElementById('detail-icon').innerText = c.icon;
            document.getElementById('detail-icon-bg').className = `w-16 h-16 rounded-2xl flex items-center justify-center shadow-lg border-2 border-white bg-${conf.color}-50 text-${conf.color}-600`;
            document.getElementById('detail-category-badge').innerText = conf.label;
            document.getElementById('detail-category-badge').className = `text-[10px] font-bold uppercase tracking-wider px-2 py-0.5 rounded-full bg-${conf.color}-100 text-${conf.color}-700 border border-${conf.color}-200`;
            document.getElementById('detail-problem').innerText = c.problem;
            
            // Bad Side
            document.getElementById('detail-bad-prompt').innerText = `"${c.badPrompt}"`;
            document.getElementById('detail-bad-result').innerText = c.badResPreview || "Respuesta gen√©rica..."; // Show Bad Result
            document.getElementById('deficiency-badges').innerHTML = c.deficiencies.map(d => `<span class="px-2 py-1 bg-red-50 text-red-600 text-[10px] font-bold rounded-md border border-red-100 flex items-center gap-1"><span class="material-symbols-outlined text-[10px]">warning</span>${d}</span>`).join('');

            // Good Side
            document.getElementById('detail-prompt-rendered').innerHTML = renderAGIA(c.agiaPromptTagged);
            document.getElementById('preview-response').innerHTML = c.previewResponse;

            if(window.innerWidth < 768) toggleSidebar();
        }

        function setCategory(cat) { currentCategory = cat; searchQuery = ''; document.getElementById('searchInput').value = ''; renderCategories(); renderCaseList(); }
        function filterCases() { searchQuery = document.getElementById('searchInput').value; renderCaseList(); }
        function copyPrompt() {
            const title = document.getElementById('detail-title').innerText;
            const c = allCases.find(x => x.title === title);
            if(!c) return;
            navigator.clipboard.writeText(cleanAGIA(c.agiaPromptTagged));
            // Feedback visual simple
            const btn = document.querySelector('button[onclick="copyPrompt()"]');
            btn.innerHTML = `<span class="material-symbols-outlined text-sm">check</span> ¬°LISTO!`;
            setTimeout(() => btn.innerHTML = `<span class="material-symbols-outlined text-sm">content_copy</span> COPIAR`, 2000);
        }
        function openPaywall() { document.getElementById('paywall-modal').classList.remove('hidden'); }
        function closePaywall() { document.getElementById('paywall-modal').classList.add('hidden'); }
        function toggleSidebar() { document.getElementById('sidebar').classList.toggle('-translate-x-full'); }

        init();
    </script>
</body>
</html>
