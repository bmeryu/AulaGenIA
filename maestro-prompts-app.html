<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>B√≥veda de Prompts AGIA 2.0 | Versi√≥n Premium</title>
    
    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    
    <!-- Google Fonts & Icons -->
    <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined:opsz,wght,FILL,GRAD@24,400,1,0">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800&display=swap" rel="stylesheet">
    <!-- Fuente para C√≥digo Premium -->
    <link href="https://fonts.googleapis.com/css2?family=JetBrains+Mono:wght@400;700&display=swap" rel="stylesheet">

    <style>
        body { font-family: 'Inter', sans-serif; background-color: #f3f4f6; }
        
        /* Custom Scrollbar */
        .custom-scroll::-webkit-scrollbar { width: 6px; height: 6px; }
        .custom-scroll::-webkit-scrollbar-track { background: transparent; }
        .custom-scroll::-webkit-scrollbar-thumb { background: #cbd5e1; border-radius: 10px; }
        .custom-scroll::-webkit-scrollbar-thumb:hover { background: #94a3b8; }

        /* Animations */
        @keyframes fadeIn { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }
        .fade-in { animation: fadeIn 0.4s ease-out forwards; }
        
        /* --- ESTILOS AGIA 2.0 --- */
        .font-code { font-family: 'JetBrains Mono', monospace; }

        /* Highlight Classes - Interactivos */
        .hl-base { transition: all 0.2s ease; cursor: help; position: relative; z-index: 1; }
        .hl-active { box-shadow: 0 0 0 2px rgba(255,255,255,0.8), 0 0 15px rgba(99, 102, 241, 0.6); transform: scale(1.05); z-index: 10; display: inline-block; }

        .hl-rol { background-color: #bfdbfe; color: #1e3a8a; padding: 2px 6px; border-radius: 4px; font-weight: 600; border: 1px solid #60a5fa; }
        .hl-contexto { background-color: #a7f3d0; color: #064e3b; padding: 2px 6px; border-radius: 4px; font-weight: 600; border: 1px solid #34d399; }
        .hl-ejemplos { background-color: #fcd34d; color: #92400e; padding: 2px 6px; border-radius: 4px; font-weight: 600; border: 1px solid #f59e0b; }
        .hl-meta { background-color: #fde68a; color: #78350f; padding: 2px 6px; border-radius: 4px; font-weight: 600; border: 1px solid #fbbf24; }
        .hl-limites { background-color: #fecaca; color: #7f1d1d; padding: 2px 6px; border-radius: 4px; font-weight: 600; border: 1px solid #f87171; }
        .hl-formato { background-color: #e9d5ff; color: #581c87; padding: 2px 6px; border-radius: 4px; font-weight: 600; border: 1px solid #a855f7; }
        .hl-validacion { background-color: #bbf7d0; color: #14532d; padding: 2px 6px; border-radius: 4px; font-weight: 600; border: 1px solid #22c55e; }

        /* LEYENDA INTERACTIVA */
        .legend-item { transition: all 0.3s ease; opacity: 0.6; filter: grayscale(80%); cursor: pointer; }
        .legend-item:hover, .legend-item.active { opacity: 1; transform: translateY(-2px); filter: grayscale(0%); box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1); background-color: white; z-index: 5; }

        /* SWITCH TOGGLE */
        .toggle-checkbox:checked { right: 0; border-color: #6366f1; }
        .toggle-checkbox:checked + .toggle-label { background-color: #6366f1; }
        
        /* EFECTO BLUR PAYWALL (Teaser) */
        .blur-content { filter: blur(6px); user-select: none; pointer-events: none; opacity: 0.5; }
        .premium-overlay { 
            position: absolute; top: 0; left: 0; width: 100%; height: 100%; 
            display: flex; flex-direction: column; align-items: center; justify-content: center;
            background: rgba(15, 23, 42, 0.1); z-index: 20;
            backdrop-filter: blur(2px);
        }

        /* TOAST NOTIFICATION */
        #toast-container {
            position: fixed; bottom: 20px; right: 20px; z-index: 100;
            transform: translateY(150px); opacity: 0; transition: all 0.5s cubic-bezier(0.68, -0.55, 0.27, 1.55);
        }
        #toast-container.show { transform: translateY(0); opacity: 1; }

        .prose-sm p { margin-bottom: 0.8em; line-height: 1.6; }
        .prose-sm ul, .prose-sm ol { margin-left: 1.2em; margin-bottom: 0.8em; }
        .prose-sm li { margin-bottom: 0.4em; }
        
        /* Tooltip Styles */
        .tooltip-trigger:hover .tooltip-content { display: block; }
    </style>
</head>
<body class="h-screen flex flex-col overflow-hidden text-slate-800 bg-slate-100">

    <!-- Header "Brand" Style -->
    <header class="bg-gradient-to-r from-blue-600 to-indigo-600 shadow-lg z-20 flex-none relative text-white">
        <div class="max-w-[1920px] mx-auto px-4 sm:px-6 lg:px-8 pt-4 pb-2">
            <!-- Top Row: Logo & CTA -->
            <div class="flex items-center justify-between mb-4">
                <div class="flex items-center gap-4">
                    <!-- Logo AGIA -->
                    <img src="https://aulagenia.cl/Logo_AGIA.png" alt="Logo AGIA" class="h-12 w-auto object-contain brightness-0 invert filter drop-shadow-md">
                    <div class="border-l border-white/20 pl-4 hidden sm:block">
                        <h1 class="text-lg font-bold tracking-tight leading-tight">B√≥veda de Prompts AGIA 2.0</h1>
                        <p class="text-[11px] text-indigo-100 font-medium opacity-90">Framework Avanzado de Ingenier√≠a de Prompts</p>
                    </div>
                </div>
                <!-- Bot√≥n Compra Header -->
                <button onclick="openPaywall()" class="hidden md:flex bg-yellow-400 hover:bg-yellow-300 text-indigo-900 px-4 py-1.5 rounded-full text-xs font-bold shadow-md transition-all items-center gap-2 transform hover:scale-105">
                    <span class="material-symbols-outlined text-sm">lock_open</span>
                    DESBLOQUEAR TODO
                </button>
            </div>

            <!-- Category Navigation (Pills) -->
            <div class="overflow-x-auto custom-scroll pb-2 -mx-4 px-4 md:mx-0 md:px-0">
                <div class="flex space-x-3 min-w-max" id="category-nav">
                    <!-- Injected by JS -->
                </div>
            </div>
        </div>
    </header>

    <!-- Main Layout -->
    <div class="flex flex-1 overflow-hidden max-w-[1920px] mx-auto w-full relative bg-slate-100">
        
        <!-- Sidebar -->
        <aside class="w-full md:w-80 flex flex-col bg-white border-r border-slate-200 flex-none z-10 transition-all duration-300 absolute md:relative h-full transform -translate-x-full md:translate-x-0 shadow-xl md:shadow-none" id="sidebar">
            <div class="p-4 border-b border-slate-100 bg-white sticky top-0 z-10">
                <div class="relative">
                    <span class="material-symbols-outlined absolute left-3 top-2.5 text-slate-400 text-lg">search</span>
                    <input type="text" id="searchInput" placeholder="Buscar prompt..." 
                        class="w-full pl-10 pr-4 py-2 bg-slate-50 border border-slate-200 rounded-lg text-sm focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500 transition-all"
                        onkeyup="filterCases()">
                </div>
            </div>
            <div class="flex-1 overflow-y-auto custom-scroll p-3 space-y-2" id="case-list">
                <!-- Cases injected by JS -->
            </div>
            <div class="p-3 border-t border-slate-100 text-xs text-center text-slate-400 bg-slate-50">
                B√≥veda cargada con <span id="count-display" class="font-bold">0</span> prompts
            </div>
        </aside>

        <!-- Mobile Toggle -->
        <button onclick="toggleSidebar()" class="md:hidden absolute bottom-6 left-6 z-40 bg-indigo-600 text-white p-4 rounded-full shadow-lg hover:bg-indigo-700 transition-colors flex items-center justify-center">
            <span class="material-symbols-outlined">menu_open</span>
        </button>

        <!-- Main Content -->
        <main class="flex-1 flex flex-col bg-slate-50 overflow-hidden relative w-full">
            
            <!-- Case Detail -->
            <div id="case-detail" class="flex-1 overflow-y-auto custom-scroll p-4 md:p-8 pb-24">
                <div class="max-w-5xl mx-auto fade-in">
                    
                    <!-- Title Header -->
                    <div class="flex items-center gap-4 mb-6 border-b border-slate-200 pb-6">
                        <div id="detail-icon-bg" class="w-12 h-12 md:w-16 md:h-16 rounded-2xl flex items-center justify-center border-2 bg-white shadow-sm">
                            <span id="detail-icon" class="material-symbols-outlined text-3xl"></span>
                        </div>
                        <div class="flex-1">
                            <div class="flex items-center gap-2 mb-1">
                                <span id="detail-category-badge" class="text-[10px] font-bold uppercase tracking-wider px-2 py-0.5 rounded-full border">Categor√≠a</span>
                                <span id="detail-verified-badge" class="text-[10px] font-medium text-slate-400 flex items-center gap-1 bg-white px-2 py-0.5 rounded border border-slate-100">
                                    <span class="material-symbols-outlined text-[10px] text-green-500">verified</span> Estructura AGIA 2.0
                                </span>
                            </div>
                            <h2 id="detail-title" class="text-2xl md:text-3xl font-bold text-slate-800 leading-tight">T√≠tulo del Caso</h2>
                            <p id="detail-problem" class="text-sm text-slate-500 mt-1 font-medium"></p>
                        </div>
                    </div>

                    <!-- AGIA 2.0 LEGEND (INTERACTIVA) -->
                    <div id="agia-legend" class="mb-6 bg-white rounded-xl border border-slate-200 shadow-sm p-1 flex overflow-x-auto">
                        <div class="legend-item flex-1 flex items-center justify-center py-2 border-r border-slate-100 gap-2 min-w-[90px]" data-type="rol" onmouseover="highlightText('rol')" onmouseout="clearHighlight()">
                            <div class="w-5 h-5 rounded bg-blue-100 text-blue-600 flex items-center justify-center text-[10px] font-bold">1</div>
                            <span class="text-[10px] font-bold uppercase text-slate-500 tracking-wide">Rol</span>
                        </div>
                        <div class="legend-item flex-1 flex items-center justify-center py-2 border-r border-slate-100 gap-2 min-w-[90px]" data-type="contexto" onmouseover="highlightText('contexto')" onmouseout="clearHighlight()">
                            <div class="w-5 h-5 rounded bg-emerald-100 text-emerald-600 flex items-center justify-center text-[10px] font-bold">2</div>
                            <span class="text-[10px] font-bold uppercase text-slate-500 tracking-wide">Contexto</span>
                        </div>
                        <div class="legend-item flex-1 flex items-center justify-center py-2 border-r border-slate-100 gap-2 min-w-[90px]" data-type="ejemplos" onmouseover="highlightText('ejemplos')" onmouseout="clearHighlight()">
                            <div class="w-5 h-5 rounded bg-yellow-100 text-yellow-700 flex items-center justify-center text-[10px] font-bold">3</div>
                            <span class="text-[10px] font-bold uppercase text-slate-500 tracking-wide">Ejemplos</span>
                        </div>
                        <div class="legend-item flex-1 flex items-center justify-center py-2 border-r border-slate-100 gap-2 min-w-[90px]" data-type="meta" onmouseover="highlightText('meta')" onmouseout="clearHighlight()">
                            <div class="w-5 h-5 rounded bg-amber-100 text-amber-600 flex items-center justify-center text-[10px] font-bold">4</div>
                            <span class="text-[10px] font-bold uppercase text-slate-500 tracking-wide">Meta</span>
                        </div>
                        <div class="legend-item flex-1 flex items-center justify-center py-2 border-r border-slate-100 gap-2 min-w-[90px]" data-type="limites" onmouseover="highlightText('limites')" onmouseout="clearHighlight()">
                            <div class="w-5 h-5 rounded bg-red-100 text-red-600 flex items-center justify-center text-[10px] font-bold">5</div>
                            <span class="text-[10px] font-bold uppercase text-slate-500 tracking-wide">L√≠mites</span>
                        </div>
                        <div class="legend-item flex-1 flex items-center justify-center py-2 border-r border-slate-100 gap-2 min-w-[90px]" data-type="formato" onmouseover="highlightText('formato')" onmouseout="clearHighlight()">
                            <div class="w-5 h-5 rounded bg-purple-100 text-purple-600 flex items-center justify-center text-[10px] font-bold">6</div>
                            <span class="text-[10px] font-bold uppercase text-slate-500 tracking-wide">Formato</span>
                        </div>
                        <div class="legend-item flex-1 flex items-center justify-center py-2 gap-2 min-w-[90px]" data-type="validacion" onmouseover="highlightText('validacion')" onmouseout="clearHighlight()">
                            <div class="w-5 h-5 rounded bg-green-100 text-green-600 flex items-center justify-center text-[10px] font-bold">7</div>
                            <span class="text-[10px] font-bold uppercase text-slate-500 tracking-wide">Validaci√≥n</span>
                        </div>
                    </div>

                    <!-- PROMPT BOX (HERO) - CON MAGIC SWITCH -->
                    <div id="main-box" class="bg-slate-900 rounded-2xl shadow-xl mb-8 border border-slate-700 relative transition-all duration-300">
                        <!-- Decorative Glow -->
                        <div id="box-glow" class="absolute top-0 left-1/2 transform -translate-x-1/2 w-2/3 h-1 bg-gradient-to-r from-transparent via-indigo-500 to-transparent opacity-70"></div>
                        
                        <!-- Header Prompt Box -->
                        <div id="box-header" class="bg-slate-800/80 backdrop-blur px-6 py-4 flex flex-col md:flex-row justify-between items-center border-b border-slate-700/50 rounded-t-2xl gap-4 md:gap-0">
                            
                            <!-- Magic Switch -->
                            <div class="flex items-center gap-3">
                                <span class="text-[10px] font-bold text-slate-400 uppercase tracking-wider">Modo Normal</span>
                                <label for="magic-toggle" class="flex items-center cursor-pointer relative">
                                    <input type="checkbox" id="magic-toggle" class="sr-only" onchange="toggleMagicMode()">
                                    <div class="w-12 h-6 bg-slate-700 rounded-full border border-slate-600 shadow-inner transition-colors duration-300 ease-in-out hover:border-indigo-500"></div>
                                    <div class="dot absolute left-1 top-1 w-4 h-4 bg-white rounded-full transition transform duration-300 ease-in-out shadow-sm"></div>
                                </label>
                                <span class="text-[10px] font-bold text-transparent bg-clip-text bg-gradient-to-r from-indigo-400 to-cyan-400 uppercase tracking-wider animate-pulse">‚ú® AGIA Mode</span>
                            </div>
                            
                            <div class="flex items-center gap-4 w-full md:w-auto justify-end">
                                <!-- Suggested AI Badge -->
                                <div id="ai-badge-container" class="hidden md:block"></div>
                                
                                <div class="flex flex-col items-end">
                                    <!-- Copy Button -->
                                    <button id="box-actions" onclick="copyPrompt()" class="flex items-center gap-2 text-xs bg-indigo-600 hover:bg-indigo-500 text-white px-4 py-2 rounded-lg font-bold transition-all shadow-lg shadow-indigo-500/20 border border-indigo-500">
                                        <span class="material-symbols-outlined text-sm">content_copy</span> 
                                        <span>COPIAR</span>
                                    </button>
                                    <!-- Social Proof Counter -->
                                    <span class="text-[9px] text-slate-500 mt-1 hidden md:block" id="social-proof-counter">üî• Usado 142 veces hoy</span>
                                </div>
                            </div>
                        </div>

                        <!-- Content Prompt Box -->
                        <div id="box-content-area" class="p-6 md:p-8 relative bg-slate-900/50 rounded-b-2xl min-h-[200px]">
                            <!-- Mobile AI Badge -->
                            <div id="ai-badge-mobile" class="md:hidden mb-6"></div>
                            
                            <!-- Prompt Rendered -->
                            <div id="detail-prompt-rendered" class="font-sans text-sm md:text-base leading-loose text-slate-400 italic transition-all duration-300">...</div>
                        </div>
                    </div>

                    <!-- COMPARISON GRID -->
                    <div id="comparison-container" class="grid md:grid-cols-2 gap-6">
                        
                        <!-- Bad Prompt & Bad Result -->
                        <div class="bg-white p-6 rounded-xl border border-slate-200 shadow-sm flex flex-col gap-4 opacity-70 hover:opacity-100 transition-opacity">
                            <div>
                                <h3 class="text-[10px] font-bold text-slate-400 uppercase mb-3 flex items-center gap-1 tracking-wider">
                                    <span class="material-symbols-outlined text-base text-red-400">close</span> Lo que escribe la mayor√≠a
                                </h3>
                                <div class="bg-slate-50 p-4 rounded-lg border border-slate-100 text-sm text-slate-500 italic font-mono">
                                    <p id="detail-bad-prompt">"..."</p>
                                </div>
                            </div>

                            <div class="pt-4 border-t border-slate-100">
                                <h3 class="text-[10px] font-bold text-slate-400 uppercase mb-2 flex items-center gap-1 tracking-wider">
                                    <span class="material-symbols-outlined text-base text-slate-400">output</span> Resultado T√≠pico (Sin AGIA)
                                </h3>
                                <div class="text-xs text-slate-600 leading-relaxed bg-slate-50/50 p-3 rounded border border-slate-100">
                                     <p id="detail-bad-result">...</p>
                                </div>
                            </div>

                            <div class="flex flex-wrap gap-2 mt-auto" id="deficiency-badges"></div>
                        </div>

                        <!-- Result Preview (Good) -->
                        <div class="bg-white p-6 rounded-xl border border-slate-200 shadow-sm flex flex-col relative overflow-hidden">
                            <h3 class="text-[10px] font-bold text-slate-400 uppercase mb-3 flex items-center gap-1 tracking-wider">
                                <span class="material-symbols-outlined text-base text-indigo-500">check_circle</span> Resultado AGIA (Optimizado)
                            </h3>
                            <div class="overflow-x-auto flex-1">
                                <div id="preview-response" class="text-xs text-slate-700 prose-sm bg-indigo-50/30 p-4 rounded-lg border border-indigo-100 h-full">
                                    <!-- JS injects preview here -->
                                </div>
                            </div>
                        </div>
                    </div>

                </div>
            </div>
        </main>
    </div>

    <!-- PAYWALL MODAL (VENTANA EMERGENTE) -->
    <div id="paywall-modal" class="fixed inset-0 z-[60] hidden">
        <div class="absolute inset-0 bg-slate-900/80 backdrop-blur-sm transition-opacity" onclick="closePaywall()"></div>
        <div class="absolute top-1/2 left-1/2 transform -translate-x-1/2 -translate-y-1/2 w-full max-w-md p-4">
            <div class="bg-white rounded-2xl shadow-2xl overflow-hidden relative animate-in fade-in zoom-in duration-300">
                <button onclick="closePaywall()" class="absolute top-3 right-3 text-slate-400 hover:text-slate-600 bg-white rounded-full p-1 z-10">
                    <span class="material-symbols-outlined">close</span>
                </button>
                
                <div class="bg-slate-900 p-8 text-center relative overflow-hidden">
                    <div class="absolute top-0 right-0 w-40 h-40 bg-indigo-600 rounded-full blur-3xl opacity-30 -mr-10 -mt-10"></div>
                    <span class="material-symbols-outlined text-5xl text-yellow-400 mb-2 relative z-10">lock</span>
                    <h3 class="text-white font-bold text-xl relative z-10">Contenido Premium</h3>
                    <p class="text-indigo-200 text-sm relative z-10">Este prompt es parte de la B√≥veda Privada.</p>
                </div>

                <div class="p-6 text-center">
                    <p class="text-slate-600 text-sm mb-6">
                        Est√°s viendo la versi√≥n gratuita. Accede a los <span class="font-bold text-slate-900">100+ casos avanzados</span> y copia mis f√≥rmulas validadas.
                    </p>
                    
                    <div class="bg-yellow-50 border border-yellow-200 rounded-lg p-3 mb-6">
                        <p class="text-xs font-bold text-yellow-800 uppercase tracking-wide">üî• Oferta Black Friday</p>
                        <p class="text-2xl font-black text-slate-900">$9.990 <span class="text-sm font-normal text-slate-500 line-through">$19.990</span></p>
                    </div>

                    <a id="payment-btn" href="#" target="_blank" class="block w-full bg-indigo-600 text-white py-3 rounded-xl font-bold hover:bg-indigo-700 hover:scale-[1.02] transition-all shadow-lg shadow-indigo-200 mb-3 flex items-center justify-center gap-2">
                        <span>DESBLOQUEAR B√ìVEDA AHORA</span>
                        <span class="material-symbols-outlined text-sm">arrow_forward</span>
                    </a>
                </div>
            </div>
        </div>
    </div>

    <!-- TOAST NOTIFICATION -->
    <div id="toast-container" class="bg-slate-900 text-white p-4 rounded-xl shadow-2xl border border-slate-700 flex items-start gap-4 max-w-sm">
        <div class="bg-green-500/20 p-2 rounded-full text-green-400">
            <span class="material-symbols-outlined">check_circle</span>
        </div>
        <div>
            <h4 class="font-bold text-sm text-white">¬°Prompt Copiado!</h4>
            <p class="text-xs text-slate-400 mt-1">Este prompt te ahorrar√° aprox. <span class="text-yellow-400 font-bold">20 minutos</span>.</p>
            <div class="mt-3 flex gap-2">
                <a href="#" class="text-[10px] bg-sky-500 hover:bg-sky-400 text-white px-3 py-1.5 rounded font-bold transition-colors">
                    Twittear √âxito
                </a>
                <button onclick="hideToast()" class="text-[10px] text-slate-400 hover:text-white px-2">Cerrar</button>
            </div>
        </div>
    </div>

    <!-- WELCOME MODAL (AGIA 2.0) -->
    <div id="welcome-modal" class="fixed inset-0 z-[70] hidden">
        <div class="absolute inset-0 bg-slate-900/90 backdrop-blur-sm transition-opacity"></div>
        <div class="absolute top-1/2 left-1/2 transform -translate-x-1/2 -translate-y-1/2 w-full max-w-2xl p-4 max-h-[90vh] overflow-y-auto">
            <div class="bg-white rounded-2xl shadow-2xl overflow-hidden relative">
                <button onclick="closeWelcome()" class="absolute top-3 right-3 text-slate-400 hover:text-slate-600 bg-white rounded-full p-1 z-10 shadow-md">
                    <span class="material-symbols-outlined">close</span>
                </button>
                
                <div class="bg-gradient-to-br from-indigo-600 to-purple-600 p-8 text-center relative overflow-hidden">
                    <div class="absolute top-0 left-0 w-full h-full opacity-10">
                         <!-- Decorative circles -->
                         <div class="absolute top-10 left-10 w-20 h-20 bg-white rounded-full"></div>
                    </div>
                    <span class="material-symbols-outlined text-6xl text-white mb-3 relative z-10">auto_awesome</span>
                    <h2 class="text-white font-bold text-3xl mb-2 relative z-10">¬°Bienvenido a AGIA 2.0!</h2>
                    <p class="text-indigo-100 text-sm relative z-10">La evoluci√≥n del sistema de prompts m√°s efectivo</p>
                </div>

                <div class="p-8">
                     <div class="bg-slate-50 rounded-xl p-4 mb-6 border border-slate-100">
                        <p class="text-sm font-bold text-slate-700 mb-2">Ahora con Modo Interactivo:</p>
                        <ul class="text-xs text-slate-600 space-y-2">
                            <li class="flex items-center gap-2"><span class="material-symbols-outlined text-indigo-500 text-sm">toggle_on</span> Usa el switch para ver la "magia" del formato.</li>
                            <li class="flex items-center gap-2"><span class="material-symbols-outlined text-indigo-500 text-sm">touch_app</span> Pasa el mouse por la leyenda para aprender.</li>
                        </ul>
                    </div>
                    <div class="text-center">
                        <button onclick="closeWelcome()" class="bg-indigo-600 text-white px-8 py-3 rounded-xl font-bold hover:bg-indigo-700 transition-all shadow-lg inline-flex items-center gap-2">
                            Empezar a explorar
                            <span class="material-symbols-outlined text-lg">arrow_forward</span>
                        </button>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        // ==========================================
        // CONFIGURACI√ìN DE VENTA & ESTADO
        // ==========================================
        const LINK_MERCADO_PAGO = "#"; 
        document.getElementById('payment-btn').href = LINK_MERCADO_PAGO;
        let activeCaseId = null;

        // --- HELPERS PARA AGIA 2.0 MARKUP INTERACTIVO ---
        function renderAGIA(text) {
            let html = text
                .replace(/{r}(.*?){\/r}/g, '<span class="hl-rol hl-base" data-type="rol" onmouseover="highlightText(\'rol\')" onmouseout="clearHighlight()">$1</span>')
                .replace(/{c}(.*?){\/c}/g, '<span class="hl-contexto hl-base" data-type="contexto" onmouseover="highlightText(\'contexto\')" onmouseout="clearHighlight()">$1</span>')
                .replace(/{e}(.*?){\/e}/g, '<span class="hl-ejemplos hl-base" data-type="ejemplos" onmouseover="highlightText(\'ejemplos\')" onmouseout="clearHighlight()">$1</span>')
                .replace(/{m}(.*?){\/m}/g, '<span class="hl-meta hl-base" data-type="meta" onmouseover="highlightText(\'meta\')" onmouseout="clearHighlight()">$1</span>')
                .replace(/{l}(.*?){\/l}/g, '<span class="hl-limites hl-base" data-type="limites" onmouseover="highlightText(\'limites\')" onmouseout="clearHighlight()">$1</span>')
                .replace(/{f}(.*?){\/f}/g, '<span class="hl-formato hl-base" data-type="formato" onmouseover="highlightText(\'formato\')" onmouseout="clearHighlight()">$1</span>')
                .replace(/{v}(.*?){\/v}/g, '<span class="hl-validacion hl-base" data-type="validacion" onmouseover="highlightText(\'validacion\')" onmouseout="clearHighlight()">$1</span>')
                .replace(/\n/g, '<br>');
            return html;
        }

        function cleanAGIA(text) {
            return text
                .replace(/{[rcemlfv]}/g, '')
                .replace(/{\/[rcemlfv]}/g, '')
                .replace(/<br\s*\/?>/gi, '\n')
                .replace(/&nbsp;/g, ' ')
                .replace(/<\/?[^>]+(>|$)/g, "");
        }

        // --- CONFIGURACI√ìN DE IAs ---
        const aiConfig = {
            chatgpt: { name: "ChatGPT", bg: "bg-indigo-600", icon: "bolt" }, 
            gemini: { name: "Gemini", bg: "bg-blue-600", icon: "psychology" },
            midjourney: { name: "Midjourney", bg: "bg-fuchsia-600", icon: "palette" },
            claude: { name: "Claude", bg: "bg-orange-600", icon: "auto_awesome" }
        };

        // --- CATEGOR√çAS ORIENTADAS A BENEFICIOS ---
        const categoryConfig = {
            office: { label: "üöÄ Productividad 10x", color: "emerald", icon: "speed" },
            finance: { label: "üí∞ Finanzas & Inversi√≥n", color: "amber", icon: "monetization_on" }, 
            marketing: { label: "üî• Ventas & Copy", color: "pink", icon: "ads_click" },
            creativity: { label: "üé® Arte Digital", color: "fuchsia", icon: "palette" }, 
            personal: { label: "üßò Vida Balanceada", color: "orange", icon: "self_improvement" },
            tech: { label: "üß† Cerebro Digital", color: "violet", icon: "code" }, 
            education: { label: "üéì Educaci√≥n", color: "cyan", icon: "school" },
            advanced: { label: "üõ†Ô∏è Ingenier√≠a Prompt", color: "slate", icon: "construction" },
            tools: { label: "‚öôÔ∏è Herramientas", color: "zinc", icon: "extension" }
        };

        const createCase = (id, cat, title, icon, problem, badPrompt, badResPreview, goodPromptTagged, goodResPreview, suggestedAI, locked = false, deficiencies = [], isTool = false, difficulty = 'beginner') => ({
            id, category: cat, title, icon, problem, 
            badPrompt, 
            badResponsePreview: badResPreview,
            agiaPromptTagged: goodPromptTagged, 
            previewResponse: goodResPreview,
            suggestedAI: suggestedAI, 
            locked: locked, 
            deficiencies: deficiencies.length ? deficiencies : ["Sin Rol", "Contexto Vago"],
            isTool: isTool,
            difficulty: difficulty
        });

        // --- BASE DE DATOS DE PROMPTS AGIA 2.0 ---
        const allCases = [
            // --- T√âCNICAS AVANZADAS ---
            createCase(801, 'advanced', 'Anti-Patr√≥n: Prompt Ambiguo', 'warning', 'Qu√© NO hacer al pedir ayuda con IA', 
                'Ay√∫dame con Excel.',
                'Claro, ¬øqu√© necesitas hacer en Excel? (Se pierde 1 minuto esperando aclaraci√≥n)', 
                '{r}Act√∫a como Ingeniero de Datos.{/r} {c}Tengo 3 columnas: Ventas (columna A), Fecha (columna B), y Vendedor (columna C).{/c} {m}Necesito:\n1. Crear una tabla din√°mica que muestre ventas totales por vendedor\n2. Filtrar solo los datos del √∫ltimo trimestre{/m} {f}Dame los pasos numerados con capturas de men√∫.{/f}', 
                '<p class="text-xs font-bold mb-2">Pasos para crear Tabla Din√°mica:</p><ol class="list-decimal ml-4 text-xs space-y-1"><li>Selecciona todo el rango (A1:C501): <strong>Ctrl + Shift + Fin</strong></li><li>Men√∫: <strong>Alt ‚Üí N ‚Üí V</strong></li></ol>', 
                'gemini', false, ["Sin Contexto", "P√©rdida de Tiempo"], false, 'intermediate'),

            // --- CASO PREMIUM DE EJEMPLO (LOCKED) ---
            createCase(802, 'advanced', 'Encadenamiento de Prompts', 'link', 'Para proyectos complejos, divide en etapas', 
                'Analiza este informe financiero y hazme un resumen.',
                'Respuesta superficial que toca todo pero sin profundidad.', 
                '{r}Act√∫a como CFO.{/r} {c}Adjunto informe Q3.{/c} {m}PASO 1: Identifica 3 hallazgos cr√≠ticos en m√°rgenes.{/m} {l}Ignora notas al pie.{/l} {f}Lista de 3 hallazgos con cifra exacta.{/f}', 
                '<p>Contenido Premium...</p>', 
                'chatgpt', true, ["Prompt √önico Gigante", "Superficial"], false, 'advanced'),
            
            // --- MARKETING (GRATIS) ---
             createCase(301, 'marketing', 'Generador de T√≠tulos Virales', 'campaign', 'Mis t√≠tulos no generan clics', 
                'Dame ideas de t√≠tulos para un video sobre productividad.',
                '1. Consejos de productividad\n2. C√≥mo ser m√°s productivo\n3. Tips para trabajar mejor', 
                '{r}Act√∫a como Experto en Clickbait √âtico de YouTube.{/r} {c}El video trata sobre la t√©cnica Pomodoro pero aplicada a padres ocupados.{/c} {e}MALO: "Usa la t√©cnica Pomodoro"\nBUENO: "Prob√© Pomodoro por 7 d√≠as con mis hijos y pas√≥ esto"{/e} {m}Genera 5 t√≠tulos que generen curiosidad (gap de informaci√≥n).{/m} {l}M√°ximo 50 caracteres. Sin exclamaciones excesivas.{/l} {f}Lista numerada con una breve explicaci√≥n de por qu√© funciona cada uno.{/f} {v}Deben provocar una emoci√≥n espec√≠fica (miedo a perderse algo, curiosidad, validaci√≥n).{/v}', 
                '<ul class="list-disc ml-4 text-xs"><li><strong>"Por qu√© dej√© de usar listas de tareas (y qu√© hago ahora)"</strong>: Rompe una creencia com√∫n.</li><li><strong>"La regla de los 25 minutos que salv√≥ mi matrimonio"</strong>: Beneficio emocional inesperado.</li></ul>', 
                'claude', false, ["Aburrido", "Gen√©rico"], false, 'beginner'),

             // --- OFFICE ---
            createCase(22, 'office', 'El Limpiador de Data', 'cleaning_services', 'Base de datos sucia (Nombres, May√∫sculas).', 
                'Limpia estos nombres de la columna A y d√©jalos en formato t√≠tulo.',
                'Usa =NOMPROPIO(A1)', 
                '{r}Act√∫a como Ingeniero de Datos especializado en Excel.{/r} {c}Tengo una columna A con nombres sucios: "  JUAN  perez  ".{/c} {m}Genera UNA f√≥rmula que elimine espacios y capitalice.{/m} {f}```\n=F√ìRMULA\n```{/f} {v}Debe transformar "  JUAN " en "Juan"{/v}', 
                '<div class="font-mono text-xs bg-slate-800 text-green-400 p-3 rounded mb-2">=NOMPROPIO(ESPACIOS(A1))</div>', 
                'gemini', false, ["Sin Contexto", "Vago"], false, 'beginner'),
            
            // --- TOOLS ---
            createCase(901, 'tools', 'Gu√≠a: ChatGPT', 'bolt', '¬øCu√°ndo usar ChatGPT?', 'Ideal para texto e ideas.', '', '{r}Tool{/r}', '...', 'chatgpt', false, [], true, 'beginner')
        ];

        // --- L√ìGICA UI ---
        let currentCategory = 'advanced'; 
        let searchQuery = '';

        function init() {
            renderCategories();
            renderCaseList();
            selectCase(801); // Seleccionar el primero por defecto
            
            const hasSeenWelcome = localStorage.getItem('agia_v2_welcome_seen');
            if (!hasSeenWelcome) {
                setTimeout(() => {
                    document.getElementById('welcome-modal').classList.remove('hidden');
                }, 500);
            }
        }

        function closeWelcome() {
            document.getElementById('welcome-modal').classList.add('hidden');
            localStorage.setItem('agia_v2_welcome_seen', 'true');
        }

        function renderCategories() {
            const nav = document.getElementById('category-nav');
            if(!nav) return;
            nav.innerHTML = Object.keys(categoryConfig).map(key => {
                const conf = categoryConfig[key];
                const isActive = currentCategory === key;
                const activeClass = isActive ? `bg-white text-indigo-700 shadow-md font-bold` : `bg-white/10 text-white hover:bg-white/20`;
                
                return `<button onclick="setCategory('${key}')" class="flex items-center gap-2 px-4 py-2 rounded-full text-xs transition-all whitespace-nowrap backdrop-blur-sm ${activeClass} border border-white/10">
                    <span class="material-symbols-outlined text-lg">${conf.icon}</span>
                    ${conf.label}
                </button>`;
            }).join('');
        }

        function renderCaseList() {
            const listEl = document.getElementById('case-list');
            if(!listEl) return;
            
            const filtered = allCases.filter(c => (c.category === currentCategory || searchQuery !== '') && (c.title.toLowerCase().includes(searchQuery.toLowerCase()) || c.problem.toLowerCase().includes(searchQuery.toLowerCase())));
            const countDisplay = document.getElementById('count-display');
            if(countDisplay) countDisplay.innerText = allCases.length; 
            
            if (filtered.length === 0) {
                listEl.innerHTML = `<div class="p-8 text-center text-slate-400 text-xs">No hay resultados</div>`;
                return;
            }

            listEl.innerHTML = filtered.map(c => {
                const config = categoryConfig[c.category];
                let iconDisplay = c.locked ? 'lock' : c.icon;
                let iconColorClass = c.category === 'tools' 
                    ? (c.locked ? 'text-slate-300 bg-slate-50' : 'text-slate-600 bg-slate-100')
                    : (c.locked ? 'text-slate-300 bg-slate-50' : `text-${config.color}-600 bg-${config.color}-50`);

                const diffConfig = {
                    beginner: { label: 'B√ÅSICO', color: 'bg-green-100 text-green-700 border-green-200' },
                    intermediate: { label: 'INTERMEDIO', color: 'bg-blue-100 text-blue-700 border-blue-200' },
                    advanced: { label: 'AVANZADO', color: 'bg-purple-100 text-purple-700 border-purple-200' }
                };
                const diff = diffConfig[c.difficulty] || diffConfig['beginner'];
                const diffBadge = c.category === 'advanced' ? `<span class="text-[8px] ${diff.color} px-1.5 py-0.5 rounded-full border tracking-wide font-bold ml-1">${diff.label}</span>` : '';
                
                return `<button onclick="selectCase(${c.id}); if(window.innerWidth < 768) toggleSidebar();" class="w-full text-left p-3 rounded-xl group transition-all hover:bg-slate-50 border border-transparent hover:border-slate-200 relative overflow-hidden ${c.locked ? 'opacity-70 grayscale' : ''}">
                    <div class="flex items-center gap-3 pl-1">
                        <div class="w-10 h-10 rounded-lg flex items-center justify-center flex-none shadow-sm ${iconColorClass}">
                            <span class="material-symbols-outlined text-xl">${iconDisplay}</span>
                        </div>
                        <div class="overflow-hidden flex-1">
                            <h4 class="text-sm font-bold text-slate-700 truncate group-hover:text-indigo-700 transition-colors flex items-center gap-1">
                                ${c.title} 
                                ${!c.locked && !c.isTool ? '<span class="text-[9px] bg-green-100 text-green-700 px-1.5 rounded-full border border-green-200 tracking-wide">GRATIS</span>' : ''}
                                ${diffBadge}
                            </h4>
                            <p class="text-[11px] text-slate-400 truncate leading-tight mt-0.5">${c.locked ? 'Solo miembros Premium' : c.problem}</p>
                        </div>
                    </div>
                </button>`;
            }).join('');
        }

        // --- CORE LOGIC: SELECT CASE ---
        function selectCase(id) {
            activeCaseId = id;
            const c = allCases.find(x => x.id === id);
            if(!c) return;

            // 1. UI RESET
            document.getElementById('magic-toggle').checked = false; // Reset switch
            const dot = document.querySelector('.dot');
            if(dot) dot.style.transform = 'translateX(0)';

            // 2. SETUP BASICO
            const conf = categoryConfig[c.category];
            const ai = aiConfig[c.suggestedAI] || aiConfig['chatgpt']; 
            const isTool = c.category === 'tools';

            const setInnerText = (id, text) => { const el = document.getElementById(id); if(el) el.innerText = text; };
            setInnerText('detail-title', c.title);
            setInnerText('detail-icon', c.icon);
            setInnerText('detail-problem', c.problem);
            
            const iconBg = document.getElementById('detail-icon-bg');
            if(iconBg) {
                const iconBgClass = isTool ? `bg-slate-100 text-slate-600 border-slate-200` : `bg-${conf.color}-50 text-${conf.color}-600 border-white shadow-sm`;
                iconBg.className = `w-12 h-12 md:w-16 md:h-16 rounded-2xl flex items-center justify-center border-2 ${iconBgClass}`;
            }
            
            const badge = document.getElementById('detail-category-badge');
            if(badge) {
                badge.innerText = conf.label;
                badge.className = `text-[10px] font-bold uppercase tracking-wider px-2 py-0.5 rounded-full border ${isTool ? 'bg-slate-100 text-slate-600 border-slate-200' : `bg-${conf.color}-100 text-${conf.color}-800 border-${conf.color}-200`}`;
            }

            // AI Badge Tooltip
            const badgeHTML = `
                <div class="tooltip-trigger relative group">
                    <div class="${ai.bg} text-white px-3 py-1 rounded-full flex items-center gap-2 shadow-lg ring-1 ring-white/20 cursor-help transition-transform hover:scale-105">
                        <span class="material-symbols-outlined text-sm">${ai.icon}</span>
                        <span class="text-[10px] font-bold tracking-wide uppercase">${isTool ? 'Plataforma' : 'Sugerida: ' + ai.name}</span>
                    </div>
                    <div class="tooltip-content hidden absolute bottom-full left-1/2 transform -translate-x-1/2 mb-2 w-48 bg-slate-800 text-white text-[10px] p-2 rounded shadow-xl text-center border border-slate-600 z-50">
                        ${isTool ? 'Informaci√≥n de la herramienta.' : 'Es solo una sugerencia, no un requisito.'}
                        <div class="absolute top-full left-1/2 transform -translate-x-1/2 border-4 border-transparent border-t-slate-800"></div>
                    </div>
                </div>
            `;
            document.getElementById('ai-badge-container').innerHTML = badgeHTML;
            document.getElementById('ai-badge-mobile').innerHTML = badgeHTML;

            // 3. LOGICA PROMPT BOX & TEASER
            const promptArea = document.getElementById('detail-prompt-rendered');
            const contentArea = document.getElementById('box-content-area');
            const boxHeader = document.getElementById('box-header');
            
            // Limpiar overlays
            const existingOverlay = document.querySelector('.premium-overlay');
            if(existingOverlay) existingOverlay.remove();

            if (c.locked) {
                // MODO TEASER (Blur)
                promptArea.innerHTML = renderAGIA(c.agiaPromptTagged);
                promptArea.className = "font-code text-sm md:text-base leading-loose text-slate-300 blur-content";
                
                const overlay = document.createElement('div');
                overlay.className = 'premium-overlay';
                overlay.innerHTML = `
                    <span class="material-symbols-outlined text-4xl text-yellow-400 mb-2 drop-shadow-lg">lock</span>
                    <p class="text-white font-bold text-lg mb-4 drop-shadow-md text-center px-4">F√≥rmula Maestra Protegida</p>
                    <button onclick="openPaywall()" class="bg-yellow-400 hover:bg-yellow-300 text-indigo-900 px-6 py-2 rounded-full font-bold shadow-lg transform transition hover:scale-105 flex items-center gap-2">
                        <span class="material-symbols-outlined text-sm">key</span> Desbloquear ($)
                    </button>
                `;
                contentArea.appendChild(overlay);
                document.getElementById('magic-toggle').disabled = true;
                
                // Ocultar comparativas
                document.getElementById('comparison-container').classList.add('opacity-50', 'pointer-events-none');

            } else {
                // MODO ABIERTO
                document.getElementById('magic-toggle').disabled = false;
                document.getElementById('comparison-container').classList.remove('opacity-50', 'pointer-events-none');
                
                // Estado inicial: Bad Prompt
                if (isTool) {
                    // Si es una herramienta, mostramos info directa
                     promptArea.innerHTML = c.agiaPromptTagged;
                     promptArea.className = "text-slate-300 leading-relaxed";
                } else {
                    promptArea.innerHTML = c.badPrompt;
                    promptArea.className = "font-sans text-sm md:text-base leading-relaxed text-slate-400 italic";
                }
            }

            // Fill Bad Prompt / Result logic
            const badPromptEl = document.getElementById('detail-bad-prompt');
            const badResultEl = document.getElementById('detail-bad-result');
            const badgesContainer = document.getElementById('deficiency-badges');
            
            if(badPromptEl) badPromptEl.innerText = `"${c.badPrompt}"`;
            if(badResultEl) badResultEl.innerText = c.badResponsePreview;
            if(badgesContainer) {
                badgesContainer.innerHTML = c.deficiencies.map(d => `<span class="px-2 py-1 bg-red-50 text-red-600 text-[10px] font-bold rounded-md border border-red-100 flex items-center gap-1"><span class="material-symbols-outlined text-[10px]">warning</span>${d}</span>`).join('');
            }
            
            // Preview Response
            const previewRes = document.getElementById('preview-response');
            if(previewRes) previewRes.innerHTML = c.previewResponse;

            if(window.innerWidth < 768) toggleSidebar();
        }

        // --- MAGIC SWITCH LOGIC ---
        function toggleMagicMode() {
            const checkbox = document.getElementById('magic-toggle');
            const c = allCases.find(x => x.id === activeCaseId);
            const promptArea = document.getElementById('detail-prompt-rendered');
            const dot = document.querySelector('.dot');
            
            if(c.isTool || c.locked) return; // No magic for tools or locked

            if(checkbox.checked) {
                // ACTIVAR AGIA (Good)
                dot.style.transform = 'translateX(100%)';
                promptArea.style.opacity = '0';
                setTimeout(() => {
                    promptArea.innerHTML = renderAGIA(c.agiaPromptTagged);
                    promptArea.className = "font-code text-sm md:text-base leading-loose text-slate-300 select-all whitespace-pre-wrap transition-opacity duration-300";
                    promptArea.style.opacity = '1';
                }, 200);
            } else {
                // ACTIVAR NORMAL (Bad)
                dot.style.transform = 'translateX(0)';
                promptArea.style.opacity = '0';
                setTimeout(() => {
                    promptArea.innerHTML = c.badPrompt;
                    promptArea.className = "font-sans text-sm md:text-base leading-relaxed text-slate-400 italic transition-opacity duration-300";
                    promptArea.style.opacity = '1';
                }, 200);
            }
        }

        // --- INTERACCION LEYENDA (HOVER) ---
        function highlightText(type) {
            // Leyenda -> Texto
            document.querySelectorAll(`.legend-item`).forEach(el => el.classList.remove('active'));
            document.querySelector(`.legend-item[data-type="${type}"]`).classList.add('active');
            
            const spans = document.querySelectorAll(`span[data-type="${type}"]`);
            spans.forEach(span => span.classList.add('hl-active'));
        }

        function highlightLegend(type) {
            // Texto -> Leyenda (esto se invoca desde el HTML generado en renderAGIA)
            // Ya est√° manejado por el mismo highlightText si usamos onmouseover en el span
        }

        function clearHighlight() {
            document.querySelectorAll('.legend-item').forEach(el => el.classList.remove('active'));
            document.querySelectorAll('.hl-active').forEach(el => el.classList.remove('hl-active'));
        }

        // --- GENERAL UI ---
        function setCategory(cat) {
            currentCategory = cat;
            searchQuery = '';
            const searchInput = document.getElementById('searchInput');
            if(searchInput) searchInput.value = '';
            renderCategories();
            renderCaseList();
        }

        function filterCases() {
            const searchInput = document.getElementById('searchInput');
            if(searchInput) {
                searchQuery = searchInput.value;
                renderCaseList();
            }
        }

        function copyPrompt() {
            const c = allCases.find(x => x.id === activeCaseId);
            if(!c || c.locked) return; // No copiar si est√° bloqueado

            // Si el switch est√° apagado (Bad prompt), copiamos el AGIA igual? 
            // Mejor copiamos lo que se ve, o forzamos AGIA. Por valor, copiemos AGIA limpio.
            const rawText = cleanAGIA(c.agiaPromptTagged);
            navigator.clipboard.writeText(rawText);
            
            showToast();
            
            // Actualizar contador social fake
            const counter = document.getElementById('social-proof-counter');
            if(counter) {
                let num = parseInt(counter.innerText.match(/\d+/)[0]);
                counter.innerText = `üî• Usado ${num + 1} veces hoy`;
                counter.classList.add('text-green-500', 'font-bold');
            }
        }

        function showToast() {
            const toast = document.getElementById('toast-container');
            toast.classList.add('show');
            setTimeout(() => { hideToast(); }, 5000);
        }

        function hideToast() {
            document.getElementById('toast-container').classList.remove('show');
        }

        function openPaywall() { document.getElementById('paywall-modal').classList.remove('hidden'); }
        function closePaywall() { document.getElementById('paywall-modal').classList.add('hidden'); }
        function toggleSidebar() { document.getElementById('sidebar').classList.toggle('-translate-x-full'); }

        init();
    </script>
</body>
</html>
