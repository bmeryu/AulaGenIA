<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>B√≥veda de Prompts AGIA | Oferta Black Friday</title>
    
    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    
    <!-- Google Fonts & Icons -->
    <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined:opsz,wght,FILL,GRAD@24,400,1,0">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800&display=swap" rel="stylesheet">

    <style>
        body { font-family: 'Inter', sans-serif; background-color: #f8fafc; color: #1e293b; }
        
        /* Custom Scrollbar */
        .custom-scroll::-webkit-scrollbar { width: 6px; }
        .custom-scroll::-webkit-scrollbar-track { background: transparent; }
        .custom-scroll::-webkit-scrollbar-thumb { background: #cbd5e1; border-radius: 10px; }
        .custom-scroll::-webkit-scrollbar-thumb:hover { background: #94a3b8; }

        /* Animations */
        @keyframes fadeIn { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }
        .fade-in { animation: fadeIn 0.4s ease-out forwards; }
        
        /* Highlight Classes for Prompts - Updated for continuous text flow */
        .hl-rol { background-color: #eff6ff; color: #1d4ed8; border-bottom: 2px solid #3b82f6; padding: 2px 6px; border-radius: 4px; cursor: help; font-weight: 500; display: inline; box-decoration-break: clone; -webkit-box-decoration-break: clone; }
        .hl-contexto { background-color: #ecfdf5; color: #047857; border-bottom: 2px solid #10b981; padding: 2px 6px; border-radius: 4px; cursor: help; font-weight: 500; display: inline; box-decoration-break: clone; -webkit-box-decoration-break: clone; }
        .hl-meta { background-color: #fffbeb; color: #b45309; border-bottom: 2px solid #f59e0b; padding: 2px 6px; border-radius: 4px; cursor: help; font-weight: 500; display: inline; box-decoration-break: clone; -webkit-box-decoration-break: clone; }
        .hl-limites { background-color: #fef2f2; color: #b91c1c; border-bottom: 2px solid #ef4444; padding: 2px 6px; border-radius: 4px; cursor: help; font-weight: 500; display: inline; box-decoration-break: clone; -webkit-box-decoration-break: clone; }
        .hl-formato { background-color: #f3e8ff; color: #7e22ce; border-bottom: 2px solid #a855f7; padding: 2px 6px; border-radius: 4px; cursor: help; font-weight: 500; display: inline; box-decoration-break: clone; -webkit-box-decoration-break: clone; }

        .prose-sm p { margin-bottom: 0.5em; }
        .prose-sm ul, .prose-sm ol { margin-left: 1.2em; margin-bottom: 0.5em; }
        .prose-sm li { margin-bottom: 0.2em; }
    </style>
</head>
<body class="h-screen flex flex-col overflow-hidden text-slate-800">

    <!-- BLACK FRIDAY BANNER -->
    <div class="bg-black text-white text-center py-2 px-4 text-xs md:text-sm font-bold tracking-wide z-50 flex justify-center items-center gap-2">
        <span class="material-symbols-outlined text-sm text-yellow-400">local_fire_department</span>
        <span>BLACK FRIDAY: Desbloquea la B√≥veda Completa por solo $9.990</span>
        <a href="#" onclick="openPaywall()" class="underline text-yellow-400 hover:text-yellow-300 ml-2">Ver Oferta</a>
    </div>

    <!-- Header -->
    <header class="bg-white border-b border-slate-200 shadow-sm z-20 flex-none relative">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-4">
            <div class="flex items-center justify-between mb-4">
                <div class="flex items-center gap-4">
                    <div class="h-10 w-10 bg-indigo-600 rounded-lg flex items-center justify-center text-white font-black text-xl shadow-indigo-200 shadow-lg">AG</div>
                    <div class="border-l border-slate-200 pl-4">
                        <h1 class="text-lg font-extrabold text-slate-900 tracking-tight">B√≥veda de Prompts <span class="text-indigo-600">AGIA</span></h1>
                        <p class="text-xs text-slate-500 font-medium">Librer√≠a de Copiar & Pegar</p>
                    </div>
                </div>
                <button onclick="openPaywall()" class="hidden md:flex bg-slate-900 text-white px-4 py-2 rounded-lg text-xs font-bold hover:bg-slate-800 transition-all items-center gap-2">
                    <span class="material-symbols-outlined text-sm text-yellow-400">lock_open</span>
                    DESBLOQUEAR TODO
                </button>
            </div>

            <!-- Category Navigation -->
            <div class="overflow-x-auto custom-scroll pb-2">
                <div class="flex space-x-2 min-w-max" id="category-nav">
                    <!-- JS injects categories here -->
                </div>
            </div>
        </div>
    </header>

    <!-- Main Layout -->
    <div class="flex flex-1 overflow-hidden max-w-7xl mx-auto w-full relative">
        
        <!-- Sidebar -->
        <aside class="w-full md:w-80 flex flex-col bg-white border-r border-slate-200 flex-none z-10 transition-all duration-300 absolute md:relative h-full transform -translate-x-full md:translate-x-0 shadow-xl md:shadow-none" id="sidebar">
            <div class="p-3 border-b border-slate-100">
                <div class="relative">
                    <span class="material-symbols-outlined absolute left-3 top-2.5 text-slate-400 text-lg">search</span>
                    <input type="text" id="searchInput" placeholder="Buscar prompt..." 
                        class="w-full pl-10 pr-4 py-2 bg-slate-50 border border-slate-200 rounded-lg text-sm focus:ring-2 focus:ring-indigo-500 transition-all"
                        onkeyup="filterCases()">
                </div>
            </div>
            <div class="flex-1 overflow-y-auto custom-scroll p-2 space-y-1" id="case-list">
                <!-- Cases injected by JS -->
            </div>
            <div class="p-3 border-t border-slate-100 text-xs text-center text-slate-400 bg-slate-50">
                B√≥veda cargada con <span id="count-display" class="font-bold">0</span> prompts
            </div>
        </aside>

        <!-- Mobile Toggle -->
        <button onclick="toggleSidebar()" class="md:hidden absolute bottom-6 left-6 z-40 bg-indigo-600 text-white p-4 rounded-full shadow-lg hover:bg-indigo-700 transition-colors">
            <span class="material-symbols-outlined">menu_open</span>
        </button>

        <!-- Main Content -->
        <main class="flex-1 flex flex-col bg-slate-50/50 overflow-hidden relative w-full">
            <div id="case-detail" class="flex-1 overflow-y-auto custom-scroll p-4 md:p-8 pb-24">
                <div class="max-w-6xl mx-auto fade-in">
                    
                    <!-- Title Header -->
                    <div class="flex items-center gap-4 mb-6 border-b border-slate-200 pb-6">
                        <div id="detail-icon-bg" class="w-16 h-16 rounded-2xl flex items-center justify-center shadow-md border border-white bg-white">
                            <span id="detail-icon" class="material-symbols-outlined text-3xl"></span>
                        </div>
                        <div class="flex-1">
                            <div class="flex items-center gap-2 mb-1">
                                <span id="detail-category-badge" class="text-[10px] font-bold uppercase tracking-wider px-2 py-0.5 rounded-full bg-slate-200 text-slate-600">Categor√≠a</span>
                                <span class="text-[10px] font-medium text-slate-400 flex items-center gap-1 bg-white px-2 py-0.5 rounded border border-slate-100">
                                    <span class="material-symbols-outlined text-[10px] text-green-500">verified</span> Validado por AGIA
                                </span>
                            </div>
                            <h2 id="detail-title" class="text-2xl md:text-3xl font-bold text-slate-800 leading-tight">T√≠tulo del Caso</h2>
                            <p id="detail-problem" class="text-sm text-slate-500 mt-1 font-medium"></p>
                        </div>
                    </div>

                    <!-- AGIA LEGEND -->
                    <div class="mb-6 bg-white rounded-xl border border-slate-200 p-4 shadow-sm overflow-x-auto">
                        <div class="flex items-center justify-between min-w-max gap-4">
                            <h3 class="text-xs font-bold text-slate-400 uppercase mr-4">La F√≥rmula AGIA:</h3>
                            <div class="flex gap-4 text-xs">
                                <div class="flex items-center gap-1.5 px-2 py-1 bg-blue-50 rounded border border-blue-100"><div class="w-2 h-2 rounded-full bg-blue-500"></div><span class="font-bold text-blue-700">Rol</span></div>
                                <div class="flex items-center gap-1.5 px-2 py-1 bg-emerald-50 rounded border border-emerald-100"><div class="w-2 h-2 rounded-full bg-emerald-500"></div><span class="font-bold text-emerald-700">Contexto</span></div>
                                <div class="flex items-center gap-1.5 px-2 py-1 bg-amber-50 rounded border border-amber-100"><div class="w-2 h-2 rounded-full bg-amber-500"></div><span class="font-bold text-amber-700">Meta</span></div>
                                <div class="flex items-center gap-1.5 px-2 py-1 bg-red-50 rounded border border-red-100"><div class="w-2 h-2 rounded-full bg-red-500"></div><span class="font-bold text-red-700">L√≠mites</span></div>
                                <div class="flex items-center gap-1.5 px-2 py-1 bg-purple-50 rounded border border-purple-100"><div class="w-2 h-2 rounded-full bg-purple-500"></div><span class="font-bold text-purple-700">Formato</span></div>
                            </div>
                        </div>
                    </div>

                    <!-- COMPARISON GRID: PROMPTS (ROW 1) -->
                    <div class="grid md:grid-cols-12 gap-6 mb-10">
                        
                        <!-- BAD PROMPT (Left - Smaller) -->
                        <div class="md:col-span-4 flex flex-col">
                            <div class="flex items-center justify-between mb-2">
                                <h3 class="text-xs font-bold text-slate-400 uppercase tracking-wider flex items-center gap-1">
                                    <span class="material-symbols-outlined text-sm">close</span> Lo que escribe la mayor√≠a
                                </h3>
                            </div>
                            <div class="bg-white border border-slate-200 rounded-xl p-5 shadow-sm h-full flex flex-col relative group">
                                <div class="absolute top-0 left-0 w-1 h-full bg-slate-200 rounded-l-xl group-hover:bg-red-200 transition-colors"></div>
                                <p id="detail-bad-prompt" class="font-mono text-sm text-slate-500 italic pl-2 my-auto leading-relaxed">"..."</p>
                                <div class="mt-4 pt-3 border-t border-slate-100">
                                    <div id="deficiency-badges" class="flex flex-wrap gap-2"></div>
                                </div>
                            </div>
                        </div>

                        <!-- GOOD PROMPT (Right - Hero) -->
                        <div class="md:col-span-8 flex flex-col">
                            <div class="flex items-center justify-between mb-2">
                                <h3 class="text-xs font-bold text-indigo-600 uppercase tracking-wider flex items-center gap-1">
                                    <span class="material-symbols-outlined text-sm">auto_awesome</span> Prompt Maestro (AGIA)
                                </h3>
                                <button onclick="copyPrompt()" class="group flex items-center gap-2 text-[10px] bg-indigo-50 text-indigo-600 hover:bg-indigo-100 px-3 py-1 rounded-full font-bold transition-all border border-indigo-100">
                                    <span class="material-symbols-outlined text-sm group-hover:animate-bounce">content_copy</span> 
                                    <span>COPIAR</span>
                                </button>
                            </div>
                            <div class="bg-slate-900 rounded-xl p-6 shadow-xl h-full border border-slate-700 relative overflow-hidden flex flex-col justify-center group">
                                <div class="absolute top-0 right-0 w-40 h-40 bg-indigo-600 opacity-10 rounded-full -mr-10 -mt-10 blur-3xl group-hover:opacity-20 transition-opacity"></div>
                                <p id="detail-prompt-rendered" class="relative z-10 font-mono text-sm md:text-base text-slate-200 leading-relaxed whitespace-pre-wrap selection:bg-indigo-500 selection:text-white">...</p>
                            </div>
                        </div>
                    </div>

                    <!-- DIVIDER / ARROW -->
                    <div class="flex justify-center mb-10 -mt-4 relative z-10">
                        <div class="bg-slate-100 rounded-full p-2 border-4 border-white shadow-sm text-slate-400">
                            <span class="material-symbols-outlined text-2xl animate-bounce">arrow_downward</span>
                        </div>
                    </div>

                    <!-- COMPARISON GRID: RESULTS (ROW 2) -->
                    <div class="grid md:grid-cols-12 gap-6 mb-12">
                        
                        <!-- BAD RESULT -->
                        <div class="md:col-span-4">
                            <h4 class="text-xs font-bold text-slate-400 uppercase mb-2">Resultado Pobre</h4>
                            <div class="bg-slate-50 rounded-xl p-5 border border-slate-200 h-full opacity-70 hover:opacity-100 transition-opacity">
                                <div class="flex items-start gap-2 text-sm text-slate-500 italic">
                                    <span class="material-symbols-outlined text-lg text-red-300 flex-none">cancel</span>
                                    <div id="detail-bad-result">...</div>
                                </div>
                            </div>
                        </div>

                        <!-- GOOD RESULT -->
                        <div class="md:col-span-8">
                            <h4 class="text-xs font-bold text-indigo-600 uppercase mb-2 flex items-center gap-2">
                                <span class="material-symbols-outlined text-sm">check_circle</span> Resultado Experto
                            </h4>
                            <div class="bg-white rounded-xl p-6 border border-indigo-100 shadow-md h-full relative overflow-hidden">
                                <div class="absolute top-0 left-0 w-full h-1 bg-gradient-to-r from-indigo-400 to-purple-500"></div>
                                <div id="preview-response" class="text-sm text-slate-700 prose-sm max-w-none">
                                    <!-- JS injects rich content here -->
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Footer Image -->
                    <div class="mt-8 pt-8 border-t border-slate-200 opacity-60 hover:opacity-100 transition-opacity">
                        <div class="flex items-center justify-center gap-2 mb-4">
                            <span class="material-symbols-outlined text-slate-400">schema</span>
                            <p class="text-xs font-bold text-slate-400 uppercase tracking-widest">Referencia Visual: Estructura AGIA</p>
                        </div>
                        <img src="https://aulagenia.cl/maestro-prompts.png" alt="Estructura AGIA" class="w-full max-w-2xl mx-auto rounded-lg border border-slate-200 shadow-sm grayscale hover:grayscale-0 transition-all duration-500">
                    </div>

                </div>
            </div>
        </main>
    </div>

    <!-- PAYWALL MODAL -->
    <div id="paywall-modal" class="fixed inset-0 z-[60] hidden">
        <div class="absolute inset-0 bg-slate-900/80 backdrop-blur-sm" onclick="closePaywall()"></div>
        <div class="absolute top-1/2 left-1/2 transform -translate-x-1/2 -translate-y-1/2 w-full max-w-md p-4">
            <div class="bg-white rounded-2xl shadow-2xl overflow-hidden animate-in fade-in zoom-in duration-300">
                <button onclick="closePaywall()" class="absolute top-3 right-3 text-white/50 hover:text-white bg-black/20 rounded-full p-1 z-10"><span class="material-symbols-outlined">close</span></button>
                <div class="bg-slate-900 p-8 text-center relative overflow-hidden">
                    <div class="absolute top-0 right-0 w-40 h-40 bg-indigo-600 rounded-full blur-3xl opacity-30 -mr-10 -mt-10"></div>
                    <span class="material-symbols-outlined text-5xl text-yellow-400 mb-2 relative z-10">lock</span>
                    <h3 class="text-white font-bold text-xl relative z-10">Contenido Premium</h3>
                </div>
                <div class="p-6 text-center">
                    <p class="text-slate-600 text-sm mb-6">Accede a los <span class="font-bold text-slate-900">100+ casos avanzados</span>.</p>
                    <div class="bg-yellow-50 border border-yellow-200 rounded-lg p-3 mb-6">
                        <p class="text-xs font-bold text-yellow-800 uppercase">üî• Oferta Black Friday</p>
                        <p class="text-2xl font-black text-slate-900">$9.990 <span class="text-sm font-normal text-slate-500 line-through">$19.990</span></p>
                    </div>
                    <a id="payment-btn" href="#" target="_blank" class="block w-full bg-indigo-600 text-white py-3 rounded-xl font-bold hover:bg-indigo-700 transition-all shadow-lg flex items-center justify-center gap-2">
                        <span>DESBLOQUEAR AHORA</span> <span class="material-symbols-outlined text-sm">arrow_forward</span>
                    </a>
                </div>
            </div>
        </div>
    </div>

    <script>
        // ==========================================
        // CONFIGURACI√ìN DE VENTA
        // ==========================================
        const LINK_MERCADO_PAGO = "#"; // <--- PEGA TU LINK AQU√ç
        document.getElementById('payment-btn').href = LINK_MERCADO_PAGO;

        // --- AGIA RENDERER ---
        function renderAGIA(text) {
            return text
                .replace(/{r}(.*?){\/r}/g, '<span class="hl-rol">$1</span>')
                .replace(/{c}(.*?){\/c}/g, '<span class="hl-contexto">$1</span>')
                .replace(/{m}(.*?){\/m}/g, '<span class="hl-meta">$1</span>')
                .replace(/{l}(.*?){\/l}/g, '<span class="hl-limites">$1</span>')
                .replace(/{f}(.*?){\/f}/g, '<span class="hl-formato">$1</span>')
                .replace(/\n/g, '<br>');
        }
        function cleanAGIA(text) { return text.replace(/{[rcmlf]}/g, '').replace(/{\/[rcmlf]}/g, ''); }

        // --- DATA CONFIG ---
        const categoryConfig = {
            office: { label: "Oficina", color: "emerald", icon: "business_center" },
            finance: { label: "Finanzas", color: "cyan", icon: "attach_money" },
            marketing: { label: "Marketing", color: "pink", icon: "campaign" },
            personal: { label: "Vida Personal", color: "blue", icon: "home" },
            tech: { label: "Tecnolog√≠a", color: "violet", icon: "code" },
            education: { label: "Educaci√≥n", color: "amber", icon: "school" }
        };

        // --- CASE GENERATOR ---
        const createCase = (id, cat, title, icon, problem, badPrompt, badResPreview, goodPromptTagged, goodResPreview, locked = false, deficiencies = []) => ({
            id, category: cat, title, icon, problem, 
            badPrompt, 
            badResPreview,
            agiaPromptTagged: goodPromptTagged, 
            previewResponse: goodResPreview,
            locked: locked,
            deficiencies: deficiencies.length ? deficiencies : ["Sin Rol", "Contexto Vago"]
        });

        // --- DATABASE (CORE CASES - HUMANIZED) ---
        const allCases = [
            // --- OFICINA ---
            createCase(101, 'office', 'El Mago de Excel: Sumar.Si', 'table_view', 'F√≥rmula desconocida.', 
                'Ayuda con excel para sumar si cumple condici√≥n.', 
                'Prueba con la funci√≥n SUMAR.SI. Selecciona el rango y el criterio. Es simple.', 
                '{r}Act√∫a como un Instructor Experto en Excel MVP.{/r} Mira, {c}tengo una tabla de Ventas con las columnas [Vendedor, Mes, Monto].{/c} El problema es que {m}necesito una f√≥rmula para sumar el total vendido por [Nombre] en el mes [Mes].{/m} Por favor, {f}dame la f√≥rmula SUMAR.SI.CONJUNTO y expl√≠came brevemente los argumentos.{/f}',
                '<div class="font-mono text-xs bg-slate-800 text-green-400 p-3 rounded mb-2">=SUMAR.SI.CONJUNTO(C:C; A:A; "[Nombre]"; B:B; "[Mes]")</div><ul class="list-disc ml-4 space-y-1 text-slate-600 text-xs"><li><strong>C:C</strong>: Rango Suma (Montos)</li><li><strong>A:A</strong>: Criterio 1 (Vendedor)</li></ul>',
                false, ["Sin Contexto", "Petici√≥n Gen√©rica"]),

            createCase(107, 'office', 'Profe de Excel (BuscarV)', 'school', 'Quiero entender, no solo la f√≥rmula.', 
                'C√≥mo cruzo dos tablas en Excel (BuscarV).', 
                'Usa BUSCARV(valor, matriz, columna, 0).', 
                '{r}Act√∫a como mi Profesor de Excel con don para ense√±ar.{/r} Tengo dos tablas diferentes y necesito traer datos de una a la otra usando un ID com√∫n. {c}No quiero solo que me des el pez, quiero que me ense√±es a pescar.{/c} {m}Expl√≠came conceptualmente c√≥mo funcionan BUSCARV o su sucesor XLOOKUP.{/m} {f}Usa una analog√≠a simple para que no se me olvide.{/f}',
                '<p class="text-sm font-medium text-slate-700 mb-2">Imagina que BUSCARV es como buscar un n√∫mero en una gu√≠a telef√≥nica:</p><ul class="list-disc ml-4 text-xs text-slate-600 space-y-1"><li><strong>El Valor:</strong> El nombre de tu amigo.</li><li><strong>La Matriz:</strong> La gu√≠a completa.</li><li><strong>La Columna:</strong> El n√∫mero de tel√©fono.</li></ul><p class="text-xs mt-2 text-indigo-600 font-bold">üí° Consejo Pro: Usa XLOOKUP si tienes Office 365, es m√°s dif√≠cil que falle.</p>',
                false, ["Respuesta T√©cnica", "Sin Explicaci√≥n"]),

            createCase(108, 'office', 'Arreglar Error #N/A', 'bug_report', 'Error frustrante en Excel.', 
                'Me sale un error en mi planilla y no s√© qu√© es.', 
                'Revisa si los datos est√°n bien escritos. Puede ser un espacio.', 
                '{r}Eres un Experto Solucionador de Problemas en Excel.{/r} Mira, estoy pegado con esto: {c}En la celda [C3] me aparece este error exacto: "[Pegar Error Aqu√≠]"{/c}. {m}Analiza la posible causa ra√≠z y dame la soluci√≥n paso a paso para arreglarlo.{/m} {l}S√© directo y pragm√°tico, sin teor√≠a innecesaria.{/l}',
                '<div class="bg-red-50 border-l-4 border-red-400 p-2 mb-2"><p class="text-xs text-red-700 font-bold">Diagn√≥stico: Dato no encontrado</p></div><p class="text-xs text-slate-600">El error #N/A usualmente significa que Excel no encuentra el valor buscado. <br><strong>Soluci√≥n r√°pida:</strong> Envuelve tu f√≥rmula en un SI.ERROR. <br><code class="bg-slate-100 px-1 rounded">=SI.ERROR(TuF√≥rmula; "No encontrado")</code></p>',
                false, ["Consejo Vago", "No Diagnostica"]),

            createCase(102, 'office', 'Email Retraso Entrega', 'mail', 'Comunicar malas noticias.', 
                'Dile a mi jefe que no alcanzo a entregar hoy.', 
                'Hola jefe, no llego con el informe hoy. Lo veo ma√±ana. Saludos.', 
                '{r}Eres un Experto en Comunicaci√≥n Asertiva.{/r} Te cuento mi situaci√≥n: {c}No puedo entregar el [Informe X] hoy por falta de datos del √°rea [Y].{/c} Necesito que {m}redactes un correo informando el retraso sin sonar irresponsable.{/m} Ojo: {l}debes proponer una nueva fecha de entrega segura.{/l}',
                '<div class="bg-slate-50 p-3 rounded italic text-sm">"Estimado [Jefe],<br>Te escribo para actualizarte sobre el estado del [Informe X]. Debido a una demora en la recepci√≥n de la data de [√Årea Y], no podr√© realizar el cierre hoy como estaba previsto.<br>Ya he gestionado los datos y podr√© enviarte el informe validado este <strong>[Nueva Fecha]</strong>."</div>',
                false, ["Tono Informal", "Solo Problemas, No Soluciones"]),

            createCase(104, 'office', 'Temario Reuni√≥n', 'calendar_today', 'Reuniones desordenadas.', 
                'Haz una agenda para una reuni√≥n de equipo.', 
                '1. Hablar del proyecto. 2. Ver pendientes. 3. Varios.', 
                '{r}Eres un Project Manager Certificado.{/r} Tengo una {c}reuni√≥n de seguimiento del proyecto [Nombre Proyecto] con el equipo de [√Årea].{/c} Ay√∫dame a {m}crear un temario estructurado para 45 minutos.{/m} {f}Entr√©game una tabla con: Tema, Tiempo y Responsable.{/f}',
                '<table class="w-full text-xs border border-slate-200"><thead><tr class="bg-slate-100"><th>Tema</th><th>Tiempo</th><th>Lead</th></tr></thead><tbody><tr><td>Revisi√≥n KPIs</td><td>10 min</td><td>[Nombre]</td></tr><tr><td>Bloqueos Cr√≠ticos</td><td>20 min</td><td>[Nombre]</td></tr><tr><td>Pr√≥ximos Pasos</td><td>15 min</td><td>Todos</td></tr></tbody></table>',
                false, ["Sin Tiempos", "Sin Responsables"]),

            createCase(106, 'office', 'Responder Queja Cliente', 'support_agent', 'Cliente enojado.', 
                'Responde a este cliente que reclama por demora.', 
                'Disculpe la demora, tuvimos problemas. Ya le llegar√°.', 
                '{r}Eres Gerente de Customer Success.{/r} Un cliente me escribi√≥ lo siguiente: {c}"[Pegar la queja completa del cliente aqu√≠]"{/c}. {m}Redacta una respuesta pidiendo disculpas y ofreciendo una compensaci√≥n.{/m} Importante: {l}Mant√©n un tono emp√°tico y muy profesional.{/l}',
                '<div class="bg-slate-50 p-3 text-sm">"Estimado [Nombre del Cliente], he le√≠do su mensaje y lamento profundamente su mala experiencia. Esto no cumple con nuestro est√°ndar. Su pedido llegar√° el [Fecha] y, como compensaci√≥n por la espera, hemos abonado un [X]% de descuento a su cuenta."</div>',
                false, ["Sin Soluci√≥n Concreta", "Excusa Gen√©rica"]),

            // --- FINANZAS ---
            createCase(201, 'finance', 'Negociaci√≥n Salarial', 'payments', 'Pedir aumento.', 
                'C√≥mo pido m√°s plata.', 
                'Dile que la inflaci√≥n est√° alta y no te alcanza.', 
                '{r}Eres mi Coach de Carrera.{/r} Te doy mis datos: {c}Llevo [X] a√±os, y super√© mis objetivos en un [Y]%.{/c} Necesito un {m}guion para pedir aumento basado en valor, no en necesidad.{/m} {f}Usa esta estructura: Apertura, Datos, Cierre.{/f}',
                '<ul class="text-sm list-disc ml-4"><li><strong>Apertura:</strong> "Me gustar√≠a revisar mis resultados del √∫ltimo a√±o..."</li><li><strong>Datos:</strong> "Logr√© aumentar [KPI] en un [Y]%, generando [Valor] para la empresa."</li><li><strong>Cierre:</strong> "Basado en esto, solicito un ajuste del [Z]%."</li></ul>',
                false, ["Enfoque en Necesidad Personal", "Sin Evidencia"]),

            createCase(202, 'finance', 'Regla 50/30/20', 'pie_chart', 'Desorden gastos.', 
                'Organiza mi sueldo de [Monto].', 
                'Gasta menos en tonter√≠as y ahorra lo que sobre.', 
                '{r}Act√∫a como Asesor Financiero Personal.{/r} {c}Gano un sueldo l√≠quido de [Monto].{/c} Quiero que {m}apliques la regla 50/30/20 a mis finanzas.{/m} {f}Dame una tabla con los montos exactos para Necesidades, Deseos y Ahorro.{/f}',
                '<table class="w-full text-xs text-left"><tr><th>Categor√≠a</th><th>%</th><th>Monto</th></tr><tr><td>Necesidades</td><td>50%</td><td>$[Calc]</td></tr><tr><td>Deseos</td><td>30%</td><td>$[Calc]</td></tr><tr><td>Ahorro</td><td>20%</td><td>$[Calc]</td></tr></table>',
                false, ["Consejo Vago", "Sin Estructura"]),

            // --- MARKETING ---
            createCase(301, 'marketing', 'Calendario Instagram', 'calendar_view_month', 'Sin ideas.', 
                'Ideas para Instagram de [Negocio].', 
                'Sube fotos de tus productos y pon precios.', 
                '{r}Eres Estratega de Contenidos.{/r} Tengo un {c}negocio de [Rubro] enfocado en [P√∫blico].{/c} {m}Dame 3 ideas de Reels educativos (No venta directa).{/m} {f}Pres√©ntalo en una tabla: T√≠tulo, Gancho (Hook) y CTA.{/f}',
                '<table class="w-full text-xs"><tr><th>T√≠tulo</th><th>Hook Visual</th></tr><tr><td>Mito vs Realidad</td><td>[Acci√≥n rompiendo algo]</td></tr><tr><td>Tutorial R√°pido</td><td>"Deja de hacer esto..."</td></tr></table>',
                false, ["Solo Venta", "Aburrido"]),

            createCase(302, 'marketing', 'Copy Anuncio Facebook', 'ads_click', 'Vender online.', 
                'Haz un anuncio para vender [Producto].', 
                'Compra [Producto], es el mejor del mercado. 50% descuento.', 
                '{r}Eres un Copywriter experto en conversi√≥n.{/r} Contexto: {c}Vendo [Producto] que soluciona [Dolor].{/c} {m}Redacta un anuncio usando la f√≥rmula PAS (Problema-Agitaci√≥n-Soluci√≥n).{/m}',
                '<p class="text-sm"><strong>Problema:</strong> ¬øCansado de [Problema]?<br><strong>Agitaci√≥n:</strong> Cada d√≠a que pasa pierdes [X]...<br><strong>Soluci√≥n:</strong> Con [Producto] recupera tu [Beneficio] en 24hs.</p>',
                false, ["Gen√©rico", "Sin Estructura Persuasiva"]),

            createCase(305, 'marketing', 'Guion TikTok Viral', 'video_camera_front', 'Video corto.', 
                'Guion para TikTok de [Servicio].', 
                'Hola, soy [Nombre] y vendo [Servicio]. Ll√°menme.', 
                '{r}Eres Guionista de Contenido Viral con especialidad en Neuro-Marketing.{/r} Yo {c}ofrezco [Servicio].{/c} {m}Escribe un guion de 15 segundos.{/m} {f}Usa esta estructura: Gancho (3s), Valor (10s), Llamado a la acci√≥n (2s).{/f}',
                '<p class="text-sm"><strong>0-3s:</strong> "No contrates a un [Servicio] sin saber esto..."<br><strong>3-13s:</strong> [Tip de alto valor]<br><strong>13-15s:</strong> "S√≠gueme para m√°s tips."</p>',
                false, ["Inicio Lento", "Sin Valor"]),

            // --- PERSONAL ---
            createCase(401, 'personal', 'Men√∫ Semanal', 'restaurant_menu', 'Qu√© comer.', 
                'Dime qu√© comer esta semana.', 
                'Lunes: Fideos. Martes: Arroz. Mi√©rcoles: Pizza.', 
                '{r}Act√∫a como Nutricionista Pr√°ctico.{/r} Somos una {c}familia de 4, con poco tiempo y presupuesto medio.{/c} {m}Arma un men√∫ de lunes a viernes.{/m} {l}Solo platos que se cocinen en menos de 30 min.{/l}',
                '<ul class="text-sm list-disc ml-4"><li><strong>Lun:</strong> Tallarines con salsa de [Verdura]. (15 min)</li><li><strong>Mar:</strong> Omelette de [Ingrediente]. (10 min)</li><li><strong>Mi√©:</strong> [Prote√≠na] a la plancha con ensalada.</li></ul>',
                false, ["Poco Saludable", "Sin Variedad"]),

            // --- TECH ---
            createCase(501, 'tech', 'Explicar C√≥digo', 'code', 'No entiendo este script.', 
                'Qu√© hace este c√≥digo: function x(a,b){return a+b}', 
                'Suma dos n√∫meros.', 
                '{r}Eres Senior Developer Mentor.{/r} Soy un {c}estudiante de programaci√≥n.{/c} {m}Expl√≠came esta funci√≥n l√≠nea por l√≠nea.{/m} {f}Usa comentarios en el c√≥digo.{/f}',
                '<code class="text-xs bg-slate-800 text-green-400 p-2 block rounded">// Define funci√≥n x con par√°metros a y b\nfunction x(a, b) {\n  // Retorna la suma\n  return a + b;\n}</code>',
                false, ["Muy Breve", "Sin Contexto"]),

            // --- EDUCATION ---
            createCase(601, 'education', 'Tutor Socr√°tico', 'psychology', 'Aprender pensando.', 
                'Expl√≠came la [Tema].', 
                '[Tema] es cuando pasa X y Y. (Definici√≥n de Wikipedia)', 
                '{r}Act√∫a como S√≥crates.{/r} Soy un {c}estudiante curioso sobre [Tema].{/c} {m}No me des la respuesta. Hazme una pregunta que me haga deducirla.{/m}',
                '<div class="bg-slate-50 p-3 text-sm italic">"Interesante pregunta. Pero antes dime, si ocurriera [Situaci√≥n opuesta], ¬øcrees que el resultado ser√≠a el mismo? ¬øPor qu√©?"</div>',
                false, ["Respuesta Directa", "No Genera Aprendizaje"]),
        ];

        // --- GENERADOR DE CASOS (PARA LLEGAR A 100) ---
        const variants = [
            {base: 101, t: 'F√≥rmula Si.Error', p: 'Quitar errores excel'},
            {base: 101, t: 'Tabla Din√°mica', p: 'Como hacer tabla dinamica'},
            {base: 102, t: 'Email Licencia M√©dica', p: 'Avisar licencia'},
            {base: 102, t: 'Email Renuncia', p: 'Carta renuncia'},
            {base: 102, t: 'Email Felicitaci√≥n', p: 'Felicitar equipo'},
            {base: 103, t: 'Resumen Acta Reuni√≥n', p: 'Resumir reuni√≥n'},
            {base: 104, t: 'Agenda Brainstorming', p: 'Reunion ideas'},
            {base: 201, t: 'Negociar Arriendo', p: 'Bajar arriendo'},
            {base: 201, t: 'Negociar Proveedor', p: 'Pedir descuento'},
            {base: 202, t: 'Presupuesto Viaje', p: 'Calcular viaje'},
            {base: 202, t: 'Presupuesto Boda', p: 'Gastos matrimonio'},
            {base: 301, t: 'Post LinkedIn Viral', p: 'Escribir en linkedin'},
            {base: 301, t: 'Hilo de Twitter', p: 'Escribir hilo'},
            {base: 302, t: 'Email Marketing Fr√≠o', p: 'Vender por correo'},
            {base: 302, t: 'Guion Webinar', p: 'Charla ventas'},
            {base: 401, t: 'Men√∫ Vegetariano', p: 'Comida sin carne'},
            {base: 401, t: 'Men√∫ Keto', p: 'Dieta keto'},
            {base: 501, t: 'Explicar Error Python', p: 'Error codigo'},
            {base: 501, t: 'Documentar API', p: 'Docs api'},
            {base: 601, t: 'Tutor Ingl√©s', p: 'Aprender ingles'},
            {base: 601, t: 'Tutor Historia', p: 'Aprender historia'},
        ];

        let idGen = 1000;
        variants.forEach(v => {
            const baseCase = allCases.find(c => c.id === v.base);
            if(baseCase) {
                allCases.push(createCase(
                    idGen++, baseCase.category, v.t, baseCase.icon, 'Variante: ' + baseCase.problem, v.p, baseCase.badResPreview, baseCase.agiaPromptTagged, baseCase.previewResponse, false
                ));
            }
        });

        // --- LOGIC ---
        let currentCategory = 'office';
        let searchQuery = '';

        function init() {
            renderCategories();
            renderCaseList();
            selectCase(101); 
        }

        function renderCategories() {
            const nav = document.getElementById('category-nav');
            nav.innerHTML = Object.keys(categoryConfig).map(key => {
                const conf = categoryConfig[key];
                // Count cases in this category
                const count = allCases.filter(c => c.category === key).length;
                
                const isActive = currentCategory === key;
                const activeClass = isActive 
                    ? `bg-${conf.color}-100 text-${conf.color}-700 border-${conf.color}-200 shadow-sm ring-1 ring-${conf.color}-200` 
                    : `bg-white text-slate-500 border-slate-100 hover:bg-slate-50`;
                return `<button onclick="setCategory('${key}')" class="flex items-center gap-2 px-4 py-2 rounded-full border text-xs font-bold transition-all whitespace-nowrap ${activeClass}">
                    <span class="material-symbols-outlined text-lg">${conf.icon}</span>
                    ${conf.label} <span class="ml-1 opacity-60 text-[10px] bg-white/50 px-1.5 py-0.5 rounded-full">(${count})</span>
                </button>`;
            }).join('');
        }

        function renderCaseList() {
            const listEl = document.getElementById('case-list');
            const filtered = allCases.filter(c => (c.category === currentCategory || searchQuery !== '') && (c.title.toLowerCase().includes(searchQuery.toLowerCase()) || c.problem.toLowerCase().includes(searchQuery.toLowerCase())));
            document.getElementById('count-display').innerText = allCases.length;
            
            if (filtered.length === 0) { listEl.innerHTML = `<div class="p-8 text-center text-slate-400 text-xs">No hay resultados</div>`; return; }

            listEl.innerHTML = filtered.map(c => {
                const config = categoryConfig[c.category];
                const iconDisplay = c.locked ? 'lock' : c.icon;
                const iconColorClass = c.locked ? 'text-slate-300 bg-slate-50' : `text-${config.color}-500 bg-white`;
                const lockOpacity = c.locked ? 'opacity-70' : '';
                return `<button onclick="selectCase(${c.id})" class="w-full text-left p-3 rounded-lg group transition-all mb-2 hover:bg-slate-50 border border-transparent relative overflow-hidden ${lockOpacity}">
                    <div class="flex items-center gap-3 pl-2">
                        <div class="w-8 h-8 rounded-lg border border-slate-100 flex items-center justify-center flex-none shadow-sm ${iconColorClass}">
                            <span class="material-symbols-outlined text-lg">${iconDisplay}</span>
                        </div>
                        <div class="overflow-hidden">
                            <h4 class="text-sm font-semibold text-slate-700 truncate group-hover:text-indigo-700 transition-colors flex items-center gap-2">
                                ${c.title} 
                                ${!c.locked ? '<span class="text-[9px] bg-green-100 text-green-700 px-1.5 rounded-full">GRATIS</span>' : ''}
                            </h4>
                            <p class="text-[10px] text-slate-400 truncate">${c.locked ? 'Solo miembros Premium' : c.problem}</p>
                        </div>
                    </div>
                </button>`;
            }).join('');
        }

        function selectCase(id) {
            const c = allCases.find(x => x.id === id);
            if(!c) return;
            if (c.locked) { openPaywall(); return; }

            const conf = categoryConfig[c.category];
            document.getElementById('detail-title').innerText = c.title;
            document.getElementById('detail-icon').innerText = c.icon;
            document.getElementById('detail-icon-bg').className = `w-16 h-16 rounded-2xl flex items-center justify-center shadow-lg border-2 border-white bg-${conf.color}-50 text-${conf.color}-600`;
            document.getElementById('detail-category-badge').innerText = conf.label;
            document.getElementById('detail-category-badge').className = `text-[10px] font-bold uppercase tracking-wider px-2 py-0.5 rounded-full bg-${conf.color}-100 text-${conf.color}-700 border border-${conf.color}-200`;
            document.getElementById('detail-problem').innerText = c.problem;
            
            document.getElementById('detail-bad-prompt').innerText = `"${c.badPrompt}"`;
            document.getElementById('detail-bad-result').innerHTML = c.badResPreview || "Respuesta gen√©rica...";
            document.getElementById('deficiency-badges').innerHTML = c.deficiencies.map(d => `<span class="px-2 py-1 bg-red-50 text-red-600 text-[10px] font-bold rounded-md border border-red-100 flex items-center gap-1"><span class="material-symbols-outlined text-[10px]">warning</span>${d}</span>`).join('');

            document.getElementById('detail-prompt-rendered').innerHTML = renderAGIA(c.agiaPromptTagged);
            document.getElementById('preview-response').innerHTML = c.previewResponse;

            if(window.innerWidth < 768) toggleSidebar();
        }

        function setCategory(cat) { currentCategory = cat; searchQuery = ''; document.getElementById('searchInput').value = ''; renderCategories(); renderCaseList(); }
        function filterCases() { searchQuery = document.getElementById('searchInput').value; renderCaseList(); }
        function copyPrompt() {
            const title = document.getElementById('detail-title').innerText;
            const c = allCases.find(x => x.title === title);
            if(!c) return;
            navigator.clipboard.writeText(cleanAGIA(c.agiaPromptTagged));
            
            const btn = document.querySelector('button[onclick="copyPrompt()"]');
            const originalHTML = btn.innerHTML;
            btn.innerHTML = `<span class="material-symbols-outlined text-sm">check</span> <span>¬°COPIADO!</span>`;
            btn.classList.add('text-green-600', 'bg-green-50');
            setTimeout(() => {
                btn.innerHTML = originalHTML;
                btn.classList.remove('text-green-600', 'bg-green-50');
            }, 2000);
        }
        function openPaywall() { document.getElementById('paywall-modal').classList.remove('hidden'); }
        function closePaywall() { document.getElementById('paywall-modal').classList.add('hidden'); }
        function toggleSidebar() { document.getElementById('sidebar').classList.toggle('-translate-x-full'); }

        init();
    </script>
</body>
</html>
